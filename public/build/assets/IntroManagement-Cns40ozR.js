import{k as g,l as _,p as F,c as L,o as d,w as S,b as a,f as u,h as y,t as p,j as b,s as h,v as O,F as V,q as U,e as k}from"./app-BDxSfDqD.js";import{_ as B}from"./AuthenticatedLayout-B0GFBMmA.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";function q(e){try{return typeof e=="string"?JSON.parse(e):e}catch{return e}}function E(e){const n=q(e);return n&&typeof n=="object"?{en:n.en??"",ar:n.ar??""}:{en:n??"",ar:n??""}}function N(e){const n=E(e==null?void 0:e.name),i=E(e==null?void 0:e.description);return{...e,name_en:n.en,name_ar:n.ar,description_en:i.en,description_ar:i.ar,image_url:e!=null&&e.image?`/storage/${e.image}`:"",is_enabled:Number(e==null?void 0:e.is_enabled)===1||(e==null?void 0:e.is_enabled)===!0}}const I={index:async(e={})=>{const{data:n}=await g.get("/api/intro",{params:e});return(Array.isArray(n)?n:(n==null?void 0:n.data)??n??[]).map(N)},edit:async e=>{const{data:n}=await g.get(`/api/intro/edit/${e}`),i=(n==null?void 0:n.data)??n;return N(i)},create:async e=>{const{data:n}=await g.post("/api/intro/create",e,{headers:{"Content-Type":"multipart/form-data"}});return n},update:async(e,n)=>{const{data:i}=await g.post(`/api/intro/update/${e}`,n,{headers:{"Content-Type":"multipart/form-data"}});return i},destroy:async e=>{const{data:n}=await g.delete(`/api/intro/delete/${e}`);return n},publicGetIntro:async()=>{const{data:e}=await g.get("/api/user/get-intro");return(Array.isArray(e)?e:(e==null?void 0:e.data)??e??[]).map(N)}};function J({name:e={en:"",ar:""},description:n={en:"",ar:""},image:i=null,order:c="",is_enabled:m=!0}){const l=new FormData;return l.append("name[en]",e.en??""),l.append("name[ar]",e.ar??""),l.append("description[en]",n.en??""),l.append("description[ar]",n.ar??""),i&&l.append("image",i),c!==""&&c!==null&&c!==void 0&&l.append("order",String(c)),l.append("is_enabled",(m?1:0).toString()),l}const z={class:"p-6 space-y-6"},G={class:"bg-white p-4 rounded shadow"},P={class:"flex items-center justify-between mb-4"},Y={class:"text-lg font-bold"},H={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},K={class:"flex items-center gap-2"},Q={class:"space-y-2"},W={key:0,class:"text-sm text-gray-600"},X=["src"],Z={class:"mt-4 flex items-center gap-3"},ee=["disabled"],te={key:0,class:"text-gray-500 text-sm"},ne={key:0,class:"mt-3 text-red-600 text-sm"},ae={key:1,class:"mt-2 text-sm text-red-600 list-disc pl-6"},se={class:"bg-white p-4 rounded shadow"},re={key:0,class:"text-sm text-gray-500"},oe={key:1},le={class:"min-w-0"},ie={class:"font-semibold truncate"},de={class:"text-sm text-gray-600 truncate"},ue={class:"text-xs text-gray-500"},ce={class:"flex gap-3 items-center"},pe=["src"],ve=["onClick"],_e=["onClick"],fe={key:0,class:"text-center text-gray-500 py-8"},ye={__name:"IntroManagement",setup(e){const n=_([]),i=_(!1),c=_(null),m=_(!1),l=_(""),x=_({}),w=_(null),o=_({name:{en:"",ar:""},description:{en:"",ar:""},image:null,order:"",is_enabled:!0});function j(){c.value=null,o.value={name:{en:"",ar:""},description:{en:"",ar:""},image:null,order:"",is_enabled:!0},w.value=null,l.value="",x.value={}}async function C(){try{i.value=!0,n.value=await I.index()}finally{i.value=!1}}async function M(){var v,t,s,f,A;m.value=!0,l.value="",x.value={};try{const r=J(o.value);c.value?await I.update(c.value,r):await I.create(r),await C(),j()}catch(r){((v=r==null?void 0:r.response)==null?void 0:v.status)===422&&((s=(t=r==null?void 0:r.response)==null?void 0:t.data)!=null&&s.errors)?(x.value=r.response.data.errors,l.value=r.response.data.message||"Validation error"):l.value=((A=(f=r==null?void 0:r.response)==null?void 0:f.data)==null?void 0:A.message)||(r==null?void 0:r.message)||"Request failed"}finally{m.value=!1}}async function R(v){const t=await I.edit(v);c.value=v,o.value={name:{en:t.name_en||"",ar:t.name_ar||""},description:{en:t.description_en||"",ar:t.description_ar||""},order:t.order??"",is_enabled:!!t.is_enabled,image:null},w.value=t.image_url||null}function $(v){var s;const t=(s=v.target.files)==null?void 0:s[0];o.value.image=t||null,w.value=t?URL.createObjectURL(t):null}async function D(v){confirm("Are you sure you want to delete this intro?")&&(await I.destroy(v),await C())}return F(C),(v,t)=>(d(),L(B,null,{default:S(()=>[a("div",z,[t[11]||(t[11]=a("h2",{class:"text-2xl font-semibold text-gray-800"},"Intro Management",-1)),a("div",G,[a("div",P,[a("h3",Y,p(c.value?"Edit Intro":"Add New Intro"),1),c.value?(d(),u("button",{key:0,onClick:j,class:"px-3 py-1 border rounded"},"Cancel")):y("",!0)]),a("div",H,[b(a("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.name.en=s),class:"form-input",type:"text",placeholder:"Name (EN)"},null,512),[[h,o.value.name.en]]),b(a("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.name.ar=s),class:"form-input",type:"text",placeholder:"الاسم (AR)"},null,512),[[h,o.value.name.ar]]),b(a("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.description.en=s),class:"form-input",type:"text",placeholder:"Description (EN)"},null,512),[[h,o.value.description.en]]),b(a("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.description.ar=s),class:"form-input",type:"text",placeholder:"الوصف (AR)"},null,512),[[h,o.value.description.ar]]),b(a("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>o.value.order=s),class:"form-input",type:"number",placeholder:"Order"},null,512),[[h,o.value.order,void 0,{number:!0}]]),a("label",K,[b(a("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=s=>o.value.is_enabled=s)},null,512),[[O,o.value.is_enabled]]),t[6]||(t[6]=a("span",null,"Enabled",-1))]),a("div",Q,[a("input",{type:"file",onChange:$,class:"form-input"},null,32),w.value?(d(),u("div",W,[t[7]||(t[7]=a("span",{class:"block mb-2"},"Image preview:",-1)),a("img",{src:w.value,class:"w-40 h-24 object-cover rounded border"},null,8,X)])):y("",!0)])]),a("div",Z,[a("button",{disabled:m.value,onClick:M,class:"px-4 py-2 bg-green-600 text-white rounded disabled:opacity-60"},p(c.value?"Update Intro":"Add Intro"),9,ee),m.value?(d(),u("span",te,"Saving…")):y("",!0)]),l.value?(d(),u("div",ne,p(l.value),1)):y("",!0),Object.keys(x.value).length?(d(),u("ul",ae,[(d(!0),u(V,null,U(x.value,(s,f)=>(d(),u("li",{key:f},[a("strong",null,p(f)+":",1),k(" "+p(s.join(", ")),1)]))),128))])):y("",!0)]),a("div",se,[a("div",{class:"flex items-center justify-between mb-4"},[t[8]||(t[8]=a("h3",{class:"text-lg font-bold"},"Intro Screens",-1)),a("button",{onClick:C,class:"px-3 py-1 border rounded"},"Refresh")]),i.value?(d(),u("div",re,"Loading…")):(d(),u("div",oe,[(d(!0),u(V,null,U(n.value,s=>(d(),u("div",{key:s.id,class:"flex justify-between items-center border-b py-3"},[a("div",le,[a("div",ie,[k(p(s.name_en)+" ",1),t[9]||(t[9]=a("span",{class:"text-gray-400"},"/",-1)),k(" "+p(s.name_ar),1)]),a("div",de,[k(p(s.description_en)+" ",1),t[10]||(t[10]=a("span",{class:"text-gray-400"},"/",-1)),k(" "+p(s.description_ar),1)]),a("div",ue," Order: "+p(s.order??"-")+" | Enabled: "+p(s.is_enabled?"Yes":"No"),1)]),a("div",ce,[s.image_url?(d(),u("img",{key:0,src:s.image_url,class:"w-16 h-10 object-cover rounded border"},null,8,pe)):y("",!0),a("button",{onClick:f=>R(s.id),class:"text-blue-600 hover:underline"},"Edit",8,ve),a("button",{onClick:f=>D(s.id),class:"text-red-600 hover:underline"},"Delete",8,_e)])]))),128)),n.value.length?y("",!0):(d(),u("div",fe,"No intros found."))]))])])]),_:1}))}},we=T(ye,[["__scopeId","data-v-b3ad14da"]]);export{we as default};
