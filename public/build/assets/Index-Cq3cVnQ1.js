import{i as ae,p as I,z as se,q as ie,H as Q,f as y,o as _,h as U,b as n,t as b,m as $,a as N,u as F,g as Ae,w as R,F as J,s as X,e as O,S as V,K as Ce,d as Ue,j as D,n as j,k as L,y as Y}from"./app-DucLZU7F.js";import{_ as Pe}from"./AuthenticatedLayout-Cuai63CQ.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Ie}from"./vendors-DaCsTet7.js";function $e(e,r,o,d){function l(p){return p instanceof o?p:new o(function(u){u(p)})}return new(o||(o=Promise))(function(p,u){function g(w){try{A(d.next(w))}catch(k){u(k)}}function q(w){try{A(d.throw(w))}catch(k){u(k)}}function A(w){w.done?p(w.value):l(w.value).then(g,q)}A((d=d.apply(e,[])).next())})}function De(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ee,ue;function je(){return ue||(ue=1,ee=function e(r,o){if(r===o)return!0;if(r&&o&&typeof r=="object"&&typeof o=="object"){if(r.constructor!==o.constructor)return!1;var d,l,p;if(Array.isArray(r)){if(d=r.length,d!=o.length)return!1;for(l=d;l--!==0;)if(!e(r[l],o[l]))return!1;return!0}if(r.constructor===RegExp)return r.source===o.source&&r.flags===o.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===o.valueOf();if(r.toString!==Object.prototype.toString)return r.toString()===o.toString();if(p=Object.keys(r),d=p.length,d!==Object.keys(o).length)return!1;for(l=d;l--!==0;)if(!Object.prototype.hasOwnProperty.call(o,p[l]))return!1;for(l=d;l--!==0;){var u=p[l];if(!e(r[u],o[u]))return!1}return!0}return r!==r&&o!==o}),ee}var Ne=je(),Le=De(Ne);const ce="__googleMapsScriptId";var T;(function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.LOADING=1]="LOADING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILURE=3]="FAILURE"})(T||(T={}));class M{constructor({apiKey:r,authReferrerPolicy:o,channel:d,client:l,id:p=ce,language:u,libraries:g=[],mapIds:q,nonce:A,region:w,retries:k=3,url:P="https://maps.googleapis.com/maps/api/js",version:m}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=r,this.authReferrerPolicy=o,this.channel=d,this.client=l,this.id=p||ce,this.language=u,this.libraries=g,this.mapIds=q,this.nonce=A,this.region=w,this.retries=k,this.url=P,this.version=m,M.instance){if(!Le(this.options,M.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(M.instance.options)}`);return M.instance}M.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?T.FAILURE:this.done?T.SUCCESS:this.loading?T.LOADING:T.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let r=this.url;return r+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(r+=`&key=${this.apiKey}`),this.channel&&(r+=`&channel=${this.channel}`),this.client&&(r+=`&client=${this.client}`),this.libraries.length>0&&(r+=`&libraries=${this.libraries.join(",")}`),this.language&&(r+=`&language=${this.language}`),this.region&&(r+=`&region=${this.region}`),this.version&&(r+=`&v=${this.version}`),this.mapIds&&(r+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(r+=`&auth_referrer_policy=${this.authReferrerPolicy}`),r}deleteScript(){const r=document.getElementById(this.id);r&&r.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((r,o)=>{this.loadCallback(d=>{d?o(d.error):r(window.google)})})}importLibrary(r){return this.execute(),google.maps.importLibrary(r)}loadCallback(r){this.callbacks.push(r),this.execute()}setScript(){var r,o;if(document.getElementById(this.id)){this.callback();return}const d={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(d).forEach(p=>!d[p]&&delete d[p]),!((o=(r=window==null?void 0:window.google)===null||r===void 0?void 0:r.maps)===null||o===void 0)&&o.importLibrary||(p=>{let u,g,q,A="The Google Maps JavaScript API",w="google",k="importLibrary",P="__ib__",m=document,f=window;f=f[w]||(f[w]={});const x=f.maps||(f.maps={}),h=new Set,a=new URLSearchParams,v=()=>u||(u=new Promise((E,c)=>$e(this,void 0,void 0,function*(){var S;yield g=m.createElement("script"),g.id=this.id,a.set("libraries",[...h]+"");for(q in p)a.set(q.replace(/[A-Z]/g,K=>"_"+K[0].toLowerCase()),p[q]);a.set("callback",w+".maps."+P),g.src=this.url+"?"+a,x[P]=E,g.onerror=()=>u=c(Error(A+" could not load.")),g.nonce=this.nonce||((S=m.querySelector("script[nonce]"))===null||S===void 0?void 0:S.nonce)||"",m.head.append(g)})));x[k]?console.warn(A+" only loads once. Ignoring:",p):x[k]=(E,...c)=>h.add(E)&&v().then(()=>x[k](E,...c))})(d);const l=this.libraries.map(p=>this.importLibrary(p));l.length||l.push(this.importLibrary("core")),Promise.all(l).then(()=>this.callback(),p=>{const u=new ErrorEvent("error",{error:p});this.loadErrorCallback(u)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(r){if(this.errors.push(r),this.errors.length<=this.retries){const o=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${o} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},o)}else this.onerrorEvent=r,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(r=>{r(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}const Oe={class:"space-y-2"},Fe={key:0,class:"block text-xs text-gray-500"},Re={class:"flex gap-2"},Me=["placeholder"],Ve={__name:"MapPicker",props:{label:{type:String,default:"Select location"},searchPlaceholder:{type:String,default:"Search placeâ€¦"},lat:{type:[Number,String],default:null},lng:{type:[Number,String],default:null},address:{type:String,default:""},fallbackCenter:{type:Object,default:()=>({lat:30.0444,lng:31.2357})},zoom:{type:Number,default:13},apiKey:{type:String,default:"AIzaSyD6l04ETuUP7BfQ7MqpL2vMWEalLxNj0d4"}},emits:["update:lat","update:lng","update:address"],setup(e,{emit:r}){const o=e,d=r,l=a=>{if(typeof a=="number")return Number.isFinite(a)?a:null;if(a===""||a==null)return null;const v=Number(a);return Number.isFinite(v)?v:null};ae(()=>{const a=l(o.lat);return a==null?"-":a.toFixed(6)}),ae(()=>{const a=l(o.lng);return a==null?"-":a.toFixed(6)});const p=I(null),u=I(null);let g,q,A,w,k=null;function P({lat:a,lng:v,address:E}){a!=null&&d("update:lat",a),v!=null&&d("update:lng",v),E!==void 0&&d("update:address",E)}function m(a,v){return new Promise(E=>{if(!w)return E("");w.geocode({location:{lat:a,lng:v}},(c,S)=>{S==="OK"&&c&&c.length?E(c[0].formatted_address||""):E("")})})}async function f(){try{k=await new M({apiKey:o.apiKey,version:"weekly",libraries:["places"]}).load()}catch(c){console.error("Google Maps failed to load:",c);return}w=new k.maps.Geocoder;const a=l(o.lat),v=l(o.lng),E=a!=null&&v!=null?{lat:a,lng:v}:o.fallbackCenter;g=new k.maps.Map(p.value,{center:E,zoom:o.zoom,mapTypeControl:!1,streetViewControl:!1}),q=new k.maps.Marker({position:E,map:g,draggable:!0}),g.addListener("click",c=>{const S=c.latLng;x(S.lat(),S.lng(),!0)}),q.addListener("dragend",()=>{const c=q.getPosition();x(c.lat(),c.lng(),!0)});try{A=new k.maps.places.Autocomplete(u.value,{fields:["geometry","formatted_address","name"]}),A.addListener("place_changed",()=>{var Z;const c=A.getPlace();if(!((Z=c==null?void 0:c.geometry)!=null&&Z.location))return;const S=c.geometry.location;g.panTo(S),g.setZoom(15);const K=c.formatted_address||c.name||"";x(S.lat(),S.lng(),!1,K)})}catch{}if(a!=null&&v!=null&&!o.address){const c=await m(a,v);P({address:c||""})}}async function x(a,v,E=!0,c=""){if(!(!q||!g)){if(q.setPosition({lat:a,lng:v}),g.panTo({lat:a,lng:v}),P({lat:a,lng:v}),c)P({address:c});else if(E){const S=await m(a,v);P({address:S||""})}}}se(()=>[o.lat,o.lng],([a,v])=>{if(!g)return;const E=l(a),c=l(v);E==null||c==null||(q.setPosition({lat:E,lng:c}),g.panTo({lat:E,lng:c}))});function h(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(a=>{const{latitude:v,longitude:E}=a.coords;x(v,E,!0),g&&g.setZoom(15)},()=>{},{enableHighAccuracy:!0,timeout:8e3})}return ie(async()=>{await Q(),await f()}),(a,v)=>(_(),y("div",Oe,[e.label?(_(),y("label",Fe,b(e.label),1)):U("",!0),n("div",Re,[n("input",{ref_key:"searchEl",ref:u,type:"text",class:"form-input flex-1",placeholder:e.searchPlaceholder},null,8,Me),n("button",{type:"button",class:"px-3 py-2 border rounded",onClick:h},"ðŸ“")]),n("div",{ref_key:"mapEl",ref:p,class:"rounded border",style:{height:"320px"}},null,512)]))}},Te=me(Ve,[["__scopeId","data-v-c24049d5"]]);function Ke(e){try{return typeof e=="string"?JSON.parse(e):e}catch{return e}}function pe(e){const r=Ke(e);return r&&typeof r=="object"?{en:r.en??"",ar:r.ar??""}:{en:r??"",ar:r??""}}function te(e){var r;return Array.isArray(e)?e:Array.isArray(e==null?void 0:e.data)?e.data:Array.isArray(e==null?void 0:e.message)?e.message:Array.isArray((r=e==null?void 0:e.data)==null?void 0:r.data)?e.data.data:[]}function ze(e){return(e==null?void 0:e.data)??(e==null?void 0:e.message)??e}function re(e){return e?`/storage/${e}`:""}function fe(e){return e?String(e).slice(0,10):""}function H(e={}){const r=pe(e.name),o=pe(e.description),d=Array.isArray(e.home_unit_gallery)?e.home_unit_gallery.map(l=>({id:l.id??void 0,image:l.image,image_url:re(l.image)})):Array.isArray(e.gallery)?e.gallery.map(l=>({id:l.id??void 0,image:l.image,image_url:re(l.image)})):[];return{...e,name_en:r.en,name_ar:r.ar,description_en:o.en,description_ar:o.ar,location:e.location??"",lat:e.lat??null,long:e.long??null,start_date:fe(e.start_date),end_date:fe(e.end_date),status:e.status??"",user_id:e.user_id??null,vendor_id:e.vendor_id??null,cover_image_url:re(e.cover_image),gallery:d}}const B={list:async(e={})=>{const{data:r}=await $.get("/api/units",{params:e});return te(r).map(H)},listByUser:async(e,r={})=>{const{data:o}=await $.get(`/api/units/user/${e}`,{params:r});return te(o).map(H)},listByVendor:async(e,r={})=>{const{data:o}=await $.get(`/api/units/vendor/${e}`,{params:r});return te(o).map(H)},show:async e=>{const{data:r}=await $.get(`/api/units/show/${e}`);return H(ze(r))},create:async e=>{const{data:r}=await $.post("/api/units/create",e,{headers:{"Content-Type":"multipart/form-data"}});return r},update:async(e,r)=>{const{data:o}=await $.post(`/api/units/update/${e}`,r,{headers:{"Content-Type":"multipart/form-data"}});return o},remove:async e=>{const{data:r}=await $.delete(`/api/units/delete/${e}`);return r}};function Ge({name:e={en:"",ar:""},description:r={en:"",ar:""},location:o,lat:d,long:l,start_date:p,end_date:u,cover_image:g,gallery:q=[],user_id:A,vendor_id:w,status:k,...P}){const m=new FormData;return m.append("name[en]",e.en??""),m.append("name[ar]",e.ar??""),m.append("description[en]",r.en??""),m.append("description[ar]",r.ar??""),m.append("location",o??""),m.append("lat",String(d??"")),m.append("long",String(l??"")),m.append("start_date",p??""),m.append("end_date",u??""),g&&m.append("cover_image",g),(q||[]).forEach(f=>f&&m.append("gallery[]",f)),m.append("user_id",String(A??"")),m.append("vendor_id",String(w??"")),k&&m.append("status",k),Object.entries(P).forEach(([f,x])=>{x!=null&&x!==""&&m.append(f,x)}),m}function Be(e={}){const{name:r,description:o,location:d,lat:l,long:p,start_date:u,end_date:g,cover_image:q,gallery:A,user_id:w,vendor_id:k,status:P,...m}=e,f=new FormData;return r&&(r.en!==void 0&&f.append("name[en]",r.en??""),r.ar!==void 0&&f.append("name[ar]",r.ar??"")),o&&(o.en!==void 0&&f.append("description[en]",o.en??""),o.ar!==void 0&&f.append("description[ar]",o.ar??"")),d!==void 0&&f.append("location",d??""),l!==void 0&&f.append("lat",String(l??"")),p!==void 0&&f.append("long",String(p??"")),u!==void 0&&f.append("start_date",u??""),g!==void 0&&f.append("end_date",g??""),q&&f.append("cover_image",q),Array.isArray(A)&&A.length&&A.forEach(x=>x&&f.append("gallery[]",x)),w!==void 0&&f.append("user_id",String(w??"")),k!==void 0&&f.append("vendor_id",String(k??"")),P!==void 0&&P!==""&&f.append("status",P),Object.entries(m).forEach(([x,h])=>{h!=null&&h!==""&&f.append(x,h)}),f}function Ze(e){return e===!0||e===1||e==="1"}function ne(e={}){const r=e.profile_image||e.profileImage||null;return{id:e.id,name:e.name||"",email:e.email||"",phone:e.phone||"",gender:e.gender||"",country_code:e.country_code||"",country_name:e.country_name||"",role:e.role||"user",is_enabled:Ze(e.is_enabled),profile_image:r,profile_image_url:r?`/storage/${r}`:null,created_at:e.created_at,updated_at:e.updated_at}}function Je(e){return Array.isArray(e)?e:Array.isArray(e==null?void 0:e.data)?e.data:Array.isArray(e==null?void 0:e.message)?e.message:[]}function ge(e){return(e==null?void 0:e.data)??e}const He={list:async()=>{const{data:e}=await $.get("/api/users");return Je(e).map(ne)},show:async e=>{const{data:r}=await $.get(`/api/users/show/${e}`);return ne(ge(r))},edit:async e=>{const{data:r}=await $.get(`/api/users/edit/${e}`);return ne(ge(r))},create:async e=>{const{data:r}=await $.post("/api/users/create",e,{headers:{"Content-Type":"multipart/form-data"}});return r},update:async(e,r)=>{const o=typeof FormData<"u"&&r instanceof FormData,{data:d}=await $.post(`/api/users/update/${e}`,r,{headers:o?{"Content-Type":"multipart/form-data"}:void 0});return d},remove:async e=>{const{data:r}=await $.delete(`/api/users/delete/${e}`);return r}},Qe={class:"p-6 space-y-6"},We={class:"bg-white p-5 rounded-2xl shadow-sm ring-1 ring-black/[0.05]"},Xe={key:0,class:"text-sm text-gray-500"},Ye={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-5"},et={class:"relative aspect-[4/3] bg-gray-50"},tt=["src"],rt={key:1,class:"absolute inset-0 flex items-center justify-center text-gray-400 text-sm"},nt={class:"absolute top-2 left-2 flex flex-wrap gap-2"},at={class:"inline-flex items-center rounded-full bg-white/90 backdrop-blur px-2 py-0.5 text-[11px] font-medium text-gray-700 border border-gray-200"},st={class:"inline-flex items-center rounded-full bg-white/90 backdrop-blur px-2 py-0.5 text-[11px] font-medium text-gray-700 border border-gray-200"},it={class:"p-3.5 space-y-3"},ot={class:"text-sm font-semibold text-gray-900 whitespace-pre-wrap break-words"},lt={key:0,class:"text-gray-400"},dt={dir:"rtl"},ut={class:"text-xs text-gray-500"},ct={class:"grid grid-cols-3 gap-2 pt-2 text-xs"},pt={class:"flex gap-2 pt-3"},ft=["onClick"],gt=["onClick"],mt={key:0,class:"col-span-full text-center text-gray-500 py-8"},vt={class:"relative mx-auto w-full max-w-3xl p-4 sm:p-6 h-full flex items-center justify-center"},ht={class:"bg-white rounded-2xl shadow-lg w-full max-h-[min(88vh,900px)] overflow-y-auto focus:outline-none",role:"dialog","aria-modal":"true"},yt={class:"sticky top-0 z-10 bg-white border-b rounded-t-2xl"},_t={class:"flex items-center justify-between px-5 py-3"},bt={class:"text-lg font-bold"},xt={class:"px-5 py-4 space-y-4"},wt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},kt=["required"],Et={key:0,class:"mt-1 text-xs text-red-600"},St=["required"],qt={key:0,class:"mt-1 text-xs text-red-600"},At={class:"md:col-span-2"},Ct=["required"],Ut={key:0,class:"mt-1 text-xs text-red-600"},Pt={class:"md:col-span-2"},It=["required"],$t={key:0,class:"mt-1 text-xs text-red-600"},Dt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},jt={class:"md:col-span-2"},Nt=["required"],Lt={key:0,class:"mt-1 text-xs text-red-600"},Ot=["required"],Ft={key:0,class:"mt-1 text-xs text-red-600"},Rt=["required"],Mt={key:0,class:"mt-1 text-xs text-red-600"},Vt=["required"],Tt={key:0,class:"mt-1 text-xs text-red-600"},Kt=["required"],zt={key:0,class:"mt-1 text-xs text-red-600"},Gt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Bt=["required"],Zt=["value"],Jt={key:0,class:"mt-1 text-xs text-red-600"},Ht=["required"],Qt=["value"],Wt={key:0,class:"mt-1 text-xs text-red-600"},Xt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Yt={class:"block text-xs text-gray-500 mb-1"},er=["required"],tr={key:0,class:"mt-1 text-xs text-red-600"},rr={key:1,class:"mt-2"},nr=["src"],ar={key:0,class:"rounded border border-red-200 bg-red-50 text-red-700 px-3 py-2"},sr={class:"sticky bottom-0 z-10 bg-white border-t rounded-b-2xl"},ir={class:"px-5 py-3 flex items-center gap-3"},or=["disabled"],lr={__name:"Index",setup(e){const r=ae(()=>!h.value),o=I({}),d=(s,t)=>{if(!t||Array.isArray(t)&&t.length===0){delete o.value[s];return}o.value[s]=Array.isArray(t)?t:[String(t)]},l=s=>{var t;return((t=o.value[s])==null?void 0:t[0])||""},p=s=>!!o.value[s],u=s=>["form-input",p(s)?"border-red-400 focus:ring-red-500":""];function g(){const s=document.querySelector(".max-h-\\[min\\(88vh\\,900px\\)\\]"),t=s==null?void 0:s.querySelector("input.border-red-400, select.border-red-400, textarea.border-red-400");t&&t.scrollIntoView({behavior:"smooth",block:"center"})}function q(){o.value={},S.value="";const s=a.value,t=i=>i!=null&&String(i).trim()!=="";return r.value?(t(s.name.en)||d("name.en","Name (EN) is required"),t(s.name.ar)||d("name.ar","Name (AR) is required"),t(s.description.en)||d("description.en","Description (EN) is required"),t(s.description.ar)||d("description.ar","Description (AR) is required"),t(s.location)||d("location","Location is required"),typeof s.lat=="number"&&s.lat>=-90&&s.lat<=90||d("lat","Latitude must be between -90 and 90"),typeof s.long=="number"&&s.long>=-180&&s.long<=180||d("long","Longitude must be between -180 and 180"),t(s.start_date)||d("start_date","Start date is required"),t(s.end_date)||d("end_date","End date is required"),t(s.start_date)&&t(s.end_date)&&new Date(s.end_date)<new Date(s.start_date)&&d("end_date","End date must be after or equal to start date"),t(s.user_id)||d("user_id","User is required"),t(s.vendor_id)||d("vendor_id","Vendor is required"),s.cover_image||d("cover_image","Cover image is required")):(s.lat!==null&&(s.lat<-90||s.lat>90)&&d("lat","Latitude must be between -90 and 90"),s.long!==null&&(s.long<-180||s.long>180)&&d("long","Longitude must be between -180 and 180"),t(s.start_date)&&t(s.end_date)&&new Date(s.end_date)<new Date(s.start_date)&&d("end_date","End date must be after or equal to start date")),Object.keys(o.value).length?(S.value="Please fix the highlighted fields.",!1):!0}function A(s){var i,C,W,de;const t=(C=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:C.errors;if(!t)return!1;o.value={};for(const[Se,qe]of Object.entries(t))d(Se,qe);return S.value=((de=(W=s==null?void 0:s.response)==null?void 0:W.data)==null?void 0:de.message)||"Validation failed. Please review the fields below.",!0}const w=I([]),k=I([]);async function P(){const s=await He.list();w.value=s.map(i=>({id:i.id,name:i.name,email:i.email}));const t=await Ie.list();k.value=t.map(i=>({id:i.id,name:i.name,email:i.email}))}ie(async()=>{await Promise.all([G(),P()])});const m=I([]),f=I(!1),x=I(!1),h=I(null),a=I({name:{en:"",ar:""},description:{en:"",ar:""},location:"",lat:null,long:null,start_date:"",end_date:"",user_id:null,vendor_id:null,status:"",cover_image:null,gallery:[]}),v=I(null),E=I([]),c=I(!1),S=I(""),K=I({});function Z(s){return`/units-management/${s}/docs`}function ve(s){return`/units-management/${s}/drawing`}function he(s){return`/units-management/${s}/gallery`}function ye(s){return`/units-management/${s}/timeline`}function _e(s){return`/units-management/${s}/reports`}function be(s){return`/units-management/${s}/phases`}function oe(){a.value={name:{en:"",ar:""},description:{en:"",ar:""},location:"",lat:null,long:null,start_date:"",end_date:"",user_id:null,vendor_id:null,status:"under_construction",cover_image:null,gallery:[]},v.value=null,E.value=[],S.value="",K.value={},h.value=null}function xe(){oe(),x.value=!0}async function we(s){oe(),h.value=s.id;const t=await B.show(s.id);a.value.name.en=t.name_en||"",a.value.name.ar=t.name_ar||"",a.value.description.en=t.description_en||"",a.value.description.ar=t.description_ar||"",a.value.location=t.location||"",a.value.lat=t.lat,a.value.long=t.long,a.value.start_date=t.start_date||"",a.value.end_date=t.end_date||"",a.value.user_id=t.user_id??null,a.value.vendor_id=t.vendor_id??null,a.value.status=t.status||"",v.value=t.cover_image_url||null,x.value=!0}se(()=>x.value,async s=>{s&&await Q()}),se(()=>x.value,s=>{document.body.style.overflow=s?"hidden":""});function z(){x.value=!1}function ke(s){var i;const t=((i=s.target.files)==null?void 0:i[0])||null;a.value.cover_image=t,v.value=t?URL.createObjectURL(t):v.value}async function G(){f.value=!0;try{m.value=await B.list()}finally{f.value=!1}}async function le(){var s,t,i;c.value=!0;try{if(!q()){await Q(),g();return}if(h.value){const C=Be(a.value);await B.update(h.value,C)}else{const C=Ge(a.value);await B.create(C)}await G(),z()}catch(C){((s=C==null?void 0:C.response)==null?void 0:s.status)===422&&A(C)?(await Q(),g()):S.value=((i=(t=C==null?void 0:C.response)==null?void 0:t.data)==null?void 0:i.message)||(C==null?void 0:C.message)||"Request failed"}finally{c.value=!1}}async function Ee(s){confirm(`Delete unit #${s.id}?`)&&(await B.remove(s.id),await G())}return ie(G),(s,t)=>(_(),y(J,null,[N(F(Ae),{title:"Units"}),N(Pe,null,{default:R(()=>[n("div",Qe,[n("div",{class:"flex items-center justify-between"},[t[15]||(t[15]=n("h2",{class:"text-2xl font-bold text-gray-800"},"Units",-1)),n("button",{onClick:xe,class:"inline-flex items-center rounded-md bg-black px-4 py-2 text-xs font-semibold uppercase tracking-widest text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"}," + Add Unit ")]),n("div",We,[n("div",{class:"flex items-center justify-between mb-4"},[t[16]||(t[16]=n("h3",{class:"text-lg font-semibold text-gray-800"},"All Units",-1)),n("button",{onClick:G,class:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50"}," Refresh ")]),f.value?(_(),y("div",Xe,"Loadingâ€¦")):(_(),y("div",Ye,[(_(!0),y(J,null,X(m.value,i=>(_(),y("div",{key:i.id,class:"group rounded-2xl overflow-hidden bg-white border border-gray-200/70 shadow-[0_1px_2px_rgba(0,0,0,0.04)] hover:shadow-[0_8px_24px_rgba(0,0,0,0.08)] hover:-translate-y-0.5 transition-all duration-200"},[n("div",et,[i.cover_image_url?(_(),y("img",{key:0,src:i.cover_image_url,class:"absolute inset-0 w-full h-full object-cover",alt:""},null,8,tt)):(_(),y("div",rt," No Cover ")),t[17]||(t[17]=n("div",{class:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-transparent"},null,-1)),n("div",nt,[n("span",at,b(i.status||"â€”"),1),n("span",st,b(i.location||"No location"),1)])]),n("div",it,[n("div",ot,[O(b(i.name_en||"â€”")+" ",1),i.name_ar?(_(),y("span",lt," / ")):U("",!0),n("span",dt,b(i.name_ar),1)]),n("div",ut,[t[18]||(t[18]=n("span",{class:"font-medium"},"Period:",-1)),O(" "+b(i.start_date||"â€”")+" â†’ "+b(i.end_date||"â€”"),1)]),n("div",ct,[N(F(V),{href:Z(i.id),class:"px-2 py-1.5 rounded-lg border text-center hover:bg-gray-50"},{default:R(()=>t[19]||(t[19]=[O(" Docs ")])),_:2},1032,["href"]),N(F(V),{href:he(i.id),class:"px-2 py-1.5 rounded-lg border text-center hover:bg-gray-50"},{default:R(()=>t[20]||(t[20]=[O(" Gallery ")])),_:2},1032,["href"]),N(F(V),{href:ve(i.id),class:"px-2 py-1.5 rounded-lg border text-center hover:bg-gray-50"},{default:R(()=>t[21]||(t[21]=[O(" Drawing ")])),_:2},1032,["href"]),N(F(V),{href:_e(i.id),class:"px-2 py-1.5 rounded-lg border text-center hover:bg-gray-50"},{default:R(()=>t[22]||(t[22]=[O(" Reports ")])),_:2},1032,["href"]),N(F(V),{href:be(i.id),class:"px-2 py-1.5 rounded-lg border text-center hover:bg-gray-50"},{default:R(()=>t[23]||(t[23]=[O(" Phases ")])),_:2},1032,["href"]),N(F(V),{href:ye(i.id),class:"px-2 py-1.5 rounded-lg border text-center hover:bg-gray-50"},{default:R(()=>t[24]||(t[24]=[O(" Timeline ")])),_:2},1032,["href"])]),n("div",pt,[n("button",{class:"px-3 py-1.5 text-sm rounded-lg border border-gray-300 bg-white hover:bg-gray-50",onClick:C=>we(i)}," Edit ",8,ft),n("button",{class:"px-3 py-1.5 text-sm rounded-lg border border-red-200 text-red-700 bg-red-50 hover:bg-red-100",onClick:C=>Ee(i)}," Delete ",8,gt)])])]))),128)),m.value.length?U("",!0):(_(),y("div",mt," No units found. "))]))]),x.value?(_(),y("div",{key:0,class:"fixed inset-0 z-50",onKeydown:Ce(z,["esc"])},[n("div",{class:"absolute inset-0 bg-black/40",onClick:z,"aria-hidden":"true"}),n("div",vt,[n("div",ht,[n("div",yt,[n("div",_t,[n("h3",bt,b(h.value?"Edit Unit":"Add Unit"),1),n("button",{onClick:z,class:"text-gray-400 hover:text-gray-600","aria-label":"Close"}," âœ• ")])]),n("div",xt,[n("form",{onSubmit:Ue(le,["prevent"]),class:"space-y-4"},[n("div",wt,[n("div",null,[t[25]||(t[25]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Name (EN)*",-1)),D(n("input",{class:j(u("name.en")),"onUpdate:modelValue":t[0]||(t[0]=i=>a.value.name.en=i),type:"text",required:!h.value},null,10,kt),[[L,a.value.name.en]]),l("name.en")?(_(),y("p",Et,b(l("name.en")),1)):U("",!0)]),n("div",null,[t[26]||(t[26]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Name (AR)*",-1)),D(n("input",{class:j(u("name.ar")),"onUpdate:modelValue":t[1]||(t[1]=i=>a.value.name.ar=i),type:"text",required:!h.value},null,10,St),[[L,a.value.name.ar]]),l("name.ar")?(_(),y("p",qt,b(l("name.ar")),1)):U("",!0)]),n("div",At,[t[27]||(t[27]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Description (EN)*",-1)),D(n("textarea",{class:j(u("description.en")),"onUpdate:modelValue":t[2]||(t[2]=i=>a.value.description.en=i),type:"text",required:!h.value},null,10,Ct),[[L,a.value.description.en]]),l("description.en")?(_(),y("p",Ut,b(l("description.en")),1)):U("",!0)]),n("div",Pt,[t[28]||(t[28]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Description (AR)*",-1)),D(n("textarea",{class:j(u("description.ar")),"onUpdate:modelValue":t[3]||(t[3]=i=>a.value.description.ar=i),type:"text",required:!h.value},null,10,It),[[L,a.value.description.ar]]),l("description.ar")?(_(),y("p",$t,b(l("description.ar")),1)):U("",!0)])]),n("div",Dt,[n("div",jt,[N(Te,{label:"Pick on map",lat:a.value.lat,"onUpdate:lat":t[4]||(t[4]=i=>a.value.lat=i),lng:a.value.long,"onUpdate:lng":t[5]||(t[5]=i=>a.value.long=i),address:a.value.location,"onUpdate:address":t[6]||(t[6]=i=>a.value.location=i)},null,8,["lat","lng","address"])]),n("div",null,[t[29]||(t[29]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Location*",-1)),D(n("input",{class:j(u("location")),"onUpdate:modelValue":t[7]||(t[7]=i=>a.value.location=i),type:"text",required:!h.value,disabled:""},null,10,Nt),[[L,a.value.location]]),l("location")?(_(),y("p",Lt,b(l("location")),1)):U("",!0)]),n("div",null,[t[30]||(t[30]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Latitude (-90..90)*",-1)),D(n("input",{class:j(u("lat")),"onUpdate:modelValue":t[8]||(t[8]=i=>a.value.lat=i),type:"number",step:"any",min:"-90",max:"90",required:!h.value,disabled:""},null,10,Ot),[[L,a.value.lat,void 0,{number:!0}]]),l("lat")?(_(),y("p",Ft,b(l("lat")),1)):U("",!0)]),n("div",null,[t[31]||(t[31]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Longitude (-180..180)*",-1)),D(n("input",{class:j(u("long")),"onUpdate:modelValue":t[9]||(t[9]=i=>a.value.long=i),type:"number",step:"any",min:"-180",max:"180",required:!h.value,disabled:""},null,10,Rt),[[L,a.value.long,void 0,{number:!0}]]),l("long")?(_(),y("p",Mt,b(l("long")),1)):U("",!0)]),n("div",null,[t[32]||(t[32]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Start Date*",-1)),D(n("input",{class:j(u("start_date")),"onUpdate:modelValue":t[10]||(t[10]=i=>a.value.start_date=i),type:"date",required:!h.value},null,10,Vt),[[L,a.value.start_date]]),l("start_date")?(_(),y("p",Tt,b(l("start_date")),1)):U("",!0)]),n("div",null,[t[33]||(t[33]=n("label",{class:"block text-xs text-gray-500 mb-1"},"End Date* (>= start)",-1)),D(n("input",{class:j(u("end_date")),"onUpdate:modelValue":t[11]||(t[11]=i=>a.value.end_date=i),type:"date",required:!h.value},null,10,Kt),[[L,a.value.end_date]]),l("end_date")?(_(),y("p",zt,b(l("end_date")),1)):U("",!0)])]),n("div",Gt,[n("div",null,[t[35]||(t[35]=n("label",{class:"block text-xs text-gray-500 mb-1"},"User *",-1)),D(n("select",{class:j(u("user_id")),"onUpdate:modelValue":t[12]||(t[12]=i=>a.value.user_id=i),required:!h.value},[t[34]||(t[34]=n("option",{value:"",disabled:""},"Select a user",-1)),(_(!0),y(J,null,X(w.value,i=>(_(),y("option",{key:i.id,value:i.id},b(i.name)+" â€” "+b(i.email),9,Zt))),128))],10,Bt),[[Y,a.value.user_id,void 0,{number:!0}]]),l("user_id")?(_(),y("p",Jt,b(l("user_id")),1)):U("",!0)]),n("div",null,[t[37]||(t[37]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Project Manager *",-1)),D(n("select",{class:j(u("vendor_id")),"onUpdate:modelValue":t[13]||(t[13]=i=>a.value.vendor_id=i),required:!h.value},[t[36]||(t[36]=n("option",{value:"",disabled:""},"Select a Project Manager",-1)),(_(!0),y(J,null,X(k.value,i=>(_(),y("option",{key:i.id,value:i.id},b(i.name)+" â€” "+b(i.email),9,Qt))),128))],10,Ht),[[Y,a.value.vendor_id,void 0,{number:!0}]]),l("vendor_id")?(_(),y("p",Wt,b(l("vendor_id")),1)):U("",!0)]),n("div",null,[t[39]||(t[39]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Status",-1)),D(n("select",{class:"form-input","onUpdate:modelValue":t[14]||(t[14]=i=>a.value.status=i)},t[38]||(t[38]=[n("option",{value:"under_construction",selected:""},"under_construction",-1),n("option",{value:"completed"},"completed",-1)]),512),[[Y,a.value.status]])])]),n("div",Xt,[n("div",null,[n("label",Yt," Cover Image* "+b(h.value?"(optional to replace)":""),1),n("input",{class:j(u("cover_image")),type:"file",accept:"image/*",onChange:ke,required:!h.value},null,42,er),l("cover_image")?(_(),y("p",tr,b(l("cover_image")),1)):U("",!0),v.value?(_(),y("div",rr,[n("img",{src:v.value,class:"w-40 h-28 object-cover rounded border"},null,8,nr)])):U("",!0)])]),S.value?(_(),y("div",ar,b(S.value),1)):U("",!0)],32)]),n("div",sr,[n("div",ir,[n("button",{disabled:c.value,class:"px-4 py-2 bg-indigo-600 text-white rounded disabled:opacity-60",onClick:le},b(c.value?"Savingâ€¦":h.value?"Update":"Create"),9,or),n("button",{type:"button",class:"px-3 py-2 border rounded",onClick:z},"Cancel")])])])])],32)):U("",!0)])]),_:1})],64))}},fr=me(lr,[["__scopeId","data-v-060c8e95"]]);export{fr as default};
