import{p as v,C as at,c as T,o,b as t,a as g,t as p,w as G,u as f,O as Z,z as nt,m as F,q as ot,f as c,h as I,F as tt,s as et,e as L,n as O,T as bt,d as vt,j as N,k as z,y as R}from"./app-BFfdyCTD.js";import{_ as xt}from"./AuthenticatedLayout-CBLMAWOv.js";import{_ as yt}from"./UnitNav-oTWyXxK5.js";import{U as B,b as gt,a as ft}from"./unitPayments-DZ6TbE2B.js";import{b as _t,U as J,a as wt}from"./unitInstallments-THeMY8kJ.js";import{c as X,b as U,e as lt,d as P,E as V,F as kt}from"./index.esm-CAqNZEJZ.js";import{_ as it}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ht={class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},$t={class:"bg-white rounded-xl shadow-xl w-full max-w-3xl p-6 relative animate-fadeIn"},It={class:"text-xl font-semibold mb-4"},Ct={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Pt={class:"md:col-span-2"},At={class:"md:col-span-2"},Mt={class:"flex justify-end mt-6 gap-3"},St=["disabled"],Dt={__name:"InstallmentModal",props:{mode:String,data:Object,paymentId:[String,Number]},emits:["close","saved"],setup(y,{emit:d}){var j,E,C,w,k,u,M,x;const{show:_}=nt(),a=y,i=d,b=v(!1),h=X({title:X({en:U().required("Title (EN) is required"),ar:U().required("Title (AR) is required")}),description:X({en:U().nullable(),ar:U().nullable()}),amount:lt().typeError("Amount must be a number").required("Amount is required").min(0,"Amount must be >= 0"),percentage:lt().nullable().min(0,"Min 0").max(100,"Max 100").typeError("Percentage must be a number"),milestone_date:U().nullable(),submission_date:U().nullable(),consultant_approval_date:U().nullable(),due_date:U().nullable()});function $(m,l){if(!m)return l;if(typeof m=="string")try{return JSON.parse(m)}catch{return l}return m}const A=v({title:$((j=a.data)==null?void 0:j.title,{en:"",ar:""}),description:$((E=a.data)==null?void 0:E.description,{en:"",ar:""}),amount:((C=a.data)==null?void 0:C.amount)??"",percentage:((w=a.data)==null?void 0:w.percentage)??"",milestone_date:((k=a.data)==null?void 0:k.milestone_date)??"",submission_date:((u=a.data)==null?void 0:u.submission_date)??"",consultant_approval_date:((M=a.data)==null?void 0:M.consultant_approval_date)??"",due_date:((x=a.data)==null?void 0:x.due_date)??""});at(()=>a.data,m=>{m&&(A.value={title:$(m.title,{en:"",ar:""}),description:$(m.description,{en:"",ar:""}),amount:m.amount??"",percentage:m.percentage??"",milestone_date:m.milestone_date??"",submission_date:m.submission_date??"",consultant_approval_date:m.consultant_approval_date??"",due_date:m.due_date??"",status:m.status??"pending"})},{immediate:!0});async function D(m){b.value=!0;try{if(a.mode==="add"){const l=_t(a.paymentId,m);await J.create(l)}else{const l={...m,unit_payment_id:a.paymentId},S=wt(l);await J.update(a.data.id,S)}i("saved"),i("close")}catch(l){console.error(l),_(e),alert("Failed to save installment")}finally{b.value=!1}}return(m,l)=>(o(),T(Z,{to:"body"},[t("div",ht,[t("div",$t,[t("button",{onClick:l[0]||(l[0]=S=>m.$emit("close")),class:"absolute top-3 right-4 text-gray-500 hover:text-black"}," ✕ "),t("h3",It,p(y.mode==="add"?"Add Installment":"Edit Installment"),1),g(f(kt),{onSubmit:D,"initial-values":A.value,"validation-schema":f(h)},{default:G(()=>[t("div",Ct,[t("div",null,[l[2]||(l[2]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Title (EN) *",-1)),g(f(P),{name:"title.en",as:"input",class:"form-input"}),g(f(V),{name:"title.en",class:"text-red-600 text-xs mt-1"})]),t("div",null,[l[3]||(l[3]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Title (AR) *",-1)),g(f(P),{name:"title.ar",as:"input",class:"form-input",dir:"rtl"}),g(f(V),{name:"title.ar",class:"text-red-600 text-xs mt-1"})]),t("div",Pt,[l[4]||(l[4]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Description (EN)",-1)),g(f(P),{name:"description.en",as:"textarea",rows:"2",class:"form-input"}),g(f(V),{name:"description.en",class:"text-red-600 text-xs mt-1"})]),t("div",At,[l[5]||(l[5]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Description (AR)",-1)),g(f(P),{name:"description.ar",as:"textarea",rows:"2",class:"form-input",dir:"rtl"}),g(f(V),{name:"description.ar",class:"text-red-600 text-xs mt-1"})]),t("div",null,[l[6]||(l[6]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Amount *",-1)),g(f(P),{name:"amount",as:"input",type:"number",class:"form-input"}),g(f(V),{name:"amount",class:"text-red-600 text-xs mt-1"})]),t("div",null,[l[7]||(l[7]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Percentage",-1)),g(f(P),{name:"percentage",as:"input",type:"number",class:"form-input"}),g(f(V),{name:"percentage",class:"text-red-600 text-xs mt-1"})]),t("div",null,[l[8]||(l[8]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Milestone Date",-1)),g(f(P),{name:"milestone_date",as:"input",type:"date",class:"form-input"})]),t("div",null,[l[9]||(l[9]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Submission Date",-1)),g(f(P),{name:"submission_date",as:"input",type:"date",class:"form-input"})]),t("div",null,[l[10]||(l[10]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Consultant Approval Date",-1)),g(f(P),{name:"consultant_approval_date",as:"input",type:"date",class:"form-input"})]),t("div",null,[l[11]||(l[11]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Due Date",-1)),g(f(P),{name:"due_date",as:"input",type:"date",class:"form-input"})]),t("div",null,[l[13]||(l[13]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Status",-1)),g(f(P),{name:"status",as:"select",class:"form-input"},{default:G(()=>l[12]||(l[12]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"paid"},"Paid",-1),t("option",{value:"overdue"},"Overdue",-1)])),_:1})])]),t("div",Mt,[t("button",{class:"px-4 py-2 border rounded hover:bg-gray-100",onClick:l[1]||(l[1]=S=>m.$emit("close")),type:"button"}," Cancel "),t("button",{class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",type:"submit",disabled:b.value},p(b.value?"Saving…":"Save"),9,St)])]),_:1},8,["initial-values","validation-schema"])])])]))}},Nt=it(Dt,[["__scopeId","data-v-546c82a5"]]),Y={list:async y=>{const{data:d}=await F.get(`/api/unit-payments/installments/${y}/invoices`);return Array.isArray(d)?d:(d==null?void 0:d.data)??[]},updateStatus:async(y,d)=>{const{data:_}=await F.post(`/api/unit-payments/installments/${y}/status`,{status:d});return _},confirmInvoice:async(y,d)=>{const{data:_}=await F.post("/api/unit-payments/invoices/confirm",{invoice_id:y,action:d});return _}},Ut={class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},jt={class:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl p-6 relative animate-fadeIn max-h-[90vh] overflow-y-auto"},Tt={key:0,class:"text-sm text-gray-500"},Et={key:1},Vt={class:"flex justify-between items-start"},Lt={class:"font-semibold text-gray-800"},Ft={class:"text-blue-600"},Ot={class:"mt-2"},qt={class:"mt-3"},zt=["src","onClick"],Rt={class:"flex flex-col gap-2"},Bt=["onClick","disabled"],Gt=["onClick","disabled"],Jt={key:0,class:"text-center text-gray-500 text-sm mt-6"},Ht={class:"bg-white rounded-xl shadow-2xl p-4 w-full max-w-lg"},Kt=["src"],Qt={__name:"InvoiceModal",props:{installment:Object},emits:["close"],setup(y,{emit:d}){const _=y,a=v([]),i=v(!1),b=v(""),h=v(""),$=v(!1),A=v(null);ot(async()=>{i.value=!0,a.value=await Y.list(_.installment.id),i.value=!1});async function D(w,k){var u,M;if(b.value="",h.value="",!!confirm(`Mark invoice #${w.id} as ${k}?`))try{const x=await Y.confirmInvoice(w.id,k);(x==null?void 0:x.status)==="error"?(h.value="error",b.value=x.message||"Action failed."):(x==null?void 0:x.status)==="success"&&(h.value="success",b.value=x.message||"Action successful."),a.value=await Y.list(_.installment.id),setTimeout(()=>b.value="",4e3)}catch(x){h.value="error",b.value=((M=(u=x.response)==null?void 0:u.data)==null?void 0:M.message)||"Something went wrong.",setTimeout(()=>b.value="",4e3)}}function j(w){return w?`/storage/${w}`:""}function E(w){A.value=w,$.value=!0}function C(){A.value=null,$.value=!1}return(w,k)=>(o(),T(Z,{to:"body"},[t("div",Ut,[t("div",jt,[t("button",{onClick:k[0]||(k[0]=u=>w.$emit("close")),class:"absolute top-3 right-4 text-gray-400 hover:text-gray-700 text-xl"}," ✕ "),k[2]||(k[2]=t("h3",{class:"text-2xl font-semibold text-gray-800 mb-6 border-b pb-2"}," Invoices ",-1)),i.value?(o(),c("div",Tt,"Loading...")):(o(),c("div",Et,[(o(!0),c(tt,null,et(a.value,u=>(o(),c("div",{key:u.id,class:"p-4 mb-3 border rounded-xl hover:shadow transition bg-gray-50"},[t("div",Vt,[t("div",null,[t("p",Lt,[L(" Invoice #"+p(u.id)+" — ",1),t("span",Ft,p(u.paid_amount)+" EGP",1)]),t("div",Ot,[t("span",{class:O(["inline-block px-3 py-1 text-xs rounded-full font-medium border",u.status==="confirmed"?"bg-green-100 text-green-700 border-green-200":u.status==="rejected"?"bg-red-100 text-red-700 border-red-200":"bg-yellow-100 text-yellow-700 border-yellow-200"])},p(u.status?u.status.toUpperCase():"PENDING"),3)]),t("div",qt,[t("img",{src:j(u.invoice_file),alt:"Invoice File",class:"rounded-lg shadow-sm border object-contain max-h-40 cursor-pointer hover:scale-105 transition",onClick:M=>E(u.invoice_file)},null,8,zt)])]),t("div",Rt,[t("button",{onClick:M=>D(u,"confirm"),class:O(["px-4 py-1.5 rounded-lg text-sm font-medium text-white transition",u.status==="confirmed"?"bg-green-300 cursor-not-allowed":"bg-green-600 hover:bg-green-700"]),disabled:u.status==="confirmed"},p(u.status==="confirmed"?"Approved":"Approve"),11,Bt),t("button",{onClick:M=>D(u,"reject"),class:"px-4 py-1.5 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700 transition",disabled:u.status==="rejected"},p(u.status==="rejected"?"Rejected":"Reject"),9,Gt)])])]))),128)),a.value.length?I("",!0):(o(),c("div",Jt," No invoices found. "))])),g(bt,{name:"fade"},{default:G(()=>[b.value?(o(),c("div",{key:0,class:O(["mt-5 p-3 rounded-lg text-sm font-medium border text-center",h.value==="error"?"bg-red-50 text-red-700 border-red-200":"bg-green-50 text-green-700 border-green-200"])},p(b.value),3)):I("",!0)]),_:1}),$.value?(o(),c("div",{key:2,class:"fixed inset-0 bg-black/60 flex items-center justify-center z-[100]",onClick:vt(C,["self"])},[t("div",Ht,[t("div",{class:"flex justify-between items-center mb-2"},[k[1]||(k[1]=t("h4",{class:"font-semibold text-gray-700 text-lg"},"Invoice Preview",-1)),t("button",{onClick:C,class:"text-gray-500 hover:text-gray-700 text-xl"}," ✕ ")]),t("img",{src:j(A.value),alt:"Invoice",class:"rounded-lg object-contain max-h-[75vh] w-full"},null,8,Kt)])])):I("",!0)])])]))}},Wt=it(Qt,[["__scopeId","data-v-48c1c86b"]]),Xt={class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},Yt={class:"bg-white w-full max-w-2xl rounded-lg p-6 relative shadow-xl animate-fadeIn"},Zt={key:0,class:"text-center text-gray-500 py-8"},te={key:1,class:"divide-y divide-gray-200 max-h-96 overflow-y-auto"},ee={class:"flex justify-between items-center"},se={class:"font-medium text-gray-800"},le={class:"text-sm text-gray-600 mt-1"},ae={class:"text-sm text-gray-500"},ne={class:"text-xs text-gray-400"},oe={key:0,class:"text-sm text-gray-600 mt-1"},ie={__name:"PaymentLogsModal",props:{logs:{type:Array,default:()=>[]}},setup(y){return(d,_)=>(o(),T(Z,{to:"body"},[t("div",Xt,[t("div",Yt,[t("button",{onClick:_[0]||(_[0]=a=>d.$emit("close")),class:"absolute right-4 top-3 text-gray-500 hover:text-black"},"✕"),_[1]||(_[1]=t("h3",{class:"text-lg font-semibold mb-4 text-gray-800"},"Payment Logs",-1)),y.logs.length?(o(),c("ul",te,[(o(!0),c(tt,null,et(y.logs,a=>(o(),c("li",{key:a.id,class:"py-3"},[t("div",ee,[t("div",null,[t("p",se,p(a.action||"Action"),1),t("p",le,p(a.description||"Description"),1),t("p",ae,"By: "+p(a.created_by_name||"System Admin"),1)]),t("span",ne,p(new Date(a.created_at).toLocaleString()),1)]),a.notes?(o(),c("p",oe,p(a.notes),1)):I("",!0)]))),128))])):(o(),c("div",Zt,"No logs found."))])])]))}},re={unitLogs:async y=>{const{data:d}=await F.get(`/api/unit-payments/logs/${y}`);return(d==null?void 0:d.data)??[]},installmentLogs:async y=>{const{data:d}=await F.get(`/api/unit-payments/installment/${y}/logs`);return(d==null?void 0:d.data)??[]}},de={class:"container mx-auto p-6"},ue={class:"flex border-b mb-6 mt-6 items-center"},me={key:0,class:"p-6 rounded shadow mt-6"},ce={key:0,class:"text-sm text-gray-500"},pe={key:1,class:"text-center text-gray-500 py-6"},be={key:2,class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},ve={key:1,class:"bg-white p-6 rounded shadow mt-6"},xe={key:0},ye={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ge={class:"mt-4 text-right"},fe=["disabled"],_e={key:1,class:"space-y-6"},we={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},ke={class:"flex justify-end gap-2"},he={key:2,class:"space-y-4"},$e={class:"flex justify-between items-center mb-4"},Ie=["disabled"],Ce={key:0,class:"bg-white rounded-xl shadow-sm p-4"},Pe={class:"min-w-full text-sm text-left border"},Ae={class:"p-2 border"},Me={class:"p-2 border"},Se={class:"p-2 border"},De={class:"p-2 border"},Ne={class:"p-2 border"},Ue={class:"p-2 border"},je={class:"p-2 border text-center"},Te=["onClick"],Ee={class:"p-2 border flex gap-2"},Ve=["onClick"],Le=["onClick"],Fe=["onClick"],Oe={key:0,class:"text-center py-4 text-gray-500"},Ke={__name:"UnitPaymentsAndInstallments",props:{unitId:Number},setup(y){const{show:d}=nt(),_=y,a=v("payments"),i=v(null),b=v({total_price:"",installments_count:"",payment_type:"installments",overall_status:"pending"}),h=v(!1),$=v(!1),A=v(!1),D=v([]);function j(r){i.value={...r,editable:{...r}}}async function E(r){A.value=!0;try{const s=await re.installmentLogs(r);D.value=s}catch{D.value=[],d(e),console.log("No logs found")}}async function C(){var r;$.value=!0;try{const s=await B.list(_.unitId);if(((r=s==null?void 0:s.data)==null?void 0:r.length)>0||(s==null?void 0:s.length)>0){const n=s.data?s.data[0]:s[0];j(n),x.value=n.id}else i.value=null,x.value=null;a.value==="installments"&&await S()}catch(s){d(s)}finally{$.value=!1}}async function w(){try{h.value=!0;const r=gt(_.unitId,[b.value]);await B.create(r),await C(),h.value=!1}catch(r){d(r)}}async function k(){try{if(!i.value)return;const r=ft(i.value.editable);await B.update(i.value.id,r),await C()}catch(r){d(r)}}async function u(r){confirm("Delete this payment?")&&(await B.remove(r),await C())}function M(r){const s=Number(r);return isNaN(s)?"0.00":s.toFixed(2)}const x=v(null),m=v([]),l=v(!1);async function S(){if(x.value){l.value=!0;try{m.value=await J.list(x.value)}finally{l.value=!1}}}async function rt(r){confirm("Delete this installment?")&&(await J.remove(r),await C(),await S())}const q=v(!1),H=v("add"),K=v(null);function dt(){H.value="add",K.value=null,q.value=!0}function ut(r){H.value="edit",K.value={...r,unit_payment_id:x.value},q.value=!0}function mt(){q.value=!1}const Q=v(!1),st=v(null);function ct(r){st.value=r,Q.value=!0}function pt(){Q.value=!1}return ot(C),at(a,async r=>{r==="installments"&&x.value&&await S()}),(r,s)=>(o(),T(xt,null,{default:G(()=>[t("div",de,[g(yt,{"unit-id":Number(y.unitId),cols:2},null,8,["unit-id"]),t("div",ue,[t("button",{class:O([a.value==="payments"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600","px-4 py-2 font-medium"]),onClick:s[0]||(s[0]=n=>a.value="payments")}," Payments ",2),t("button",{class:O([a.value==="installments"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600","px-4 py-2 font-medium"]),onClick:s[1]||(s[1]=n=>a.value="installments")}," Installments ",2)]),a.value==="payments"?(o(),c("div",me,[s[16]||(s[16]=t("div",{class:"flex justify-between items-center mb-4"},[t("h3",{class:"text-lg font-semibold text-gray-800"},"Payment")],-1)),s[17]||(s[17]=t("h3",{class:"text-lg font-semibold mb-3"},"Current Payment",-1)),$.value?(o(),c("div",ce,"Loading…")):i.value?(o(),c("div",be,[t("div",null,[s[12]||(s[12]=t("strong",null,"Total Price:",-1)),L(" "+p(M(i.value.total_price)),1)]),t("div",null,[s[13]||(s[13]=t("strong",null,"Installments:",-1)),L(" "+p(i.value.installments_count),1)]),t("div",null,[s[14]||(s[14]=t("strong",null,"Type:",-1)),L(" "+p(i.value.payment_type),1)]),t("div",null,[s[15]||(s[15]=t("strong",null,"Status:",-1)),L(" "+p(i.value.overall_status),1)])])):(o(),c("div",pe," No payment created yet. "))])):I("",!0),a.value==="payments"?(o(),c("div",ve,[s[31]||(s[31]=t("h3",{class:"text-lg font-semibold mb-4"},"Unit Payment",-1)),i.value?(o(),c("div",_e,[t("div",we,[t("div",null,[s[25]||(s[25]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Total Price",-1)),N(t("input",{"onUpdate:modelValue":s[6]||(s[6]=n=>i.value.editable.total_price=n),type:"number",class:"w-full border p-2 rounded"},null,512),[[z,i.value.editable.total_price,void 0,{number:!0}]])]),t("div",null,[s[26]||(s[26]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Installments Count",-1)),N(t("input",{"onUpdate:modelValue":s[7]||(s[7]=n=>i.value.editable.installments_count=n),type:"number",class:"w-full border p-2 rounded"},null,512),[[z,i.value.editable.installments_count,void 0,{number:!0}]])]),t("div",null,[s[28]||(s[28]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Type",-1)),N(t("select",{"onUpdate:modelValue":s[8]||(s[8]=n=>i.value.editable.payment_type=n),class:"w-full border p-2 rounded"},s[27]||(s[27]=[t("option",{value:"installments"},"Installments",-1),t("option",{value:"cash"},"Cash",-1)]),512),[[R,i.value.editable.payment_type]])]),t("div",null,[s[30]||(s[30]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Status",-1)),N(t("select",{"onUpdate:modelValue":s[9]||(s[9]=n=>i.value.editable.overall_status=n),class:"w-full border p-2 rounded"},s[29]||(s[29]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"in_progress"},"In Progress",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"overdue"},"Overdue",-1)]),512),[[R,i.value.editable.overall_status]])])]),t("div",ke,[t("button",{onClick:k,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded"}," Save Changes "),t("button",{onClick:s[10]||(s[10]=n=>u(i.value.id)),class:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded"}," Delete ")])])):(o(),c("div",xe,[s[24]||(s[24]=t("p",{class:"text-gray-600 mb-4"},"No payment created yet for this unit.",-1)),t("div",ye,[t("div",null,[s[18]||(s[18]=t("label",{class:"block text-sm font-medium mb-1"},"Total Price *",-1)),N(t("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>b.value.total_price=n),type:"number",class:"form-control w-full border p-2 rounded"},null,512),[[z,b.value.total_price,void 0,{number:!0}]])]),t("div",null,[s[19]||(s[19]=t("label",{class:"block text-sm font-medium mb-1"},"Installments Count *",-1)),N(t("input",{"onUpdate:modelValue":s[3]||(s[3]=n=>b.value.installments_count=n),type:"number",class:"form-control w-full border p-2 rounded"},null,512),[[z,b.value.installments_count,void 0,{number:!0}]])]),t("div",null,[s[21]||(s[21]=t("label",{class:"block text-sm font-medium mb-1"},"Payment Type *",-1)),N(t("select",{"onUpdate:modelValue":s[4]||(s[4]=n=>b.value.payment_type=n),class:"form-control w-full border p-2 rounded"},s[20]||(s[20]=[t("option",{value:"installments"},"Installments",-1),t("option",{value:"cash"},"Cash",-1)]),512),[[R,b.value.payment_type]])]),t("div",null,[s[23]||(s[23]=t("label",{class:"block text-sm font-medium mb-1"},"Overall Status *",-1)),N(t("select",{"onUpdate:modelValue":s[5]||(s[5]=n=>b.value.overall_status=n),class:"form-control w-full border p-2 rounded"},s[22]||(s[22]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"in_progress"},"In Progress",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"overdue"},"Overdue",-1)]),512),[[R,b.value.overall_status]])])]),t("div",ge,[t("button",{onClick:w,disabled:h.value,class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded disabled:opacity-50"},p(h.value?"Saving…":"Create Payment"),9,fe)])]))])):I("",!0),a.value==="installments"?(o(),c("div",he,[t("div",$e,[s[32]||(s[32]=t("h3",{class:"text-lg font-semibold text-gray-800"},"Installments",-1)),t("button",{disabled:!i.value,onClick:dt,class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50"}," + Add Installment ",8,Ie)]),x.value?(o(),c("div",Ce,[t("div",{class:"flex justify-between items-center mb-3"},[s[33]||(s[33]=t("h3",{class:"font-semibold text-lg text-gray-800"},"Installments",-1)),t("button",{onClick:S,class:"px-3 py-1 text-sm border rounded-lg hover:bg-gray-50"}," Refresh ")]),t("table",Pe,[s[35]||(s[35]=t("thead",{class:"bg-gray-50 text-gray-700 uppercase text-xs"},[t("tr",null,[t("th",{class:"p-2 border"}),t("th",{class:"p-2 border"},"Title"),t("th",{class:"p-2 border"},"Amount"),t("th",{class:"p-2 border"},"Percentage"),t("th",{class:"p-2 border"},"Status"),t("th",{class:"p-2 border"},"Due Date"),t("th",{class:"p-2 border"},"Invoices"),t("th",{class:"p-2 border"},"Actions")])],-1)),t("tbody",null,[(o(!0),c(tt,null,et(m.value,n=>(o(),c("tr",{key:n.id,class:"hover:bg-gray-50 transition"},[t("td",Ae,p(n.id),1),t("td",Me,p(n.title.en),1),t("td",Se,p(n.amount),1),t("td",De,p(n.percentage),1),t("td",Ne,p(n.status),1),t("td",Ue,p(n.due_date||"-"),1),t("td",je,[t("button",{onClick:W=>ct(n),class:"text-blue-600 underline text-xs hover:text-blue-800"}," View ",8,Te)]),t("td",Ee,[t("button",{onClick:W=>ut(n),class:"px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700"}," Edit ",8,Ve),t("button",{onClick:W=>rt(n.id),class:"px-2 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700"}," Delete ",8,Le),t("button",{onClick:W=>E(n.id),class:"px-3 py-1 text-xs border rounded text-gray-700 border-gray-200 hover:bg-gray-50 flex items-center gap-1"},s[34]||(s[34]=[t("i",{class:"fa fa-clock text-blue-500"},null,-1),L(" Logs ")]),8,Fe)])]))),128))])]),m.value.length?I("",!0):(o(),c("div",Oe," No installments found. "))])):I("",!0)])):I("",!0)]),q.value?(o(),T(Nt,{key:0,mode:H.value,data:K.value,paymentId:x.value,onClose:mt,onSaved:S},null,8,["mode","data","paymentId"])):I("",!0),Q.value?(o(),T(Wt,{key:1,installment:st.value,onClose:pt},null,8,["installment"])):I("",!0),A.value?(o(),T(ie,{key:2,logs:D.value,onClose:s[11]||(s[11]=n=>A.value=!1)},null,8,["logs"])):I("",!0)]),_:1}))}};export{Ke as default};
