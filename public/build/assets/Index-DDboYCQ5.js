import{p as d,i as N,q as U,c as A,o as c,w as j,b as e,f as m,h as R,j as K,k as O,F as G,s as H,t as h,u as a,a as n,z as J}from"./app-ClrU1S9T.js";import{_ as Q}from"./AuthenticatedLayout-Dd4kH34h.js";import{c as f,a as W,b as l,F as X,d as o,E as i}from"./index.esm-uukwsWDx.js";import{C as g,b as Y,a as Z}from"./consultants-OcMLfJq9.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"p-6 space-y-6"},ae={class:"flex gap-4"},se={class:"bg-white rounded-xl shadow border overflow-hidden"},ne={class:"w-full text-sm"},re={class:"px-4 py-3"},ie=["src"],le={key:1,class:"text-gray-400"},oe={class:"px-4 py-3"},de={class:"px-4 py-3"},ce={class:"px-4 py-3 text-right space-x-2"},pe=["onClick"],ue=["onClick"],me={key:0},ve={class:"flex justify-between items-center"},_e={class:"text-sm text-gray-600"},he={class:"flex gap-2"},fe=["disabled"],ye=["disabled"],xe={key:0,class:"fixed back-drop inset-0 bg-black/40 flex items-center justify-center z-50"},ge={class:"bg-white w-full max-w-xl rounded-xl p-6 max-h-[85vh] overflow-y-auto"},be={class:"text-lg font-semibold mb-4"},Ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},we={class:"md:col-span-2"},qe={class:"md:col-span-2"},ke={class:"md:col-span-2"},Ee={class:"md:col-span-2"},Ne=["onChange"],D=10,Ae={__name:"Index",setup(Re){const{show:L}=J(),F=d([]),b=d(""),p=d(1),y=d(!1),v=d(!1),C=d(null),_=d(null),w=d(0),q=d({}),M=f({title:f({en:l().required("EN title is required"),ar:l().required("AR title is required")}),description:f({en:l().required("English description is required"),ar:l().required("Arabic description is required")}),email:l().email("Invalid email").required("Email is required"),company_phone:l().required("Company phone is required"),representative_phone:l().required("Representative phone is required"),company_address:f({en:l().required("EN address is required"),ar:l().required("AR address is required")}),representative_name:f({en:l().required("EN representative name is required"),ar:l().required("AR representative name is required")}),image:W().test("image-required-on-create","Image is required",function(t){const{isCreate:s}=this.options.context||{};return s?t instanceof File:!0})});async function k(){F.value=await g.list()}const E=N(()=>{const t=b.value.toLowerCase();return F.value.filter(s=>{var r,u,x;return((r=s.title_en)==null?void 0:r.toLowerCase().includes(t))||((u=s.title_ar)==null?void 0:u.toLowerCase().includes(t))||((x=s.email)==null?void 0:x.toLowerCase().includes(t))})}),$=N(()=>Math.ceil(E.value.length/D)),S=N(()=>{const t=(p.value-1)*D;return E.value.slice(t,t+D)});function B(){v.value=!1,C.value=null,q.value={title:{en:"",ar:""},description:{en:"",ar:""},email:"",company_phone:"",representative_phone:"",company_address:{en:"",ar:""},representative_name:{en:"",ar:""},image:null},_.value=null,w.value++,y.value=!0}function T(t){v.value=!0,C.value=t.id,q.value={title:{en:t.title_en,ar:t.title_ar},description:{en:t.description_en,ar:t.description_ar},email:t.email,company_phone:t.company_phone||"",representative_phone:t.representative_phone||"",company_address:t.company_address||{en:"",ar:""},representative_name:t.representative_name||{en:"",ar:""},image:null},_.value=null,w.value++,y.value=!0}function I(){y.value=!1}async function V(t){const s={email:t.email,title:t.title,description:t.description,company_phone:t.company_phone||"",representative_phone:t.representative_phone||"",company_address:t.company_address||{en:"",ar:""},representative_name:t.representative_name||{en:"",ar:""},image:_.value};try{v.value?await g.update(C.value,Y(s)):await g.create(Z([s])),I(),k()}catch(r){L(r)}}async function z(t){confirm("Delete this consultant?")&&(await g.remove(t),k())}return U(k),(t,s)=>(c(),A(Q,null,{default:j(()=>[e("div",te,[e("div",{class:"flex justify-between items-center"},[s[3]||(s[3]=e("h2",{class:"text-2xl font-bold"},"Consultants",-1)),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:B}," + Add Consultant ")]),e("div",ae,[K(e("input",{"onUpdate:modelValue":s[0]||(s[0]=r=>b.value=r),placeholder:"Search by title or email",class:"form-input w-72"},null,512),[[O,b.value]])]),e("div",se,[e("table",ne,[s[5]||(s[5]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left"},"Image"),e("th",{class:"px-4 py-3 text-left"},"Title (EN)"),e("th",{class:"px-4 py-3 text-left"},"Email"),e("th",{class:"px-4 py-3 text-right"},"Actions")])],-1)),e("tbody",null,[(c(!0),m(G,null,H(S.value,r=>(c(),m("tr",{key:r.id,class:"border-t"},[e("td",re,[r.image_url?(c(),m("img",{key:0,src:r.image_url,class:"w-16 h-12 object-cover rounded border"},null,8,ie)):(c(),m("span",le,"â€”"))]),e("td",oe,h(r.title_en),1),e("td",de,h(r.email),1),e("td",ce,[e("button",{class:"text-blue-600",onClick:u=>T(r)},"Details",8,pe),e("button",{class:"text-red-600",onClick:u=>z(r.id)},"Delete",8,ue)])]))),128)),E.value.length===0?(c(),m("tr",me,s[4]||(s[4]=[e("td",{colspan:"4",class:"text-center py-6 text-gray-500"}," No consultants found ",-1)]))):R("",!0)])])]),e("div",ve,[e("span",_e," Page "+h(p.value)+" of "+h($.value),1),e("div",he,[e("button",{class:"px-3 py-1 border rounded",disabled:p.value===1,onClick:s[1]||(s[1]=r=>p.value--)}," Prev ",8,fe),e("button",{class:"px-3 py-1 border rounded",disabled:p.value===$.value,onClick:s[2]||(s[2]=r=>p.value++)}," Next ",8,ye)])]),y.value?(c(),m("div",xe,[e("div",ge,[e("h3",be,h(v.value?"Edit Consultant":"Add Consultant"),1),(c(),A(a(X),{key:w.value,"validate-on-mount":!1,"validation-schema":a(M),"initial-values":q.value,"validation-context":{isCreate:!v.value},onSubmit:V},{default:j(({setFieldValue:r,submitCount:u})=>[e("div",Ce,[e("div",null,[n(a(o),{name:"title.en",class:"form-input",placeholder:"Title (EN)"}),n(a(i),{name:"title.en",class:"error"})]),e("div",null,[n(a(o),{name:"title.ar",class:"form-input",placeholder:"Title (AR)"}),n(a(i),{name:"title.ar",class:"error"})]),e("div",we,[n(a(o),{name:"email",type:"email",class:"form-input",placeholder:"Email"}),n(a(i),{name:"email",class:"error"})]),e("div",qe,[n(a(o),{name:"description.en",as:"textarea",class:"form-input",placeholder:"Description (EN)"}),n(a(i),{name:"description.en",class:"error"})]),e("div",ke,[n(a(o),{name:"description.ar",as:"textarea",class:"form-input",placeholder:"Description (AR)",dir:"rtl"}),n(a(i),{name:"description.ar",class:"error"})]),e("div",null,[n(a(o),{name:"company_phone",class:"form-input",placeholder:"Company Phone"}),n(a(i),{name:"company_phone",class:"error"})]),e("div",null,[n(a(o),{name:"representative_phone",class:"form-input",placeholder:"Representative Phone"}),n(a(i),{name:"representative_phone",class:"error"})]),e("div",null,[n(a(o),{name:"company_address.en",class:"form-input",placeholder:"Company Address (EN)"}),n(a(i),{name:"company_address.en",class:"error"})]),e("div",null,[n(a(o),{name:"company_address.ar",class:"form-input",placeholder:"Company Address (AR)"}),n(a(i),{name:"company_address.ar",class:"error"})]),e("div",null,[n(a(o),{name:"representative_name.en",class:"form-input",placeholder:"Representative Name (EN)"}),n(a(i),{name:"representative_name.en",class:"error"})]),e("div",null,[n(a(o),{name:"representative_name.ar",class:"form-input",placeholder:"Representative Name (AR)"}),n(a(i),{name:"representative_name.ar",class:"error"})]),e("div",Ee,[e("input",{type:"file",accept:"image/*",onChange:x=>{var P;_.value=((P=x.target.files)==null?void 0:P[0])||null,r("image",_.value)}},null,40,Ne),u>0?(c(),A(a(i),{key:0,name:"image",class:"error"})):R("",!0)])]),e("div",{class:"flex justify-end gap-2 mt-6"},[e("button",{type:"button",class:"px-4 py-2 border rounded",onClick:I}," Cancel "),s[6]||(s[6]=e("button",{type:"submit",class:"px-4 py-2 bg-green-600 text-white rounded"}," Save ",-1))])]),_:1},8,["validation-schema","initial-values","validation-context"]))])])):R("",!0)])]),_:1}))}},je=ee(Ae,[["__scopeId","data-v-877f45d7"]]);export{je as default};
