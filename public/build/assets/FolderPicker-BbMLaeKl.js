import{m as v,p as f,f as d,o as u,h as y,b as r,c as A,t as x,F as V,s as S,j as N,k as C,N as j}from"./app-987s675R.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";function B(e){try{return typeof e=="string"?JSON.parse(e):e}catch{return e}}function _(e={}){const a=B(e.name),l=a&&typeof a=="object"?a:{en:a??"",ar:a??""};return{id:e.id,file_type:e.file_type,name_en:l.en??"",name_ar:l.ar??"",label:l.en||l.ar||`Folder #${e.id}`,folder_image:e.folder_image?`/storage/${e.folder_image}`:null,unit_id:e.unit_id??null}}function D(e){var a;return Array.isArray(e)?e:Array.isArray(e==null?void 0:e.data)?e.data:Array.isArray(e==null?void 0:e.message)?e.message:Array.isArray((a=e==null?void 0:e.data)==null?void 0:a.data)?e.data.data:[]}const I={list:async(e,a=null)=>{const{data:l}=await v.get(`/api/folder/${e}`,{params:a?{unit_id:a}:{}});return D(l).map(_)},create:async e=>{const{data:a}=await v.post("/api/folder/create",e,{headers:{"Content-Type":"multipart/form-data"}}),l=(a==null?void 0:a.data)??a;return _(l)},update:async(e,a)=>{const{data:l}=await v.post(`/api/folder/update/${e}`,a,{headers:{"Content-Type":"multipart/form-data"}});return _((l==null?void 0:l.data)??l)},remove:async e=>{const{data:a}=await v.delete(`/api/folder/delete/${e}`);return a}};function L({file_type:e,name:a={en:"",ar:""},folder_image:l=null,unit_id:c=null}){const s=new FormData;return s.append("file_type",e),s.append("name[en]",a.en??""),s.append("name[ar]",a.ar??""),c&&s.append("unit_id",c),l&&s.append("folder_image",l),s}const T={key:0,class:"block text-xs text-gray-500 mb-1"},U={class:"flex gap-2"},q=["value"],z=["value"],M={key:0,class:"fixed inset-0 z-[1000] flex items-center justify-center"},R={class:"relative z-10 bg-white rounded-2xl shadow-2xl w-full max-w-lg p-6 animate-fadeIn"},E={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},J={class:"md:col-span-2"},O=["src"],P={class:"mt-6 flex justify-end gap-3"},G=["disabled"],H={key:0,class:"mt-3 text-sm text-red-600"},K={__name:"FolderPicker",props:{type:{type:String,required:!0},modelValue:{type:[Number,String,null],default:null},label:{type:String,default:"Folder"},options:{type:Array,required:!0},unitId:{type:[Number,String],required:!0}},emits:["update:modelValue","created"],setup(e,{emit:a}){const l=e,c=a,s=f(!1),p=f(!1),m=f(""),i=f({name:{en:"",ar:""},folder_image:null}),g=f(null);function F(o){var n;const t=((n=o.target.files)==null?void 0:n[0])||null;i.value.folder_image=t,g.value=t?URL.createObjectURL(t):null}function b(){s.value=!1,m.value="",i.value={name:{en:"",ar:""},folder_image:null},g.value=null}function w(o){const t=Number(o);return Number.isNaN(t)?null:t}async function h(){var o,t;p.value=!0,m.value="";try{const n=L({file_type:l.type,unit_id:l.unitId,name:i.value.name,folder_image:i.value.folder_image}),k=await I.create(n);c("created",k),c("update:modelValue",k.id),b()}catch(n){m.value=((t=(o=n==null?void 0:n.response)==null?void 0:o.data)==null?void 0:t.message)||(n==null?void 0:n.message)||"Create failed"}finally{p.value=!1}}return(o,t)=>(u(),d("div",null,[e.label?(u(),d("label",T,x(e.label),1)):y("",!0),r("div",U,[r("select",{class:"form-input flex-1",value:e.modelValue??"",onChange:t[0]||(t[0]=n=>o.$emit("update:modelValue",w(n.target.value)))},[t[4]||(t[4]=r("option",{value:"",disabled:""},"Select folder",-1)),(u(!0),d(V,null,S(e.options,n=>(u(),d("option",{key:n.id,value:n.id},x(n.label),9,z))),128))],40,q),r("button",{type:"button",class:"px-2 py-1 border rounded",onClick:t[1]||(t[1]=n=>s.value=!0)}," + New ")]),(u(),A(j,{to:"body"},[s.value?(u(),d("div",M,[r("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:b}),r("div",R,[r("div",{class:"flex items-center justify-between mb-4"},[t[5]||(t[5]=r("h3",{class:"text-xl font-semibold text-gray-800"},"Create Folder",-1)),r("button",{class:"text-gray-400 hover:text-gray-600",onClick:b}," ✕ ")]),r("div",E,[r("div",null,[t[6]||(t[6]=r("label",{class:"block text-xs text-gray-500 mb-1"},"Name (EN) *",-1)),N(r("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>i.value.name.en=n),type:"text",class:"form-input"},null,512),[[C,i.value.name.en]])]),r("div",null,[t[7]||(t[7]=r("label",{class:"block text-xs text-gray-500 mb-1"},"Name (AR) *",-1)),N(r("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>i.value.name.ar=n),type:"text",class:"form-input"},null,512),[[C,i.value.name.ar]])]),r("div",J,[t[8]||(t[8]=r("label",{class:"block text-xs text-gray-500 mb-1"},"Image (optional)",-1)),r("input",{type:"file",accept:"image/*",onChange:F,class:"form-input"},null,32),g.value?(u(),d("img",{key:0,src:g.value,class:"mt-2 w-24 h-16 object-cover rounded border"},null,8,O)):y("",!0)])]),r("div",P,[r("button",{class:"px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-100",onClick:b}," Cancel "),r("button",{class:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",disabled:p.value||!i.value.name.en.trim()||!i.value.name.ar.trim(),onClick:h},x(p.value?"Saving…":"Create"),9,G)]),m.value?(u(),d("div",H,x(m.value),1)):y("",!0)])])):y("",!0)]))]))}},X=$(K,[["__scopeId","data-v-667dd21d"]]);export{X as F,I as a};
