import{k as u,l as d,m as C,p as L,c as N,o as l,w as R,b as n,f as o,h as y,j as S,v as M,t as _,F as I,q as T,n as V}from"./app-Cz439Bzo.js";import{_ as z}from"./AuthenticatedLayout-BYgS9ozV.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";function k(e={}){return{...e,image_url:e.image?`/storage/${e.image}`:"",is_enabled:Number(e.is_enabled)===1||e.is_enabled===!0}}function B(e){var a;return Array.isArray(e)?e:Array.isArray(e==null?void 0:e.message)?e.message:Array.isArray(e==null?void 0:e.data)?e.data:Array.isArray((a=e==null?void 0:e.data)==null?void 0:a.data)?e.data.data:[]}function O(e){return(e==null?void 0:e.data)??(e==null?void 0:e.message)??e}const m={index:async(e={})=>{const{data:a}=await u.get("/api/banners",{params:e});return B(a).map(k)},edit:async e=>{const{data:a}=await u.get(`/api/banners/edit/${e}`);return k(O(a))},create:async e=>{const{data:a}=await u.post("/api/banners/create",e,{headers:{"Content-Type":"multipart/form-data"}});return a},update:async(e,a)=>{const{data:i}=await u.post(`/api/banners/update/${e}`,a,{headers:{"Content-Type":"multipart/form-data"}});return i},destroy:async e=>{const{data:a}=await u.delete(`/api/banners/delete/${e}`);return a},publicGet:async()=>{const{data:e}=await u.get("/api/user/get-banner");return B(e).map(k)}};function q({image:e,is_enabled:a=!0}){const i=new FormData;return e&&i.append("image",e),i.append("is_enabled",(a?1:0).toString()),i}function A({image:e=null,is_enabled:a=null}){const i=new FormData;return e&&i.append("image",e),a!==null&&i.append("is_enabled",(a?1:0).toString()),i}const P={class:"p-6 space-y-6"},H={class:"bg-white p-4 rounded shadow"},J={class:"grid md:grid-cols-[1fr_auto_auto] items-end gap-4"},K={key:0,class:"mt-2"},Q=["src"],W={class:"flex items-center gap-2"},X=["disabled"],Y={key:0,class:"text-sm text-red-600 mt-2"},Z={class:"bg-white p-4 rounded shadow"},ee={key:0,class:"text-sm text-gray-500"},te={key:1,class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4"},ne={class:"aspect-[4/3] bg-white flex items-center justify-center"},se=["src"],ae={key:1,class:"text-gray-400 text-sm"},re={class:"p-2 space-y-2"},ie={class:"flex items-center justify-between text-xs text-gray-600"},le={class:"flex items-center gap-2 text-sm"},oe=["checked","onChange"],ce={class:"text-xs"},de=["onChange"],ue={class:"flex gap-2 pt-1"},fe=["onClick","disabled"],ge=["onClick"],_e={key:0,class:"col-span-full text-center text-gray-500 py-8"},me={__name:"BannerManagement",setup(e){const a=d([]),i=d(!1),f=d(null),p=d(null),v=d(!0),b=d(!1),h=d("");function D(r){var t;const s=((t=r.target.files)==null?void 0:t[0])||null;f.value=s,p.value=s?URL.createObjectURL(s):null}async function F(){var r,s;if(f.value){b.value=!0,h.value="";try{const t=q({image:f.value,is_enabled:v.value});await m.create(t),await g(),f.value=null,p.value=null,v.value=!0}catch(t){h.value=((s=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:s.message)||(t==null?void 0:t.message)||"Upload failed"}finally{b.value=!1}}}async function g(){try{i.value=!0,a.value=await m.index()}finally{i.value=!1}}async function $(r){const s=r.is_enabled;r.is_enabled=!s;try{const t=A({is_enabled:r.is_enabled});await m.update(r.id,t)}catch(t){r.is_enabled=s,console.error("Toggle failed:",t)}}const x=C({}),w=C({});function j(r,s){var c;const t=((c=s.target.files)==null?void 0:c[0])||null;t&&(x[r]=t)}async function E(r){const s=x[r];if(s){w[r]=!0;try{const t=A({image:s});await m.update(r,t),delete x[r],await g()}catch(t){console.error("Replace failed:",t)}finally{w[r]=!1}}}async function U(r){confirm("Delete this banner?")&&(await m.destroy(r),await g())}return L(g),(r,s)=>(l(),N(z,null,{default:R(()=>[n("div",P,[s[5]||(s[5]=n("h2",{class:"text-2xl font-semibold text-gray-800"},"Banners Gallery",-1)),n("div",H,[s[2]||(s[2]=n("h3",{class:"text-lg font-bold mb-3"},"Add Banner",-1)),n("div",J,[n("div",null,[n("input",{type:"file",accept:"image/*",onChange:D,class:"form-input"},null,32),p.value?(l(),o("div",K,[n("img",{src:p.value,class:"w-48 h-28 object-cover rounded border"},null,8,Q)])):y("",!0)]),n("label",W,[S(n("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=t=>v.value=t)},null,512),[[M,v.value]]),s[1]||(s[1]=n("span",null,"Enabled",-1))]),n("button",{disabled:b.value||!f.value,class:"px-4 py-2 bg-green-600 text-white rounded disabled:opacity-60",onClick:F},_(b.value?"Uploading…":"Upload"),9,X)]),h.value?(l(),o("div",Y,_(h.value),1)):y("",!0)]),n("div",Z,[n("div",{class:"flex items-center justify-between mb-4"},[s[3]||(s[3]=n("h3",{class:"text-lg font-bold"},"All Banners",-1)),n("button",{onClick:g,class:"px-3 py-1 border rounded"},"Refresh")]),i.value?(l(),o("div",ee,"Loading…")):(l(),o("div",te,[(l(!0),o(I,null,T(a.value,t=>(l(),o("div",{key:t.id,class:"rounded border overflow-hidden bg-gray-50"},[n("div",ne,[t.image_url?(l(),o("img",{key:0,src:t.image_url,class:"w-full h-full object-cover"},null,8,se)):(l(),o("div",ae,"No Image"))]),n("div",re,[n("div",ie,[n("span",null,"#"+_(t.id),1),n("span",{class:V(t.is_enabled?"text-green-600":"text-gray-400")},_(t.is_enabled?"Enabled":"Disabled"),3)]),n("label",le,[n("input",{type:"checkbox",checked:t.is_enabled,onChange:c=>$(t)},null,40,oe),s[4]||(s[4]=n("span",null,"Enable",-1))]),n("div",ce,[n("input",{type:"file",accept:"image/*",onChange:c=>j(t.id,c)},null,40,de)]),n("div",ue,[n("button",{class:"px-2 py-1 border rounded text-sm",onClick:c=>E(t.id),disabled:!x[t.id]||w[t.id]},_(w[t.id]?"Saving…":"Save"),9,fe),n("button",{class:"px-2 py-1 border rounded text-sm text-red-600",onClick:c=>U(t.id)}," Delete ",8,ge)])])]))),128)),a.value.length?y("",!0):(l(),o("div",_e," No banners found. "))]))])])]),_:1}))}},he=G(me,[["__scopeId","data-v-a8d800a3"]]);export{he as default};
