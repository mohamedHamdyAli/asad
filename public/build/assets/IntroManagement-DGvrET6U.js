import{m as _,p as g,q as L,f as u,o as c,a as E,u as R,g as O,w as T,b as e,h,F as U,s as B,t as b,n as q,e as J,z as K,d as G,j as y,k as w,v as P}from"./app-JYR8DZsF.js";import{_ as H}from"./AuthenticatedLayout-4E8zXejd.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";function W(t){try{return typeof t=="string"?JSON.parse(t):t}catch{return t}}function D(t){const a=W(t);return a&&typeof a=="object"?{en:a.en??"",ar:a.ar??""}:{en:a??"",ar:a??""}}function N(t){const a=D(t==null?void 0:t.name),d=D(t==null?void 0:t.description);return{...t,name_en:a.en,name_ar:a.ar,description_en:d.en,description_ar:d.ar,image_url:t!=null&&t.image?`/storage/${t.image}`:"",is_enabled:Number(t==null?void 0:t.is_enabled)===1||(t==null?void 0:t.is_enabled)===!0}}const I={index:async(t={})=>{const{data:a}=await _.get("/api/intro",{params:t});return(Array.isArray(a)?a:(a==null?void 0:a.data)??a??[]).map(N)},edit:async t=>{const{data:a}=await _.get(`/api/intro/edit/${t}`),d=(a==null?void 0:a.data)??a;return N(d)},create:async t=>{const{data:a}=await _.post("/api/intro/create",t,{headers:{"Content-Type":"multipart/form-data"}});return a},update:async(t,a)=>{const{data:d}=await _.post(`/api/intro/update/${t}`,a,{headers:{"Content-Type":"multipart/form-data"}});return d},destroy:async t=>{const{data:a}=await _.delete(`/api/intro/delete/${t}`);return a},publicGetIntro:async()=>{const{data:t}=await _.get("/api/user/get-intro");return(Array.isArray(t)?t:(t==null?void 0:t.data)??t??[]).map(N)}};function X({name:t={en:"",ar:""},description:a={en:"",ar:""},image:d=null,order:p="",is_enabled:v=!0}){const i=new FormData;return i.append("name[en]",t.en??""),i.append("name[ar]",t.ar??""),i.append("description[en]",a.en??""),i.append("description[ar]",a.ar??""),d&&i.append("image",d),p!==""&&p!==null&&p!==void 0&&i.append("order",String(p)),i.append("is_enabled",(v?1:0).toString()),i}const Y={class:"p-6 space-y-6"},Z={class:"bg-white p-5 rounded-2xl shadow-sm ring-1 ring-black/[0.05]"},ee={key:0,class:"text-sm text-gray-500"},te={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-5"},ae={class:"relative aspect-[4/3] bg-gray-50"},se=["src"],ne={key:1,class:"absolute inset-0 flex items-center justify-center text-gray-400 text-sm"},re={class:"absolute top-2 left-2 flex flex-wrap gap-2"},oe={class:"inline-flex items-center rounded-full bg-white/90 backdrop-blur px-2 py-0.5 text-[11px] font-medium text-gray-700 border border-gray-200"},le={class:"p-3.5 space-y-3"},de={class:"text-sm font-semibold text-gray-900 whitespace-pre-wrap break-words"},ie={key:0,class:"text-gray-400"},ue={dir:"rtl"},ce={class:"text-xs text-gray-600"},pe={dir:"rtl",class:"text-gray-500"},ge={class:"flex gap-2 pt-3"},be=["onClick"],ve=["onClick"],fe={key:0,class:"col-span-full text-center text-gray-500 py-8"},_e={class:"relative mx-auto w-full max-w-2xl p-4 sm:p-6 h-full flex items-center justify-center"},ye={class:"bg-white rounded-2xl shadow-lg w-full max-h-[90vh] overflow-y-auto focus:outline-none"},xe={class:"sticky top-0 z-10 bg-white border-b rounded-t-2xl"},me={class:"flex items-center justify-between px-5 py-3"},he={class:"text-lg font-bold"},we={class:"px-5 py-4 space-y-4"},ke={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ce={class:"flex items-center gap-2"},Ie={class:"space-y-2 md:col-span-2"},Me={key:0,class:"mt-2"},Ne=["src"],Ve={key:0,class:"rounded border border-red-200 bg-red-50 text-red-700 px-3 py-2"},je={class:"sticky bottom-0 z-10 bg-white border-t rounded-b-2xl"},Ae={class:"px-5 py-3 flex items-center gap-3"},Ee=["disabled"],Ue={__name:"IntroManagement",setup(t){const a=g([]),d=g(!1),p=g(!1),v=g(null),i=g(!1),f=g(""),M=g({}),x=g(null),o=g({name:{en:"",ar:""},description:{en:"",ar:""},image:null,order:"",is_enabled:!0});function V(){v.value=null,o.value={name:{en:"",ar:""},description:{en:"",ar:""},image:null,order:"",is_enabled:!0},x.value=null,f.value="",M.value={}}function S(){V(),p.value=!0}async function $(l){V(),v.value=l.id,o.value={name:{en:l.name_en||"",ar:l.name_ar||""},description:{en:l.description_en||"",ar:l.description_ar||""},order:l.order??"",is_enabled:!!l.is_enabled,image:null},x.value=l.image_url||null,p.value=!0}function m(){p.value=!1}function z(l){var s;const n=(s=l.target.files)==null?void 0:s[0];o.value.image=n||null,x.value=n?URL.createObjectURL(n):null}async function k(){try{d.value=!0,a.value=await I.index()}finally{d.value=!1}}async function j(){var l,n,s,C,A;i.value=!0,f.value="",M.value={};try{const r=X(o.value);v.value?await I.update(v.value,r):await I.create(r),await k(),m()}catch(r){((l=r==null?void 0:r.response)==null?void 0:l.status)===422&&((s=(n=r==null?void 0:r.response)==null?void 0:n.data)!=null&&s.errors)?(M.value=r.response.data.errors,f.value=r.response.data.message||"Validation error"):f.value=((A=(C=r==null?void 0:r.response)==null?void 0:C.data)==null?void 0:A.message)||(r==null?void 0:r.message)||"Request failed"}finally{i.value=!1}}async function F(l){confirm("Are you sure you want to delete this intro?")&&(await I.destroy(l),await k())}return L(k),(l,n)=>(c(),u(U,null,[E(R(O),{title:"Intro Management"}),E(H,null,{default:T(()=>[e("div",Y,[e("div",{class:"flex items-center justify-between"},[n[6]||(n[6]=e("h2",{class:"text-2xl font-semibold text-dash-title"},"Intro Management",-1)),e("button",{onClick:S,class:"bg-black text-white px-3 py-2 rounded hover:bg-gray-700 disabled:opacity-50"}," + Add Intro ")]),e("div",Z,[e("div",{class:"flex items-center justify-between mb-4"},[n[7]||(n[7]=e("h3",{class:"text-lg font-semibold text-gray-800"},"Intro Screens",-1)),e("button",{onClick:k,class:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50"}," Refresh ")]),d.value?(c(),u("div",ee,"Loading…")):(c(),u("div",te,[(c(!0),u(U,null,B(a.value,s=>(c(),u("div",{key:s.id,class:"group rounded-2xl overflow-hidden bg-white border border-gray-200/70 shadow hover:shadow-lg hover:-translate-y-0.5 transition-all duration-200"},[e("div",ae,[s.image_url?(c(),u("img",{key:0,src:s.image_url,class:"absolute inset-0 w-full h-full object-cover"},null,8,se)):(c(),u("div",ne," No Image ")),e("div",re,[e("span",oe," Order: "+b(s.order??"—"),1),e("span",{class:q(["inline-flex items-center rounded-full backdrop-blur px-2 py-0.5 text-[11px] font-medium border",s.is_enabled?"bg-green-100 text-green-700 border-green-200":"bg-red-100 text-red-700 border-red-200"])},b(s.is_enabled?"Enabled":"Disabled"),3)])]),e("div",le,[e("div",de,[J(b(s.name_en||"—")+" ",1),s.name_ar?(c(),u("span",ie," / ")):h("",!0),e("span",ue,b(s.name_ar),1)]),e("div",ce,[e("p",null,b(s.description_en||"—"),1),e("p",pe,b(s.description_ar||"—"),1)]),e("div",ge,[e("button",{class:"px-3 py-1.5 text-sm rounded-lg border bg-white hover:bg-gray-50",onClick:C=>$(s)}," Edit ",8,be),e("button",{class:"px-3 py-1.5 text-sm rounded-lg border border-red-200 text-red-700 bg-red-50 hover:bg-red-100",onClick:C=>F(s.id)}," Delete ",8,ve)])])]))),128)),a.value.length?h("",!0):(c(),u("div",fe," No intros found. "))]))]),p.value?(c(),u("div",{key:0,class:"fixed inset-0 z-50",onKeydown:K(m,["esc"])},[e("div",{class:"absolute inset-0 bg-black/40 back-drop",onClick:m}),e("div",_e,[e("div",ye,[e("div",xe,[e("div",me,[e("h3",he,b(v.value?"Edit Intro":"Add Intro"),1),e("button",{onClick:m,class:"text-gray-400 hover:text-gray-600"}," ✕ ")])]),e("div",we,[e("form",{onSubmit:G(j,["prevent"]),class:"space-y-4"},[e("div",ke,[y(e("input",{"onUpdate:modelValue":n[0]||(n[0]=s=>o.value.name.en=s),class:"form-input",type:"text",placeholder:"Name (EN)"},null,512),[[w,o.value.name.en]]),y(e("input",{"onUpdate:modelValue":n[1]||(n[1]=s=>o.value.name.ar=s),class:"form-input",type:"text",placeholder:"الاسم (AR)"},null,512),[[w,o.value.name.ar]]),y(e("textarea",{"onUpdate:modelValue":n[2]||(n[2]=s=>o.value.description.en=s),class:"form-input",placeholder:"Description (EN)"},null,512),[[w,o.value.description.en]]),y(e("textarea",{"onUpdate:modelValue":n[3]||(n[3]=s=>o.value.description.ar=s),class:"form-input",placeholder:"الوصف (AR)"},null,512),[[w,o.value.description.ar]]),y(e("input",{"onUpdate:modelValue":n[4]||(n[4]=s=>o.value.order=s),class:"form-input",type:"number",placeholder:"Order"},null,512),[[w,o.value.order,void 0,{number:!0}]]),e("label",Ce,[y(e("input",{type:"checkbox","onUpdate:modelValue":n[5]||(n[5]=s=>o.value.is_enabled=s)},null,512),[[P,o.value.is_enabled]]),n[8]||(n[8]=e("span",null,"Enabled",-1))]),e("div",Ie,[e("input",{type:"file",onChange:z,class:"form-input"},null,32),x.value?(c(),u("div",Me,[e("img",{src:x.value,class:"w-40 h-24 object-cover rounded border"},null,8,Ne)])):h("",!0)])]),f.value?(c(),u("div",Ve,b(f.value),1)):h("",!0)],32)]),e("div",je,[e("div",Ae,[e("button",{disabled:i.value,class:"px-4 py-2 bg-green-600 text-white rounded disabled:opacity-60",onClick:j},b(i.value?"Saving…":v.value?"Update":"Create"),9,Ee),e("button",{type:"button",class:"px-3 py-2 border rounded",onClick:m},"Cancel")])])])])],32)):h("",!0)])]),_:1})],64))}},Fe=Q(Ue,[["__scopeId","data-v-70472871"]]);export{Fe as default};
