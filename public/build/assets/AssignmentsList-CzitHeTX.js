import{m as r,p as x,i as O,f as i,o,b as s,h as w,t as l,u as y,F as k,s as A,j as L,y as M}from"./app-4D-wkT_p.js";const C={list:async t=>{const{data:a}=await r.get(`/api/unit-contractors/${t}`);return(a==null?void 0:a.data)||[]},create:async t=>r.post("/api/unit-contractors/create",t),update:async t=>r.post("/api/unit-contractors/update",t),remove:async t=>r.delete(`/api/unit-contractors/delete/${t}`)},j={list:async t=>{const{data:a}=await r.get(`/api/unit-consultants/${t}`);return(a==null?void 0:a.data)||[]},create:async t=>r.post("/api/unit-consultants/create",t),update:async t=>r.post("/api/unit-consultants/update",t),remove:async t=>r.delete(`/api/unit-consultants/delete/${t}`)},U={class:"flex items-center justify-between mb-4"},B={class:"text-lg font-semibold"},V={key:0,class:"divide-y divide-gray-200"},q={class:"flex items-center gap-3"},z=["src"],D={class:"font-medium text-gray-800"},F={class:"text-xs text-gray-500"},I=["onClick"],R={key:1,class:"text-center text-gray-500 py-6"},E={key:2,class:"fixed inset-0 z-50 bg-black/40 flex items-center justify-center"},J={class:"bg-white rounded-xl shadow-lg p-5 w-full max-w-md"},P={class:"text-lg font-semibold mb-3"},T={value:"",disabled:""},G=["value"],H={class:"flex justify-end gap-2"},K=["disabled"],Q={__name:"AssignmentsList",props:{items:{type:Array,default:()=>[]},allOptions:{type:Array,default:()=>[]},unitId:{type:[Number,String],required:!0},type:{type:String,required:!0}},emits:["refresh"],setup(t,{emit:a}){const c=t,f=a,m=x(!1),u=x(null),p=c.type==="contractor"?"Contractors":"Consultants";function S(){u.value=null,m.value=!0}function g(){m.value=!1}async function $(){const n={unit_id:c.unitId,data:[{[`${c.type}_id`]:u.value}]};c.type==="contractor"?await C.create(n):await j.create(n),f("refresh"),g()}async function N(n){confirm(`Remove this ${c.type}?`)&&(c.type==="contractor"?await C.remove(n):await j.remove(n),f("refresh"))}return O(()=>c.allOptions.map(n=>{const d=n.consultant||n.contractor||n;let e=d.title;if(typeof e=="string")try{e=JSON.parse(e)}catch{e={}}return{id:d.id,name:(e==null?void 0:e.en)||(e==null?void 0:e.ar)||"(No title)",email:d.email||""}})),(n,d)=>(o(),i("div",null,[s("div",U,[s("h3",B,"Assigned "+l(y(p)),1),s("button",{onClick:S,class:"px-3 py-1 border rounded bg-green-600 text-white hover:bg-green-700"}," + Assign "+l(y(p).slice(0,-1)),1)]),t.items.length?(o(),i("ul",V,[(o(!0),i(k,null,A(t.items,e=>{var v,h,b,_;return o(),i("li",{key:e.id,class:"flex items-center justify-between py-3"},[s("div",q,[(v=e[t.type])!=null&&v.image?(o(),i("img",{key:0,src:`/storage/${e[t.type].image}`,class:"w-10 h-10 rounded-full border object-cover"},null,8,z)):w("",!0),s("div",null,[s("div",D,l(((b=(h=e[t.type])==null?void 0:h.title)==null?void 0:b.en)||"—"),1),s("div",F,l((_=e[t.type])==null?void 0:_.email),1)])]),s("button",{class:"text-sm text-red-600 hover:underline",onClick:W=>N(e.id)}," Remove ",8,I)])}),128))])):(o(),i("div",R," No "+l(y(p).toLowerCase())+" assigned. ",1)),m.value?(o(),i("div",E,[s("div",J,[s("h3",P,"Assign "+l(y(p).slice(0,-1)),1),L(s("select",{"onUpdate:modelValue":d[0]||(d[0]=e=>u.value=e),class:"form-input w-full mb-4"},[s("option",T,"Select "+l(y(p).slice(0,-1)),1),(o(!0),i(k,null,A(t.allOptions,e=>(o(),i("option",{key:e.id,value:e.id},l(e.title_en||e.title_ar||"(No title)")+" — "+l(e.email),9,G))),128))],512),[[M,u.value]]),s("div",H,[s("button",{class:"px-3 py-1 border rounded",onClick:g},"Cancel"),s("button",{class:"px-3 py-1 bg-green-600 text-white rounded disabled:opacity-60",disabled:!u.value,onClick:$}," Assign ",8,K)])])])):w("",!0)]))}},Y=Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"}));export{Y as A,C as U,Q as _,j as a};
