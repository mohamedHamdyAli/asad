import{p,c as N,o as i,b as t,t as c,j as g,k as I,y as T,N as q,m as L,q as Q,f as v,a as W,h as C,F as J,s as H,e as S,n as F,w as X,T as nt,d as at,B as ot}from"./app-D-mhUt9W.js";import{_ as it}from"./AuthenticatedLayout-sps1aX5l.js";import{_ as dt}from"./UnitNav-Xwj82e1F.js";import{U as E,b as rt,a as ut}from"./unitPayments-B2LzEvTW.js";import{b as mt,U as O,a as vt}from"./unitInstallments-B5hWpdmq.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ct={class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},pt={class:"bg-white rounded-xl shadow-xl w-full max-w-3xl p-6 relative animate-fadeIn"},bt={class:"text-xl font-semibold mb-4"},gt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},yt={class:"md:col-span-2"},xt={class:"md:col-span-2"},ft={class:"flex justify-end mt-6 gap-3"},wt=["disabled"],_t={__name:"InstallmentModal",props:{mode:String,data:Object,paymentId:[String,Number]},emits:["close","saved"],setup(b,{emit:r}){var h,V,D,P,M,k,$,u,x,f,j,A;const n=b,s=r,y=p(!1);function w(_,l={}){if(!_)return structuredClone(l);if(typeof _=="string")try{return JSON.parse(_)}catch{return structuredClone(l)}return _}const a=p({title:w((h=n.data)==null?void 0:h.title,{en:"",ar:""}),description:w((V=n.data)==null?void 0:V.description,{en:"",ar:""}),amount:((D=n.data)==null?void 0:D.amount)??"",percentage:((P=n.data)==null?void 0:P.percentage)??"",milestone_date:((M=n.data)==null?void 0:M.milestone_date)??"",submission_date:((k=n.data)==null?void 0:k.submission_date)??"",consultant_approval_date:(($=n.data)==null?void 0:$.consultant_approval_date)??"",due_date:((u=n.data)==null?void 0:u.due_date)??"",status:((x=n.data)==null?void 0:x.status)??"pending",admin_approved:((f=n.data)==null?void 0:f.admin_approved)??!1,approval_date:((j=n.data)==null?void 0:j.approval_date)??"",admin_comment:((A=n.data)==null?void 0:A.admin_comment)??""});async function U(){y.value=!0;try{if(n.mode==="add"){const _=mt(n.paymentId,a.value);await O.create(_)}else{const _=vt(a.value);await O.update(n.data.id,_)}s("saved"),s("close")}catch(_){console.error(_),alert("Failed to save installment")}finally{y.value=!1}}return(_,l)=>(i(),N(q,{to:"body"},[t("div",ct,[t("div",pt,[t("button",{onClick:l[0]||(l[0]=d=>_.$emit("close")),class:"absolute top-3 right-4 text-gray-500 hover:text-black"}," ✕ "),t("h3",bt,c(b.mode==="add"?"Add Installment":"Edit Installment"),1),t("div",gt,[t("div",null,[l[13]||(l[13]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Title (EN) *",-1)),g(t("input",{"onUpdate:modelValue":l[1]||(l[1]=d=>a.value.title.en=d),class:"form-input"},null,512),[[I,a.value.title.en]])]),t("div",null,[l[14]||(l[14]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Title (AR) *",-1)),g(t("input",{"onUpdate:modelValue":l[2]||(l[2]=d=>a.value.title.ar=d),class:"form-input",dir:"rtl"},null,512),[[I,a.value.title.ar]])]),t("div",yt,[l[15]||(l[15]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Description (EN)",-1)),g(t("textarea",{"onUpdate:modelValue":l[3]||(l[3]=d=>a.value.description.en=d),class:"form-input",rows:"2"},null,512),[[I,a.value.description.en]])]),t("div",xt,[l[16]||(l[16]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Description (AR)",-1)),g(t("textarea",{"onUpdate:modelValue":l[4]||(l[4]=d=>a.value.description.ar=d),class:"form-input",rows:"2",dir:"rtl"},null,512),[[I,a.value.description.ar]])]),t("div",null,[l[17]||(l[17]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Amount *",-1)),g(t("input",{"onUpdate:modelValue":l[5]||(l[5]=d=>a.value.amount=d),type:"number",class:"form-input"},null,512),[[I,a.value.amount,void 0,{number:!0}]])]),t("div",null,[l[18]||(l[18]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Percentage",-1)),g(t("input",{"onUpdate:modelValue":l[6]||(l[6]=d=>a.value.percentage=d),type:"number",step:"0.01",class:"form-input"},null,512),[[I,a.value.percentage,void 0,{number:!0}]])]),t("div",null,[l[19]||(l[19]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Milestone Date",-1)),g(t("input",{"onUpdate:modelValue":l[7]||(l[7]=d=>a.value.milestone_date=d),type:"date",class:"form-input"},null,512),[[I,a.value.milestone_date]])]),t("div",null,[l[20]||(l[20]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Submission Date",-1)),g(t("input",{"onUpdate:modelValue":l[8]||(l[8]=d=>a.value.submission_date=d),type:"date",class:"form-input"},null,512),[[I,a.value.submission_date]])]),t("div",null,[l[21]||(l[21]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Consultant Approval Date",-1)),g(t("input",{"onUpdate:modelValue":l[9]||(l[9]=d=>a.value.consultant_approval_date=d),type:"date",class:"form-input"},null,512),[[I,a.value.consultant_approval_date]])]),t("div",null,[l[22]||(l[22]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Due Date",-1)),g(t("input",{"onUpdate:modelValue":l[10]||(l[10]=d=>a.value.due_date=d),type:"date",class:"form-input"},null,512),[[I,a.value.due_date]])]),t("div",null,[l[24]||(l[24]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Status",-1)),g(t("select",{"onUpdate:modelValue":l[11]||(l[11]=d=>a.value.status=d),class:"form-input"},l[23]||(l[23]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"paid"},"Paid",-1),t("option",{value:"overdue"},"Overdue",-1)]),512),[[T,a.value.status]])])]),l[25]||(l[25]=t("hr",{class:"my-6 border-gray-200"},null,-1)),t("div",ft,[t("button",{class:"px-4 py-2 border rounded hover:bg-gray-100",onClick:l[12]||(l[12]=d=>_.$emit("close"))}," Cancel "),t("button",{class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",onClick:U,disabled:y.value},c(y.value?"Saving…":"Save"),9,wt)])])])]))}},kt=Y(_t,[["__scopeId","data-v-5cb2791e"]]),G={list:async b=>{const{data:r}=await L.get(`/api/unit-payments/installments/${b}/invoices`);return Array.isArray(r)?r:(r==null?void 0:r.data)??[]},updateStatus:async(b,r)=>{const{data:n}=await L.post(`/api/unit-payments/installments/${b}/status`,{status:r});return n},confirmInvoice:async(b,r)=>{const{data:n}=await L.post("/api/unit-payments/invoices/confirm",{invoice_id:b,action:r});return n}},$t={class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},It={class:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl p-6 relative animate-fadeIn max-h-[90vh] overflow-y-auto"},Ct={key:0,class:"text-sm text-gray-500"},ht={key:1},Pt={class:"flex justify-between items-start"},Ut={class:"font-semibold text-gray-800"},At={class:"text-blue-600"},Vt={class:"mt-2"},Dt={class:"mt-3"},Mt=["src","onClick"],Nt={class:"flex flex-col gap-2"},St=["onClick","disabled"],jt=["onClick","disabled"],Tt={key:0,class:"text-center text-gray-500 text-sm mt-6"},Lt={class:"bg-white rounded-xl shadow-2xl p-4 w-full max-w-lg"},Ft=["src"],Et={__name:"InvoiceModal",props:{installment:Object},emits:["close"],setup(b,{emit:r}){const n=b,s=p([]),y=p(!1),w=p(""),a=p(""),U=p(!1),h=p(null);Q(async()=>{y.value=!0,s.value=await G.list(n.installment.id),y.value=!1});async function V(k,$){var u,x;if(w.value="",a.value="",!!confirm(`Mark invoice #${k.id} as ${$}?`))try{const f=await G.confirmInvoice(k.id,$);(f==null?void 0:f.status)==="error"?(a.value="error",w.value=f.message||"Action failed."):(f==null?void 0:f.status)==="success"&&(a.value="success",w.value=f.message||"Action successful."),s.value=await G.list(n.installment.id),setTimeout(()=>w.value="",4e3)}catch(f){a.value="error",w.value=((x=(u=f.response)==null?void 0:u.data)==null?void 0:x.message)||"Something went wrong.",setTimeout(()=>w.value="",4e3)}}function D(k){return k?`/storage/${k}`:""}function P(k){h.value=k,U.value=!0}function M(){h.value=null,U.value=!1}return(k,$)=>(i(),N(q,{to:"body"},[t("div",$t,[t("div",It,[t("button",{onClick:$[0]||($[0]=u=>k.$emit("close")),class:"absolute top-3 right-4 text-gray-400 hover:text-gray-700 text-xl"}," ✕ "),$[2]||($[2]=t("h3",{class:"text-2xl font-semibold text-gray-800 mb-6 border-b pb-2"}," Invoices ",-1)),y.value?(i(),v("div",Ct,"Loading...")):(i(),v("div",ht,[(i(!0),v(J,null,H(s.value,u=>(i(),v("div",{key:u.id,class:"p-4 mb-3 border rounded-xl hover:shadow transition bg-gray-50"},[t("div",Pt,[t("div",null,[t("p",Ut,[S(" Invoice #"+c(u.id)+" — ",1),t("span",At,c(u.paid_amount)+" EGP",1)]),t("div",Vt,[t("span",{class:F(["inline-block px-3 py-1 text-xs rounded-full font-medium border",u.status==="confirmed"?"bg-green-100 text-green-700 border-green-200":u.status==="rejected"?"bg-red-100 text-red-700 border-red-200":"bg-yellow-100 text-yellow-700 border-yellow-200"])},c(u.status?u.status.toUpperCase():"PENDING"),3)]),t("div",Dt,[t("img",{src:D(u.invoice_file),alt:"Invoice File",class:"rounded-lg shadow-sm border object-contain max-h-40 cursor-pointer hover:scale-105 transition",onClick:x=>P(u.invoice_file)},null,8,Mt)])]),t("div",Nt,[t("button",{onClick:x=>V(u,"confirm"),class:F(["px-4 py-1.5 rounded-lg text-sm font-medium text-white transition",u.status==="confirmed"?"bg-green-300 cursor-not-allowed":"bg-green-600 hover:bg-green-700"]),disabled:u.status==="confirmed"},c(u.status==="confirmed"?"Approved":"Approve"),11,St),t("button",{onClick:x=>V(u,"reject"),class:"px-4 py-1.5 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700 transition",disabled:u.status==="rejected"},c(u.status==="rejected"?"Rejected":"Reject"),9,jt)])])]))),128)),s.value.length?C("",!0):(i(),v("div",Tt," No invoices found. "))])),W(nt,{name:"fade"},{default:X(()=>[w.value?(i(),v("div",{key:0,class:F(["mt-5 p-3 rounded-lg text-sm font-medium border text-center",a.value==="error"?"bg-red-50 text-red-700 border-red-200":"bg-green-50 text-green-700 border-green-200"])},c(w.value),3)):C("",!0)]),_:1}),U.value?(i(),v("div",{key:2,class:"fixed inset-0 bg-black/60 flex items-center justify-center z-[100]",onClick:at(M,["self"])},[t("div",Lt,[t("div",{class:"flex justify-between items-center mb-2"},[$[1]||($[1]=t("h4",{class:"font-semibold text-gray-700 text-lg"},"Invoice Preview",-1)),t("button",{onClick:M,class:"text-gray-500 hover:text-gray-700 text-xl"}," ✕ ")]),t("img",{src:D(h.value),alt:"Invoice",class:"rounded-lg object-contain max-h-[75vh] w-full"},null,8,Ft)])])):C("",!0)])])]))}},Ot=Y(Et,[["__scopeId","data-v-48c1c86b"]]),zt={class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},Bt={class:"bg-white w-full max-w-2xl rounded-lg p-6 relative shadow-xl animate-fadeIn"},Rt={key:0,class:"text-center text-gray-500 py-8"},Gt={key:1,class:"divide-y divide-gray-200 max-h-96 overflow-y-auto"},qt={class:"flex justify-between items-center"},Jt={class:"font-medium text-gray-800"},Ht={class:"text-sm text-gray-600 mt-1"},Kt={class:"text-sm text-gray-500"},Qt={class:"text-xs text-gray-400"},Wt={key:0,class:"text-sm text-gray-600 mt-1"},Xt={__name:"PaymentLogsModal",props:{logs:{type:Array,default:()=>[]}},setup(b){return(r,n)=>(i(),N(q,{to:"body"},[t("div",zt,[t("div",Bt,[t("button",{onClick:n[0]||(n[0]=s=>r.$emit("close")),class:"absolute right-4 top-3 text-gray-500 hover:text-black"},"✕"),n[1]||(n[1]=t("h3",{class:"text-lg font-semibold mb-4 text-gray-800"},"Payment Logs",-1)),b.logs.length?(i(),v("ul",Gt,[(i(!0),v(J,null,H(b.logs,s=>(i(),v("li",{key:s.id,class:"py-3"},[t("div",qt,[t("div",null,[t("p",Jt,c(s.action||"Action"),1),t("p",Ht,c(s.description||"Description"),1),t("p",Kt,"By: "+c(s.created_by_name||"System Admin"),1)]),t("span",Qt,c(new Date(s.created_at).toLocaleString()),1)]),s.notes?(i(),v("p",Wt,c(s.notes),1)):C("",!0)]))),128))])):(i(),v("div",Rt,"No logs found."))])])]))}},Yt={unitLogs:async b=>{const{data:r}=await L.get(`/api/unit-payments/logs/${b}`);return(r==null?void 0:r.data)??[]},installmentLogs:async b=>{const{data:r}=await L.get(`/api/unit-payments/installment/${b}/logs`);return(r==null?void 0:r.data)??[]}},Zt={class:"container mx-auto p-6"},te={class:"flex border-b mb-6 mt-6 items-center"},ee={key:0,class:"bg-white p-6 rounded shadow mt-6"},le={key:0,class:"text-sm text-gray-500"},se={key:1,class:"text-center text-gray-500 py-6"},ne={key:2,class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},ae={key:1,class:"bg-white p-6 rounded shadow mt-6"},oe={key:0},ie={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},de={class:"mt-4 text-right"},re=["disabled"],ue={key:1,class:"space-y-6"},me={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},ve={class:"flex justify-end gap-2"},ce={key:2,class:"space-y-4"},pe={class:"flex justify-between items-center mb-4"},be=["disabled"],ge={key:0,class:"bg-white rounded-xl shadow-sm p-4"},ye={class:"min-w-full text-sm text-left border"},xe={class:"p-2 border"},fe={class:"p-2 border"},we={class:"p-2 border"},_e={class:"p-2 border"},ke={class:"p-2 border"},$e={class:"p-2 border"},Ie={class:"p-2 border text-center"},Ce=["onClick"],he={class:"p-2 border flex gap-2"},Pe=["onClick"],Ue=["onClick"],Ae=["onClick"],Ve={key:0,class:"text-center py-4 text-gray-500"},Le={__name:"UnitPaymentsAndInstallments",props:{unitId:Number},setup(b){const r=b,n=p("payments"),s=p(null),y=p({total_price:"",installments_count:"",payment_type:"installments",overall_status:"pending"}),w=p(!1),a=p(!1),U=p(!1),h=p([]);function V(m){s.value={...m,editable:{...m}}}async function D(m){x.value=m,U.value=!0;try{const e=await Yt.installmentLogs(m);h.value=e}catch{h.value=[],alert("Failed to fetch logs")}}async function P(){var m;a.value=!0;try{const e=await E.list(r.unitId);if(((m=e==null?void 0:e.data)==null?void 0:m.length)>0||(e==null?void 0:e.length)>0){const o=e.data?e.data[0]:e[0];V(o),x.value=o.id}else s.value=null,x.value=null;n.value==="installments"&&await A()}finally{a.value=!1}}async function M(){w.value=!0;const m=rt(r.unitId,[y.value]);await E.create(m),await P(),w.value=!1}async function k(){if(!s.value)return;const m=ut(s.value.editable);await E.update(s.value.id,m),await P()}async function $(m){confirm("Delete this payment?")&&(await E.remove(m),await P())}function u(m){const e=Number(m);return isNaN(e)?"0.00":e.toFixed(2)}const x=p(null),f=p([]),j=p(!1);async function A(){if(x.value){j.value=!0;try{f.value=await O.list(x.value)}finally{j.value=!1}}}async function _(m){confirm("Delete this installment?")&&(await O.remove(m),await P(),await A())}const l=p(!1),d=p("add"),z=p(null);function Z(){d.value="add",z.value=null,l.value=!0}function tt(m){d.value="edit",z.value=m,l.value=!0}function et(){l.value=!1}const B=p(!1),K=p(null);function lt(m){K.value=m,B.value=!0}function st(){B.value=!1}return Q(P),ot(n,async m=>{m==="installments"&&x.value&&await A()}),(m,e)=>(i(),N(it,null,{default:X(()=>[t("div",Zt,[W(dt,{"unit-id":Number(b.unitId),cols:2},null,8,["unit-id"]),t("div",te,[t("button",{class:F([n.value==="payments"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600","px-4 py-2 font-medium"]),onClick:e[0]||(e[0]=o=>n.value="payments")}," Payments ",2),t("button",{class:F([n.value==="installments"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600","px-4 py-2 font-medium"]),onClick:e[1]||(e[1]=o=>n.value="installments")}," Installments ",2)]),n.value==="payments"?(i(),v("div",ee,[e[16]||(e[16]=t("h3",{class:"text-lg font-semibold mb-3"},"Current Payment",-1)),a.value?(i(),v("div",le,"Loading…")):s.value?(i(),v("div",ne,[t("div",null,[e[12]||(e[12]=t("strong",null,"Total Price:",-1)),S(" "+c(u(s.value.total_price)),1)]),t("div",null,[e[13]||(e[13]=t("strong",null,"Installments:",-1)),S(" "+c(s.value.installments_count),1)]),t("div",null,[e[14]||(e[14]=t("strong",null,"Type:",-1)),S(" "+c(s.value.payment_type),1)]),t("div",null,[e[15]||(e[15]=t("strong",null,"Status:",-1)),S(" "+c(s.value.overall_status),1)])])):(i(),v("div",se," No payment created yet. "))])):C("",!0),n.value==="payments"?(i(),v("div",ae,[e[30]||(e[30]=t("h3",{class:"text-lg font-semibold mb-4"},"Unit Payment",-1)),s.value?(i(),v("div",ue,[t("div",me,[t("div",null,[e[24]||(e[24]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Total Price",-1)),g(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>s.value.editable.total_price=o),type:"number",class:"w-full border p-2 rounded"},null,512),[[I,s.value.editable.total_price,void 0,{number:!0}]])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Installments Count",-1)),g(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>s.value.editable.installments_count=o),type:"number",class:"w-full border p-2 rounded"},null,512),[[I,s.value.editable.installments_count,void 0,{number:!0}]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Type",-1)),g(t("select",{"onUpdate:modelValue":e[8]||(e[8]=o=>s.value.editable.payment_type=o),class:"w-full border p-2 rounded"},e[26]||(e[26]=[t("option",{value:"installments"},"Installments",-1),t("option",{value:"cash"},"Cash",-1)]),512),[[T,s.value.editable.payment_type]])]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Status",-1)),g(t("select",{"onUpdate:modelValue":e[9]||(e[9]=o=>s.value.editable.overall_status=o),class:"w-full border p-2 rounded"},e[28]||(e[28]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"in_progress"},"In Progress",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"overdue"},"Overdue",-1)]),512),[[T,s.value.editable.overall_status]])])]),t("div",ve,[t("button",{onClick:k,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded"}," Save Changes "),t("button",{onClick:e[10]||(e[10]=o=>$(s.value.id)),class:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded"}," Delete ")])])):(i(),v("div",oe,[e[23]||(e[23]=t("p",{class:"text-gray-600 mb-4"},"No payment created yet for this unit.",-1)),t("div",ie,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium mb-1"},"Total Price *",-1)),g(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>y.value.total_price=o),type:"number",class:"form-control w-full border p-2 rounded"},null,512),[[I,y.value.total_price,void 0,{number:!0}]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium mb-1"},"Installments Count *",-1)),g(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>y.value.installments_count=o),type:"number",class:"form-control w-full border p-2 rounded"},null,512),[[I,y.value.installments_count,void 0,{number:!0}]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium mb-1"},"Payment Type *",-1)),g(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>y.value.payment_type=o),class:"form-control w-full border p-2 rounded"},e[19]||(e[19]=[t("option",{value:"installments"},"Installments",-1),t("option",{value:"cash"},"Cash",-1)]),512),[[T,y.value.payment_type]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium mb-1"},"Overall Status *",-1)),g(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>y.value.overall_status=o),class:"form-control w-full border p-2 rounded"},e[21]||(e[21]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"in_progress"},"In Progress",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"overdue"},"Overdue",-1)]),512),[[T,y.value.overall_status]])])]),t("div",de,[t("button",{onClick:M,disabled:w.value,class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded disabled:opacity-50"},c(w.value?"Saving…":"Create Payment"),9,re)])]))])):C("",!0),n.value==="installments"?(i(),v("div",ce,[t("div",pe,[e[31]||(e[31]=t("h3",{class:"text-lg font-semibold text-gray-800"},"Installments",-1)),t("button",{disabled:!s.value,onClick:Z,class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50"}," + Add Installment ",8,be)]),x.value?(i(),v("div",ge,[t("div",{class:"flex justify-between items-center mb-3"},[e[32]||(e[32]=t("h3",{class:"font-semibold text-lg text-gray-800"},"Installments",-1)),t("button",{onClick:A,class:"px-3 py-1 text-sm border rounded-lg hover:bg-gray-50"}," Refresh ")]),t("table",ye,[e[34]||(e[34]=t("thead",{class:"bg-gray-50 text-gray-700 uppercase text-xs"},[t("tr",null,[t("th",{class:"p-2 border"}),t("th",{class:"p-2 border"},"Title"),t("th",{class:"p-2 border"},"Amount"),t("th",{class:"p-2 border"},"Percentage"),t("th",{class:"p-2 border"},"Status"),t("th",{class:"p-2 border"},"Due Date"),t("th",{class:"p-2 border"},"Invoices"),t("th",{class:"p-2 border"},"Actions")])],-1)),t("tbody",null,[(i(!0),v(J,null,H(f.value,o=>(i(),v("tr",{key:o.id,class:"hover:bg-gray-50 transition"},[t("td",xe,c(o.id),1),t("td",fe,c(o.title_en),1),t("td",we,c(o.amount),1),t("td",_e,c(o.percentage),1),t("td",ke,c(o.status),1),t("td",$e,c(o.due_date||"-"),1),t("td",Ie,[t("button",{onClick:R=>lt(o),class:"text-blue-600 underline text-xs hover:text-blue-800"}," View ",8,Ce)]),t("td",he,[t("button",{onClick:R=>tt(o),class:"px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700"}," Edit ",8,Pe),t("button",{onClick:R=>_(o.id),class:"px-2 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700"}," Delete ",8,Ue),t("button",{onClick:R=>D(o.id),class:"px-3 py-1 text-xs border rounded text-gray-700 border-gray-200 hover:bg-gray-50 flex items-center gap-1"},e[33]||(e[33]=[t("i",{class:"fa fa-clock text-blue-500"},null,-1),S(" Logs ")]),8,Ae)])]))),128))])]),f.value.length?C("",!0):(i(),v("div",Ve," No installments found. "))])):C("",!0)])):C("",!0)]),l.value?(i(),N(kt,{key:0,mode:d.value,data:z.value,paymentId:x.value,onClose:et,onSaved:A},null,8,["mode","data","paymentId"])):C("",!0),B.value?(i(),N(Ot,{key:1,installment:K.value,onClose:st},null,8,["installment"])):C("",!0),U.value?(i(),N(Xt,{key:2,logs:h.value,onClose:e[11]||(e[11]=o=>U.value=!1)},null,8,["logs"])):C("",!0)]),_:1}))}};export{Le as default};
