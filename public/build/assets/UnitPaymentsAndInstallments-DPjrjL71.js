import{p as c,c as M,o as r,b as t,t as v,j as b,k as _,y as T,v as at,N as q,m as L,q as Q,f as p,a as W,h as C,F as J,s as H,e as S,n as F,w as X,T as nt,d as ot,i as it}from"./app-F6bKQEA1.js";import{_ as dt}from"./AuthenticatedLayout-BX6gmCjd.js";import{_ as rt}from"./UnitNav-BymYBZZD.js";import{U as E,b as ut,a as mt}from"./unitPayments-DAeJhTIc.js";import{b as pt,U as O,a as vt}from"./unitInstallments-DnmErqOF.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ct={class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},bt={class:"bg-white rounded-xl shadow-xl w-full max-w-3xl p-6 relative animate-fadeIn"},gt={class:"text-xl font-semibold mb-4"},yt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},xt={class:"md:col-span-2"},ft={class:"md:col-span-2"},_t={class:"space-y-4"},wt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},kt={class:"flex items-center gap-2"},$t={class:"md:col-span-2"},It={class:"flex justify-end mt-6 gap-3"},Ct=["disabled"],ht={__name:"InstallmentModal",props:{mode:String,data:Object,paymentId:[String,Number]},emits:["close","saved"],setup(g,{emit:u}){var h,U,V,A,D,k,$,m,I,x,j,N;const n=g,s=u,y=c(!1);function f(w,l={}){if(!w)return structuredClone(l);if(typeof w=="string")try{return JSON.parse(w)}catch{return structuredClone(l)}return w}const a=c({title:f((h=n.data)==null?void 0:h.title,{en:"",ar:""}),description:f((U=n.data)==null?void 0:U.description,{en:"",ar:""}),amount:((V=n.data)==null?void 0:V.amount)??"",percentage:((A=n.data)==null?void 0:A.percentage)??"",milestone_date:((D=n.data)==null?void 0:D.milestone_date)??"",submission_date:((k=n.data)==null?void 0:k.submission_date)??"",consultant_approval_date:(($=n.data)==null?void 0:$.consultant_approval_date)??"",due_date:((m=n.data)==null?void 0:m.due_date)??"",status:((I=n.data)==null?void 0:I.status)??"pending",admin_approved:((x=n.data)==null?void 0:x.admin_approved)??!1,approval_date:((j=n.data)==null?void 0:j.approval_date)??"",admin_comment:((N=n.data)==null?void 0:N.admin_comment)??""});async function P(){y.value=!0;try{if(n.mode==="add"){const w=pt(n.paymentId,a.value);await O.create(w)}else{const w=vt(a.value);await O.update(n.data.id,w)}s("saved"),s("close")}catch(w){console.error(w),alert("Failed to save installment")}finally{y.value=!1}}return(w,l)=>(r(),M(q,{to:"body"},[t("div",ct,[t("div",bt,[t("button",{onClick:l[0]||(l[0]=i=>w.$emit("close")),class:"absolute top-3 right-4 text-gray-500 hover:text-black"}," ✕ "),t("h3",gt,v(g.mode==="add"?"Add Installment":"Edit Installment"),1),t("div",yt,[t("div",null,[l[16]||(l[16]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Title (EN) *",-1)),b(t("input",{"onUpdate:modelValue":l[1]||(l[1]=i=>a.value.title.en=i),class:"form-input"},null,512),[[_,a.value.title.en]])]),t("div",null,[l[17]||(l[17]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Title (AR) *",-1)),b(t("input",{"onUpdate:modelValue":l[2]||(l[2]=i=>a.value.title.ar=i),class:"form-input",dir:"rtl"},null,512),[[_,a.value.title.ar]])]),t("div",xt,[l[18]||(l[18]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Description (EN)",-1)),b(t("textarea",{"onUpdate:modelValue":l[3]||(l[3]=i=>a.value.description.en=i),class:"form-input",rows:"2"},null,512),[[_,a.value.description.en]])]),t("div",ft,[l[19]||(l[19]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Description (AR)",-1)),b(t("textarea",{"onUpdate:modelValue":l[4]||(l[4]=i=>a.value.description.ar=i),class:"form-input",rows:"2",dir:"rtl"},null,512),[[_,a.value.description.ar]])]),t("div",null,[l[20]||(l[20]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Amount *",-1)),b(t("input",{"onUpdate:modelValue":l[5]||(l[5]=i=>a.value.amount=i),type:"number",class:"form-input"},null,512),[[_,a.value.amount,void 0,{number:!0}]])]),t("div",null,[l[21]||(l[21]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Percentage",-1)),b(t("input",{"onUpdate:modelValue":l[6]||(l[6]=i=>a.value.percentage=i),type:"number",step:"0.01",class:"form-input"},null,512),[[_,a.value.percentage,void 0,{number:!0}]])]),t("div",null,[l[22]||(l[22]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Milestone Date",-1)),b(t("input",{"onUpdate:modelValue":l[7]||(l[7]=i=>a.value.milestone_date=i),type:"date",class:"form-input"},null,512),[[_,a.value.milestone_date]])]),t("div",null,[l[23]||(l[23]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Submission Date",-1)),b(t("input",{"onUpdate:modelValue":l[8]||(l[8]=i=>a.value.submission_date=i),type:"date",class:"form-input"},null,512),[[_,a.value.submission_date]])]),t("div",null,[l[24]||(l[24]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Consultant Approval Date",-1)),b(t("input",{"onUpdate:modelValue":l[9]||(l[9]=i=>a.value.consultant_approval_date=i),type:"date",class:"form-input"},null,512),[[_,a.value.consultant_approval_date]])]),t("div",null,[l[25]||(l[25]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Due Date",-1)),b(t("input",{"onUpdate:modelValue":l[10]||(l[10]=i=>a.value.due_date=i),type:"date",class:"form-input"},null,512),[[_,a.value.due_date]])]),t("div",null,[l[27]||(l[27]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Status",-1)),b(t("select",{"onUpdate:modelValue":l[11]||(l[11]=i=>a.value.status=i),class:"form-input"},l[26]||(l[26]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"paid"},"Paid",-1),t("option",{value:"overdue"},"Overdue",-1)]),512),[[T,a.value.status]])])]),l[32]||(l[32]=t("hr",{class:"my-6 border-gray-200"},null,-1)),t("div",_t,[l[31]||(l[31]=t("h4",{class:"font-semibold text-gray-800 text-base"},"Admin Invoice Approval",-1)),t("div",wt,[t("div",kt,[b(t("input",{type:"checkbox","onUpdate:modelValue":l[12]||(l[12]=i=>a.value.admin_approved=i),id:"admin_approved",class:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"},null,512),[[at,a.value.admin_approved]]),l[28]||(l[28]=t("label",{for:"admin_approved",class:"text-sm text-gray-700"},"Mark as Approved",-1))]),t("div",null,[l[29]||(l[29]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Approval Date",-1)),b(t("input",{"onUpdate:modelValue":l[13]||(l[13]=i=>a.value.approval_date=i),type:"date",class:"form-input"},null,512),[[_,a.value.approval_date]])]),t("div",$t,[l[30]||(l[30]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Admin Comment",-1)),b(t("textarea",{"onUpdate:modelValue":l[14]||(l[14]=i=>a.value.admin_comment=i),class:"form-input",rows:"2",placeholder:"Add approval notes..."},null,512),[[_,a.value.admin_comment]])])])]),t("div",It,[t("button",{class:"px-4 py-2 border rounded hover:bg-gray-100",onClick:l[15]||(l[15]=i=>w.$emit("close"))}," Cancel "),t("button",{class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",onClick:P,disabled:y.value},v(y.value?"Saving…":"Save"),9,Ct)])])])]))}},Pt=Y(ht,[["__scopeId","data-v-bb3fd775"]]),G={list:async g=>{const{data:u}=await L.get(`/api/unit-payments/installments/${g}/invoices`);return Array.isArray(u)?u:(u==null?void 0:u.data)??[]},updateStatus:async(g,u)=>{const{data:n}=await L.post(`/api/unit-payments/installments/${g}/status`,{status:u});return n},confirmInvoice:async(g,u)=>{const{data:n}=await L.post("/api/unit-payments/invoices/confirm",{invoice_id:g,action:u});return n}},Ut={class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},At={class:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl p-6 relative animate-fadeIn"},Vt={key:0,class:"text-sm text-gray-500"},Dt={key:1},Mt={class:"flex justify-between items-start"},Nt={class:"font-semibold text-gray-800"},St={class:"text-blue-600"},jt={class:"mt-2"},Tt={class:"mt-3"},Lt=["src","onClick"],Ft={class:"flex flex-col gap-2"},Et=["onClick","disabled"],Ot=["onClick","disabled"],zt={key:0,class:"text-center text-gray-500 text-sm mt-6"},Bt={class:"bg-white rounded-xl shadow-2xl p-4 w-full max-w-lg"},Rt=["src"],Gt={__name:"InvoiceModal",props:{installment:Object},emits:["close"],setup(g,{emit:u}){const n=g,s=c([]),y=c(!1),f=c(""),a=c(""),P=c(!1),h=c(null);Q(async()=>{y.value=!0,s.value=await G.list(n.installment.id),y.value=!1});async function U(k,$){var m,I;if(f.value="",a.value="",!!confirm(`Mark invoice #${k.id} as ${$}?`))try{const x=await G.confirmInvoice(k.id,$);(x==null?void 0:x.status)==="error"?(a.value="error",f.value=x.message||"Action failed."):(x==null?void 0:x.status)==="success"&&(a.value="success",f.value=x.message||"Action successful."),s.value=await G.list(n.installment.id),setTimeout(()=>f.value="",4e3)}catch(x){a.value="error",f.value=((I=(m=x.response)==null?void 0:m.data)==null?void 0:I.message)||"Something went wrong.",setTimeout(()=>f.value="",4e3)}}function V(k){return k?`/storage/${k}`:""}function A(k){h.value=k,P.value=!0}function D(){h.value=null,P.value=!1}return(k,$)=>(r(),M(q,{to:"body"},[t("div",Ut,[t("div",At,[t("button",{onClick:$[0]||($[0]=m=>k.$emit("close")),class:"absolute top-3 right-4 text-gray-400 hover:text-gray-700 text-xl"}," ✕ "),$[2]||($[2]=t("h3",{class:"text-2xl font-semibold text-gray-800 mb-6 border-b pb-2"}," Invoices ",-1)),y.value?(r(),p("div",Vt,"Loading...")):(r(),p("div",Dt,[(r(!0),p(J,null,H(s.value,m=>(r(),p("div",{key:m.id,class:"p-4 mb-3 border rounded-xl hover:shadow transition bg-gray-50"},[t("div",Mt,[t("div",null,[t("p",Nt,[S(" Invoice #"+v(m.id)+" — ",1),t("span",St,v(m.paid_amount)+" EGP",1)]),t("div",jt,[t("span",{class:F(["inline-block px-3 py-1 text-xs rounded-full font-medium border",m.status==="confirmed"?"bg-green-100 text-green-700 border-green-200":m.status==="rejected"?"bg-red-100 text-red-700 border-red-200":"bg-yellow-100 text-yellow-700 border-yellow-200"])},v(m.status?m.status.toUpperCase():"PENDING"),3)]),t("div",Tt,[t("img",{src:V(m.invoice_file),alt:"Invoice File",class:"rounded-lg shadow-sm border object-contain max-h-40 cursor-pointer hover:scale-105 transition",onClick:I=>A(m.invoice_file)},null,8,Lt)])]),t("div",Ft,[t("button",{onClick:I=>U(m,"confirm"),class:F(["px-4 py-1.5 rounded-lg text-sm font-medium text-white transition",m.status==="confirmed"?"bg-green-300 cursor-not-allowed":"bg-green-600 hover:bg-green-700"]),disabled:m.status==="confirmed"},v(m.status==="confirmed"?"Approved":"Approve"),11,Et),t("button",{onClick:I=>U(m,"reject"),class:"px-4 py-1.5 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700 transition",disabled:m.status==="rejected"},v(m.status==="rejected"?"Rejected":"Reject"),9,Ot)])])]))),128)),s.value.length?C("",!0):(r(),p("div",zt," No invoices found. "))])),W(nt,{name:"fade"},{default:X(()=>[f.value?(r(),p("div",{key:0,class:F(["mt-5 p-3 rounded-lg text-sm font-medium border text-center",a.value==="error"?"bg-red-50 text-red-700 border-red-200":"bg-green-50 text-green-700 border-green-200"])},v(f.value),3)):C("",!0)]),_:1}),P.value?(r(),p("div",{key:2,class:"fixed inset-0 bg-black/60 flex items-center justify-center z-[100]",onClick:ot(D,["self"])},[t("div",Bt,[t("div",{class:"flex justify-between items-center mb-2"},[$[1]||($[1]=t("h4",{class:"font-semibold text-gray-700 text-lg"},"Invoice Preview",-1)),t("button",{onClick:D,class:"text-gray-500 hover:text-gray-700 text-xl"}," ✕ ")]),t("img",{src:V(h.value),alt:"Invoice",class:"rounded-lg object-contain max-h-[75vh] w-full"},null,8,Rt)])])):C("",!0)])])]))}},qt=Y(Gt,[["__scopeId","data-v-0ced344b"]]),Jt={class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},Ht={class:"bg-white w-full max-w-2xl rounded-lg p-6 relative shadow-xl animate-fadeIn"},Kt={key:0,class:"text-center text-gray-500 py-8"},Qt={key:1,class:"divide-y divide-gray-200 max-h-96 overflow-y-auto"},Wt={class:"flex justify-between items-center"},Xt={class:"font-medium text-gray-800"},Yt={class:"text-sm text-gray-600 mt-1"},Zt={class:"text-sm text-gray-500"},te={class:"text-xs text-gray-400"},ee={key:0,class:"text-sm text-gray-600 mt-1"},le={__name:"PaymentLogsModal",props:{logs:{type:Array,default:()=>[]}},setup(g){return(u,n)=>(r(),M(q,{to:"body"},[t("div",Jt,[t("div",Ht,[t("button",{onClick:n[0]||(n[0]=s=>u.$emit("close")),class:"absolute right-4 top-3 text-gray-500 hover:text-black"},"✕"),n[1]||(n[1]=t("h3",{class:"text-lg font-semibold mb-4 text-gray-800"},"Payment Logs",-1)),g.logs.length?(r(),p("ul",Qt,[(r(!0),p(J,null,H(g.logs,s=>(r(),p("li",{key:s.id,class:"py-3"},[t("div",Wt,[t("div",null,[t("p",Xt,v(s.action||"Action"),1),t("p",Yt,v(s.description||"Description"),1),t("p",Zt,"By: "+v(s.created_by_name||"System Admin"),1)]),t("span",te,v(new Date(s.created_at).toLocaleString()),1)]),s.notes?(r(),p("p",ee,v(s.notes),1)):C("",!0)]))),128))])):(r(),p("div",Kt,"No logs found."))])])]))}},se={unitLogs:async g=>{const{data:u}=await L.get(`/api/unit-payments/logs/${g}`);return(u==null?void 0:u.data)??[]},installmentLogs:async g=>{const{data:u}=await L.get(`/api/unit-payments/installment/${g}/logs`);return(u==null?void 0:u.data)??[]}},ae={class:"container mx-auto p-6"},ne={class:"flex border-b mb-6 mt-6 items-center"},oe={key:0,class:"bg-white p-6 rounded shadow mt-6"},ie={key:0,class:"text-sm text-gray-500"},de={key:1,class:"text-center text-gray-500 py-6"},re={key:2,class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},ue={key:1,class:"bg-white p-6 rounded shadow mt-6"},me={key:0},pe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ve={class:"mt-4 text-right"},ce=["disabled"],be={key:1,class:"space-y-6"},ge={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},ye={class:"flex justify-end gap-2"},xe={key:2,class:"space-y-4"},fe={class:"flex justify-between items-center mb-4"},_e=["disabled"],we={key:0,class:"bg-white rounded-xl shadow-sm p-4"},ke={class:"min-w-full text-sm text-left border"},$e={class:"p-2 border"},Ie={class:"p-2 border"},Ce={class:"p-2 border"},he={class:"p-2 border"},Pe={class:"p-2 border"},Ue={class:"p-2 border"},Ae={class:"p-2 border text-center"},Ve=["onClick"],De={class:"p-2 border flex gap-2"},Me=["onClick"],Ne=["onClick"],Se=["onClick"],je={key:0,class:"text-center py-4 text-gray-500"},Be={__name:"UnitPaymentsAndInstallments",props:{unitId:Number},setup(g){const u=g,n=c("payments"),s=c(null),y=c({total_price:"",installments_count:"",payment_type:"installments",overall_status:"pending"}),f=c(!1),a=c(!1),P=c(!1),h=c([]);function U(o){s.value={...o,editable:{...o}}}async function V(o){I.value=o,P.value=!0;try{const e=await se.installmentLogs(o);h.value=e}catch{h.value=[],alert("Failed to fetch logs")}}async function A(){a.value=!0;try{const o=await E.list(u.unitId);Array.isArray(o)&&o.length>0?U(o[0]):o!=null&&o.data&&Array.isArray(o.data)&&o.data.length>0?U(o.data[0]):s.value=null}catch(o){console.error("Failed to fetch payment:",o),s.value=null}finally{a.value=!1}}async function D(){f.value=!0;const o=ut(u.unitId,[y.value]);await E.create(o),await A(),f.value=!1}async function k(){if(!s.value)return;const o=mt(s.value.editable);await E.update(s.value.id,o),await A()}async function $(o){confirm("Delete this payment?")&&(await E.remove(o),await fetchPayments())}function m(o){const e=Number(o);return isNaN(e)?"0.00":e.toFixed(2)}const I=it(()=>{var o;return((o=s.value)==null?void 0:o.id)||null}),x=c([]),j=c(!1);async function N(){if(I.value){j.value=!0;try{x.value=await O.list(I.value)}finally{j.value=!1}}}async function w(o){confirm("Delete this installment?")&&(await O.remove(o),await N())}const l=c(!1),i=c("add"),z=c(null);function Z(){i.value="add",z.value=null,l.value=!0}function tt(o){i.value="edit",z.value=o,l.value=!0}function et(){l.value=!1}const B=c(!1),K=c(null);function lt(o){K.value=o,B.value=!0}function st(){B.value=!1}return Q(A),(o,e)=>(r(),M(dt,null,{default:X(()=>[t("div",ae,[W(rt,{"unit-id":Number(g.unitId),cols:2},null,8,["unit-id"]),t("div",ne,[t("button",{class:F([n.value==="payments"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600","px-4 py-2 font-medium"]),onClick:e[0]||(e[0]=d=>n.value="payments")}," Payments ",2),t("button",{class:F([n.value==="installments"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600","px-4 py-2 font-medium"]),onClick:e[1]||(e[1]=d=>n.value="installments")}," Installments ",2)]),n.value==="payments"?(r(),p("div",oe,[e[16]||(e[16]=t("h3",{class:"text-lg font-semibold mb-3"},"Current Payment",-1)),a.value?(r(),p("div",ie,"Loading…")):s.value?(r(),p("div",re,[t("div",null,[e[12]||(e[12]=t("strong",null,"Total Price:",-1)),S(" "+v(m(s.value.total_price)),1)]),t("div",null,[e[13]||(e[13]=t("strong",null,"Installments:",-1)),S(" "+v(s.value.installments_count),1)]),t("div",null,[e[14]||(e[14]=t("strong",null,"Type:",-1)),S(" "+v(s.value.payment_type),1)]),t("div",null,[e[15]||(e[15]=t("strong",null,"Status:",-1)),S(" "+v(s.value.overall_status),1)])])):(r(),p("div",de," No payment created yet. "))])):C("",!0),n.value==="payments"?(r(),p("div",ue,[e[30]||(e[30]=t("h3",{class:"text-lg font-semibold mb-4"},"Unit Payment",-1)),s.value?(r(),p("div",be,[t("div",ge,[t("div",null,[e[24]||(e[24]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Total Price",-1)),b(t("input",{"onUpdate:modelValue":e[6]||(e[6]=d=>s.value.editable.total_price=d),type:"number",class:"w-full border p-2 rounded"},null,512),[[_,s.value.editable.total_price,void 0,{number:!0}]])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Installments Count",-1)),b(t("input",{"onUpdate:modelValue":e[7]||(e[7]=d=>s.value.editable.installments_count=d),type:"number",class:"w-full border p-2 rounded"},null,512),[[_,s.value.editable.installments_count,void 0,{number:!0}]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Type",-1)),b(t("select",{"onUpdate:modelValue":e[8]||(e[8]=d=>s.value.editable.payment_type=d),class:"w-full border p-2 rounded"},e[26]||(e[26]=[t("option",{value:"installments"},"Installments",-1),t("option",{value:"cash"},"Cash",-1)]),512),[[T,s.value.editable.payment_type]])]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Status",-1)),b(t("select",{"onUpdate:modelValue":e[9]||(e[9]=d=>s.value.editable.overall_status=d),class:"w-full border p-2 rounded"},e[28]||(e[28]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"in_progress"},"In Progress",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"overdue"},"Overdue",-1)]),512),[[T,s.value.editable.overall_status]])])]),t("div",ye,[t("button",{onClick:k,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded"}," Save Changes "),t("button",{onClick:e[10]||(e[10]=d=>$(s.value.id)),class:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded"}," Delete ")])])):(r(),p("div",me,[e[23]||(e[23]=t("p",{class:"text-gray-600 mb-4"},"No payment created yet for this unit.",-1)),t("div",pe,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium mb-1"},"Total Price *",-1)),b(t("input",{"onUpdate:modelValue":e[2]||(e[2]=d=>y.value.total_price=d),type:"number",class:"form-control w-full border p-2 rounded"},null,512),[[_,y.value.total_price,void 0,{number:!0}]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium mb-1"},"Installments Count *",-1)),b(t("input",{"onUpdate:modelValue":e[3]||(e[3]=d=>y.value.installments_count=d),type:"number",class:"form-control w-full border p-2 rounded"},null,512),[[_,y.value.installments_count,void 0,{number:!0}]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium mb-1"},"Payment Type *",-1)),b(t("select",{"onUpdate:modelValue":e[4]||(e[4]=d=>y.value.payment_type=d),class:"form-control w-full border p-2 rounded"},e[19]||(e[19]=[t("option",{value:"installments"},"Installments",-1),t("option",{value:"cash"},"Cash",-1)]),512),[[T,y.value.payment_type]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium mb-1"},"Overall Status *",-1)),b(t("select",{"onUpdate:modelValue":e[5]||(e[5]=d=>y.value.overall_status=d),class:"form-control w-full border p-2 rounded"},e[21]||(e[21]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"in_progress"},"In Progress",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"overdue"},"Overdue",-1)]),512),[[T,y.value.overall_status]])])]),t("div",ve,[t("button",{onClick:D,disabled:f.value,class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded disabled:opacity-50"},v(f.value?"Saving…":"Create Payment"),9,ce)])]))])):C("",!0),n.value==="installments"?(r(),p("div",xe,[t("div",fe,[e[31]||(e[31]=t("h3",{class:"text-lg font-semibold text-gray-800"},"Installments",-1)),t("button",{disabled:!s.value,onClick:Z,class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50"}," + Add Installment ",8,_e)]),I.value?(r(),p("div",we,[t("div",{class:"flex justify-between items-center mb-3"},[e[32]||(e[32]=t("h3",{class:"font-semibold text-lg text-gray-800"},"Installments",-1)),t("button",{onClick:N,class:"px-3 py-1 text-sm border rounded-lg hover:bg-gray-50"}," Refresh ")]),t("table",ke,[e[34]||(e[34]=t("thead",{class:"bg-gray-50 text-gray-700 uppercase text-xs"},[t("tr",null,[t("th",{class:"p-2 border"}),t("th",{class:"p-2 border"},"Title"),t("th",{class:"p-2 border"},"Amount"),t("th",{class:"p-2 border"},"Percentage"),t("th",{class:"p-2 border"},"Status"),t("th",{class:"p-2 border"},"Due Date"),t("th",{class:"p-2 border"},"Invoices"),t("th",{class:"p-2 border"},"Actions")])],-1)),t("tbody",null,[(r(!0),p(J,null,H(x.value,d=>(r(),p("tr",{key:d.id,class:"hover:bg-gray-50 transition"},[t("td",$e,v(d.id),1),t("td",Ie,v(d.title_en),1),t("td",Ce,v(d.amount),1),t("td",he,v(d.percentage),1),t("td",Pe,v(d.status),1),t("td",Ue,v(d.due_date||"-"),1),t("td",Ae,[t("button",{onClick:R=>lt(d),class:"text-blue-600 underline text-xs hover:text-blue-800"}," View ",8,Ve)]),t("td",De,[t("button",{onClick:R=>tt(d),class:"px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700"}," Edit ",8,Me),t("button",{onClick:R=>w(d.id),class:"px-2 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700"}," Delete ",8,Ne),t("button",{onClick:R=>V(d.id),class:"px-3 py-1 text-xs border rounded text-gray-700 border-gray-200 hover:bg-gray-50 flex items-center gap-1"},e[33]||(e[33]=[t("i",{class:"fa fa-clock text-blue-500"},null,-1),S(" Logs ")]),8,Se)])]))),128))])]),x.value.length?C("",!0):(r(),p("div",je," No installments found. "))])):C("",!0)])):C("",!0)]),l.value?(r(),M(Pt,{key:0,mode:i.value,data:z.value,paymentId:I.value,onClose:et,onSaved:N},null,8,["mode","data","paymentId"])):C("",!0),B.value?(r(),M(qt,{key:1,installment:K.value,onClose:st},null,8,["installment"])):C("",!0),P.value?(r(),M(le,{key:2,logs:h.value,onClose:e[11]||(e[11]=d=>P.value=!1)},null,8,["logs"])):C("",!0)]),_:1}))}};export{Be as default};
