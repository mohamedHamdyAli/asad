import{m as u,p as d,r as C,q as R,f as l,o,a as B,u as M,g as S,w as V,b as n,h as y,j as I,v as T,t as _,F as A,s as z,n as G}from"./app-DfJxAqit.js";import{_ as O}from"./AuthenticatedLayout-CfxJujCa.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";function k(e={}){return{...e,image_url:e.image?`/storage/${e.image}`:"",is_enabled:Number(e.is_enabled)===1||e.is_enabled===!0}}function D(e){var a;return Array.isArray(e)?e:Array.isArray(e==null?void 0:e.message)?e.message:Array.isArray(e==null?void 0:e.data)?e.data:Array.isArray((a=e==null?void 0:e.data)==null?void 0:a.data)?e.data.data:[]}function P(e){return(e==null?void 0:e.data)??(e==null?void 0:e.message)??e}const m={index:async(e={})=>{const{data:a}=await u.get("/api/banners",{params:e});return D(a).map(k)},edit:async e=>{const{data:a}=await u.get(`/api/banners/edit/${e}`);return k(P(a))},create:async e=>{const{data:a}=await u.post("/api/banners/create",e,{headers:{"Content-Type":"multipart/form-data"}});return a},update:async(e,a)=>{const{data:i}=await u.post(`/api/banners/update/${e}`,a,{headers:{"Content-Type":"multipart/form-data"}});return i},destroy:async e=>{const{data:a}=await u.delete(`/api/banners/delete/${e}`);return a},publicGet:async()=>{const{data:e}=await u.get("/api/user/get-banner");return D(e).map(k)}};function H({image:e,is_enabled:a=!0}){const i=new FormData;return e&&i.append("image",e),i.append("is_enabled",(a?1:0).toString()),i}function F({image:e=null,is_enabled:a=null}){const i=new FormData;return e&&i.append("image",e),a!==null&&i.append("is_enabled",(a?1:0).toString()),i}const J={class:"p-6 space-y-6"},K={class:"bg-white p-4 rounded shadow"},Q={class:"grid md:grid-cols-[1fr_auto_auto] items-end gap-4"},W={key:0,class:"mt-2"},X=["src"],Y={class:"flex items-center gap-2"},Z=["disabled"],ee={key:0,class:"text-sm text-red-600 mt-2"},te={class:"bg-white p-4 rounded shadow"},ne={key:0,class:"text-sm text-gray-500"},se={key:1,class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4"},ae={class:"aspect-[4/3] bg-white flex items-center justify-center"},re=["src"],ie={key:1,class:"text-gray-400 text-sm"},le={class:"p-2 space-y-2"},oe={class:"flex items-center justify-between text-xs text-gray-600"},ce={class:"flex items-center gap-2 text-sm"},de=["checked","onChange"],ue={class:"text-xs"},fe=["onChange"],ge={class:"flex gap-2 pt-1"},_e=["onClick","disabled"],me=["onClick"],pe={key:0,class:"col-span-full text-center text-gray-500 py-8"},ve={__name:"BannerManagement",setup(e){const a=d([]),i=d(!1),f=d(null),p=d(null),v=d(!0),b=d(!1),h=d("");function $(r){var t;const s=((t=r.target.files)==null?void 0:t[0])||null;f.value=s,p.value=s?URL.createObjectURL(s):null}async function j(){var r,s;if(f.value){b.value=!0,h.value="";try{const t=H({image:f.value,is_enabled:v.value});await m.create(t),await g(),f.value=null,p.value=null,v.value=!0}catch(t){h.value=((s=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:s.message)||(t==null?void 0:t.message)||"Upload failed"}finally{b.value=!1}}}async function g(){try{i.value=!0,a.value=await m.index()}finally{i.value=!1}}async function E(r){const s=r.is_enabled;r.is_enabled=!s;try{const t=F({is_enabled:r.is_enabled});await m.update(r.id,t)}catch(t){r.is_enabled=s,console.error("Toggle failed:",t)}}const x=C({}),w=C({});function N(r,s){var c;const t=((c=s.target.files)==null?void 0:c[0])||null;t&&(x[r]=t)}async function U(r){const s=x[r];if(s){w[r]=!0;try{const t=F({image:s});await m.update(r,t),delete x[r],await g()}catch(t){console.error("Replace failed:",t)}finally{w[r]=!1}}}async function L(r){confirm("Delete this banner?")&&(await m.destroy(r),await g())}return R(g),(r,s)=>(o(),l(A,null,[B(M(S),{title:"Banner Management"}),B(O,null,{default:V(()=>[n("div",J,[s[5]||(s[5]=n("h2",{class:"text-2xl font-semibold text-gray-800"},"Banners Gallery",-1)),n("div",K,[s[2]||(s[2]=n("h3",{class:"text-lg font-bold mb-3"},"Add Banner",-1)),n("div",Q,[n("div",null,[n("input",{type:"file",accept:"image/*",onChange:$,class:"form-input"},null,32),p.value?(o(),l("div",W,[n("img",{src:p.value,class:"w-48 h-28 object-cover rounded border"},null,8,X)])):y("",!0)]),n("label",Y,[I(n("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=t=>v.value=t)},null,512),[[T,v.value]]),s[1]||(s[1]=n("span",null,"Enabled",-1))]),n("button",{disabled:b.value||!f.value,class:"px-4 py-2 bg-green-600 text-white rounded disabled:opacity-60",onClick:j},_(b.value?"Uploading…":"Upload"),9,Z)]),h.value?(o(),l("div",ee,_(h.value),1)):y("",!0)]),n("div",te,[n("div",{class:"flex items-center justify-between mb-4"},[s[3]||(s[3]=n("h3",{class:"text-lg font-bold"},"All Banners",-1)),n("button",{onClick:g,class:"px-3 py-1 border rounded"},"Refresh")]),i.value?(o(),l("div",ne,"Loading…")):(o(),l("div",se,[(o(!0),l(A,null,z(a.value,t=>(o(),l("div",{key:t.id,class:"rounded border overflow-hidden bg-gray-50"},[n("div",ae,[t.image_url?(o(),l("img",{key:0,src:t.image_url,class:"w-full h-full object-cover"},null,8,re)):(o(),l("div",ie,"No Image"))]),n("div",le,[n("div",oe,[n("span",null,"#"+_(t.id),1),n("span",{class:G(t.is_enabled?"text-green-600":"text-gray-400")},_(t.is_enabled?"Enabled":"Disabled"),3)]),n("label",ce,[n("input",{type:"checkbox",checked:t.is_enabled,onChange:c=>E(t)},null,40,de),s[4]||(s[4]=n("span",null,"Enable",-1))]),n("div",ue,[n("input",{type:"file",accept:"image/*",onChange:c=>N(t.id,c)},null,40,fe)]),n("div",ge,[n("button",{class:"px-2 py-1 border rounded text-sm",onClick:c=>U(t.id),disabled:!x[t.id]||w[t.id]},_(w[t.id]?"Saving…":"Save"),9,_e),n("button",{class:"px-2 py-1 border rounded text-sm text-red-600",onClick:c=>L(t.id)}," Delete ",8,me)])])]))),128)),a.value.length?y("",!0):(o(),l("div",pe," No banners found. "))]))])])]),_:1})],64))}},we=q(ve,[["__scopeId","data-v-90a0ded6"]]);export{we as default};
