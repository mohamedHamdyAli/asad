import{i as ie,m as P,z as le,p as oe,H as X,f as g,o as v,h as C,b as r,t as b,e as $,l as D,a as R,u as V,g as Ce,w as M,F as Z,q as Q,S as K,K as Ue,d as Ie,j as O,n as L,s as F,y as te}from"./app-CdqcvLGQ.js";import{_ as Pe}from"./AuthenticatedLayout-CjS34vnV.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as $e}from"./vendors-OUjTicXz.js";function Le(e,n,i,d){function l(y){return y instanceof i?y:new i(function(p){p(y)})}return new(i||(i=Promise))(function(y,p){function S(k){try{w(d.next(k))}catch(A){p(A)}}function U(k){try{w(d.throw(k))}catch(A){p(A)}}function w(k){k.done?y(k.value):l(k.value).then(S,U)}w((d=d.apply(e,[])).next())})}function De(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ne,pe;function je(){return pe||(pe=1,ne=function e(n,i){if(n===i)return!0;if(n&&i&&typeof n=="object"&&typeof i=="object"){if(n.constructor!==i.constructor)return!1;var d,l,y;if(Array.isArray(n)){if(d=n.length,d!=i.length)return!1;for(l=d;l--!==0;)if(!e(n[l],i[l]))return!1;return!0}if(n.constructor===RegExp)return n.source===i.source&&n.flags===i.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===i.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===i.toString();if(y=Object.keys(n),d=y.length,d!==Object.keys(i).length)return!1;for(l=d;l--!==0;)if(!Object.prototype.hasOwnProperty.call(i,y[l]))return!1;for(l=d;l--!==0;){var p=y[l];if(!e(n[p],i[p]))return!1}return!0}return n!==n&&i!==i}),ne}var Oe=je(),Ne=De(Oe);const fe="__googleMapsScriptId";var G;(function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.LOADING=1]="LOADING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILURE=3]="FAILURE"})(G||(G={}));class T{constructor({apiKey:n,authReferrerPolicy:i,channel:d,client:l,id:y=fe,language:p,libraries:S=[],mapIds:U,nonce:w,region:k,retries:A=3,url:I="https://maps.googleapis.com/maps/api/js",version:m}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=n,this.authReferrerPolicy=i,this.channel=d,this.client=l,this.id=y||fe,this.language=p,this.libraries=S,this.mapIds=U,this.nonce=w,this.region=k,this.retries=A,this.url=I,this.version=m,T.instance){if(!Ne(this.options,T.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(T.instance.options)}`);return T.instance}T.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?G.FAILURE:this.done?G.SUCCESS:this.loading?G.LOADING:G.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let n=this.url;return n+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(n+=`&key=${this.apiKey}`),this.channel&&(n+=`&channel=${this.channel}`),this.client&&(n+=`&client=${this.client}`),this.libraries.length>0&&(n+=`&libraries=${this.libraries.join(",")}`),this.language&&(n+=`&language=${this.language}`),this.region&&(n+=`&region=${this.region}`),this.version&&(n+=`&v=${this.version}`),this.mapIds&&(n+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(n+=`&auth_referrer_policy=${this.authReferrerPolicy}`),n}deleteScript(){const n=document.getElementById(this.id);n&&n.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((n,i)=>{this.loadCallback(d=>{d?i(d.error):n(window.google)})})}importLibrary(n){return this.execute(),google.maps.importLibrary(n)}loadCallback(n){this.callbacks.push(n),this.execute()}setScript(){var n,i;if(document.getElementById(this.id)){this.callback();return}const d={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(d).forEach(y=>!d[y]&&delete d[y]),!((i=(n=window==null?void 0:window.google)===null||n===void 0?void 0:n.maps)===null||i===void 0)&&i.importLibrary||(y=>{let p,S,U,w="The Google Maps JavaScript API",k="google",A="importLibrary",I="__ib__",m=document,f=window;f=f[k]||(f[k]={});const E=f.maps||(f.maps={}),h=new Set,o=new URLSearchParams,N=()=>p||(p=new Promise((u,c)=>Le(this,void 0,void 0,function*(){var x;yield S=m.createElement("script"),S.id=this.id,o.set("libraries",[...h]+"");for(U in y)o.set(U.replace(/[A-Z]/g,_=>"_"+_[0].toLowerCase()),y[U]);o.set("callback",k+".maps."+I),S.src=this.url+"?"+o,E[I]=u,S.onerror=()=>p=c(Error(w+" could not load.")),S.nonce=this.nonce||((x=m.querySelector("script[nonce]"))===null||x===void 0?void 0:x.nonce)||"",m.head.append(S)})));E[A]?console.warn(w+" only loads once. Ignoring:",y):E[A]=(u,...c)=>h.add(u)&&N().then(()=>E[A](u,...c))})(d);const l=this.libraries.map(y=>this.importLibrary(y));l.length||l.push(this.importLibrary("core")),Promise.all(l).then(()=>this.callback(),y=>{const p=new ErrorEvent("error",{error:y});this.loadErrorCallback(p)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(n){if(this.errors.push(n),this.errors.length<=this.retries){const i=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${i} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},i)}else this.onerrorEvent=n,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(n=>{n(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}const Re={class:"space-y-2"},Fe={key:0,class:"block text-xs text-gray-500"},Ve={class:"flex gap-2"},Me=["placeholder"],Te={class:"text-xs text-gray-600"},Ke={class:"font-mono"},Ge={class:"font-mono"},ze={class:"font-mono break-all"},Be={__name:"MapPicker",props:{label:{type:String,default:"Select location"},searchPlaceholder:{type:String,default:"Search placeâ€¦"},lat:{type:[Number,String],default:null},lng:{type:[Number,String],default:null},address:{type:String,default:""},fallbackCenter:{type:Object,default:()=>({lat:30.0444,lng:31.2357})},zoom:{type:Number,default:13},apiKey:{type:String,default:"AIzaSyD6l04ETuUP7BfQ7MqpL2vMWEalLxNj0d4"}},emits:["update:lat","update:lng","update:address"],setup(e,{emit:n}){const i=e,d=n,l=u=>{if(typeof u=="number")return Number.isFinite(u)?u:null;if(u===""||u==null)return null;const c=Number(u);return Number.isFinite(c)?c:null},y=ie(()=>{const u=l(i.lat);return u==null?"-":u.toFixed(6)}),p=ie(()=>{const u=l(i.lng);return u==null?"-":u.toFixed(6)}),S=P(null),U=P(null);let w,k,A,I,m=null;function f({lat:u,lng:c,address:x}){u!=null&&d("update:lat",u),c!=null&&d("update:lng",c),x!==void 0&&d("update:address",x)}function E(u,c){return new Promise(x=>{if(!I)return x("");I.geocode({location:{lat:u,lng:c}},(_,j)=>{j==="OK"&&_&&_.length?x(_[0].formatted_address||""):x("")})})}async function h(){try{m=await new T({apiKey:i.apiKey,version:"weekly",libraries:["places"]}).load()}catch(_){console.error("Google Maps failed to load:",_);return}I=new m.maps.Geocoder;const u=l(i.lat),c=l(i.lng),x=u!=null&&c!=null?{lat:u,lng:c}:i.fallbackCenter;w=new m.maps.Map(S.value,{center:x,zoom:i.zoom,mapTypeControl:!1,streetViewControl:!1}),k=new m.maps.Marker({position:x,map:w,draggable:!0}),w.addListener("click",_=>{const j=_.latLng;o(j.lat(),j.lng(),!0)}),k.addListener("dragend",()=>{const _=k.getPosition();o(_.lat(),_.lng(),!0)});try{A=new m.maps.places.Autocomplete(U.value,{fields:["geometry","formatted_address","name"]}),A.addListener("place_changed",()=>{var H;const _=A.getPlace();if(!((H=_==null?void 0:_.geometry)!=null&&H.location))return;const j=_.geometry.location;w.panTo(j),w.setZoom(15);const Y=_.formatted_address||_.name||"";o(j.lat(),j.lng(),!1,Y)})}catch{}if(u!=null&&c!=null&&!i.address){const _=await E(u,c);f({address:_||""})}}async function o(u,c,x=!0,_=""){if(!(!k||!w)){if(k.setPosition({lat:u,lng:c}),w.panTo({lat:u,lng:c}),f({lat:u,lng:c}),_)f({address:_});else if(x){const j=await E(u,c);f({address:j||""})}}}le(()=>[i.lat,i.lng],([u,c])=>{if(!w)return;const x=l(u),_=l(c);x==null||_==null||(k.setPosition({lat:x,lng:_}),w.panTo({lat:x,lng:_}))});function N(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(u=>{const{latitude:c,longitude:x}=u.coords;o(c,x,!0),w&&w.setZoom(15)},()=>{},{enableHighAccuracy:!0,timeout:8e3})}return oe(async()=>{await X(),await h()}),(u,c)=>(v(),g("div",Re,[e.label?(v(),g("label",Fe,b(e.label),1)):C("",!0),r("div",Ve,[r("input",{ref_key:"searchEl",ref:U,type:"text",class:"form-input flex-1",placeholder:e.searchPlaceholder},null,8,Me),r("button",{type:"button",class:"px-3 py-2 border rounded",onClick:N},"ðŸ“")]),r("div",{ref_key:"mapEl",ref:S,class:"rounded border",style:{height:"320px"}},null,512),r("div",Te,[r("div",null,[c[0]||(c[0]=$("Lat: ")),r("span",Ke,b(y.value),1)]),r("div",null,[c[1]||(c[1]=$("Lng: ")),r("span",Ge,b(p.value),1)]),r("div",null,[c[2]||(c[2]=$("Address: ")),r("span",ze,b(e.address||"â€”"),1)])])]))}},Ze=ye(Be,[["__scopeId","data-v-b4fff5e4"]]);function Je(e){try{return typeof e=="string"?JSON.parse(e):e}catch{return e}}function me(e){const n=Je(e);return n&&typeof n=="object"?{en:n.en??"",ar:n.ar??""}:{en:n??"",ar:n??""}}function re(e){var n;return Array.isArray(e)?e:Array.isArray(e==null?void 0:e.data)?e.data:Array.isArray(e==null?void 0:e.message)?e.message:Array.isArray((n=e==null?void 0:e.data)==null?void 0:n.data)?e.data.data:[]}function He(e){return(e==null?void 0:e.data)??(e==null?void 0:e.message)??e}function ae(e){return e?`/storage/${e}`:""}function ge(e){return e?String(e).slice(0,10):""}function W(e={}){const n=me(e.name),i=me(e.description),d=Array.isArray(e.home_unit_gallery)?e.home_unit_gallery.map(l=>({id:l.id??void 0,image:l.image,image_url:ae(l.image)})):Array.isArray(e.gallery)?e.gallery.map(l=>({id:l.id??void 0,image:l.image,image_url:ae(l.image)})):[];return{...e,name_en:n.en,name_ar:n.ar,description_en:i.en,description_ar:i.ar,location:e.location??"",lat:e.lat??null,long:e.long??null,start_date:ge(e.start_date),end_date:ge(e.end_date),status:e.status??"",user_id:e.user_id??null,vendor_id:e.vendor_id??null,cover_image_url:ae(e.cover_image),gallery:d}}const J={list:async(e={})=>{const{data:n}=await D.get("/api/units",{params:e});return re(n).map(W)},listByUser:async(e,n={})=>{const{data:i}=await D.get(`/api/units/user/${e}`,{params:n});return re(i).map(W)},listByVendor:async(e,n={})=>{const{data:i}=await D.get(`/api/units/vendor/${e}`,{params:n});return re(i).map(W)},show:async e=>{const{data:n}=await D.get(`/api/units/show/${e}`);return W(He(n))},create:async e=>{const{data:n}=await D.post("/api/units/create",e,{headers:{"Content-Type":"multipart/form-data"}});return n},update:async(e,n)=>{const{data:i}=await D.post(`/api/units/update/${e}`,n,{headers:{"Content-Type":"multipart/form-data"}});return i},remove:async e=>{const{data:n}=await D.delete(`/api/units/delete/${e}`);return n}};function Qe({name:e={en:"",ar:""},description:n={en:"",ar:""},location:i,lat:d,long:l,start_date:y,end_date:p,cover_image:S,gallery:U=[],user_id:w,vendor_id:k,status:A,...I}){const m=new FormData;return m.append("name[en]",e.en??""),m.append("name[ar]",e.ar??""),m.append("description[en]",n.en??""),m.append("description[ar]",n.ar??""),m.append("location",i??""),m.append("lat",String(d??"")),m.append("long",String(l??"")),m.append("start_date",y??""),m.append("end_date",p??""),S&&m.append("cover_image",S),(U||[]).forEach(f=>f&&m.append("gallery[]",f)),m.append("user_id",String(w??"")),m.append("vendor_id",String(k??"")),A&&m.append("status",A),Object.entries(I).forEach(([f,E])=>{E!=null&&E!==""&&m.append(f,E)}),m}function We(e={}){const{name:n,description:i,location:d,lat:l,long:y,start_date:p,end_date:S,cover_image:U,gallery:w,user_id:k,vendor_id:A,status:I,...m}=e,f=new FormData;return n&&(n.en!==void 0&&f.append("name[en]",n.en??""),n.ar!==void 0&&f.append("name[ar]",n.ar??"")),i&&(i.en!==void 0&&f.append("description[en]",i.en??""),i.ar!==void 0&&f.append("description[ar]",i.ar??"")),d!==void 0&&f.append("location",d??""),l!==void 0&&f.append("lat",String(l??"")),y!==void 0&&f.append("long",String(y??"")),p!==void 0&&f.append("start_date",p??""),S!==void 0&&f.append("end_date",S??""),U&&f.append("cover_image",U),Array.isArray(w)&&w.length&&w.forEach(E=>E&&f.append("gallery[]",E)),k!==void 0&&f.append("user_id",String(k??"")),A!==void 0&&f.append("vendor_id",String(A??"")),I!==void 0&&I!==""&&f.append("status",I),Object.entries(m).forEach(([E,h])=>{h!=null&&h!==""&&f.append(E,h)}),f}function Xe(e){return e===!0||e===1||e==="1"}function se(e={}){const n=e.profile_image||e.profileImage||null;return{id:e.id,name:e.name||"",email:e.email||"",phone:e.phone||"",gender:e.gender||"",country_code:e.country_code||"",country_name:e.country_name||"",role:e.role||"user",is_enabled:Xe(e.is_enabled),profile_image:n,profile_image_url:n?`/storage/${n}`:null,created_at:e.created_at,updated_at:e.updated_at}}function Ye(e){return Array.isArray(e)?e:Array.isArray(e==null?void 0:e.data)?e.data:Array.isArray(e==null?void 0:e.message)?e.message:[]}function ve(e){return(e==null?void 0:e.data)??e}const et={list:async()=>{const{data:e}=await D.get("/api/users");return Ye(e).map(se)},show:async e=>{const{data:n}=await D.get(`/api/users/show/${e}`);return se(ve(n))},edit:async e=>{const{data:n}=await D.get(`/api/users/edit/${e}`);return se(ve(n))},create:async e=>{const{data:n}=await D.post("/api/users/create",e,{headers:{"Content-Type":"multipart/form-data"}});return n},update:async(e,n)=>{const i=typeof FormData<"u"&&n instanceof FormData,{data:d}=await D.post(`/api/users/update/${e}`,n,{headers:i?{"Content-Type":"multipart/form-data"}:void 0});return d},remove:async e=>{const{data:n}=await D.delete(`/api/users/delete/${e}`);return n}},tt={class:"p-6 space-y-6"},nt={class:"bg-white shadow rounded-lg p-4"},rt={key:0,class:"text-sm text-gray-500"},at={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},st={class:"aspect-[4/3] bg-white flex items-center justify-center"},it=["src"],lt={key:1,class:"text-gray-400 text-sm"},ot={class:"p-3 space-y-2"},dt={class:"font-semibold truncate"},ut={key:0,class:"text-gray-400"},ct={class:"text-xs text-gray-500"},pt={class:"text-xs text-gray-500"},ft={class:"text-xs text-gray-500"},mt={class:"grid grid-cols-3 gap-2 pt-2 text-xs"},gt={class:"flex gap-2 pt-2"},vt=["onClick"],yt=["onClick"],ht={key:0,class:"col-span-full text-center text-gray-500 py-8"},_t={class:"relative mx-auto w-full max-w-3xl p-4 sm:p-6 h-full flex items-center justify-center"},bt={class:"bg-white rounded-2xl shadow-lg w-full max-h-[min(88vh,900px)] overflow-y-auto focus:outline-none",role:"dialog","aria-modal":"true"},xt={class:"sticky top-0 z-10 bg-white border-b rounded-t-2xl"},wt={class:"flex items-center justify-between px-5 py-3"},kt={class:"text-lg font-bold"},Et={class:"px-5 py-4 space-y-4"},St={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},At=["required"],qt={key:0,class:"mt-1 text-xs text-red-600"},Ct=["required"],Ut={key:0,class:"mt-1 text-xs text-red-600"},It={class:"md:col-span-2"},Pt=["required"],$t={key:0,class:"mt-1 text-xs text-red-600"},Lt={class:"md:col-span-2"},Dt=["required"],jt={key:0,class:"mt-1 text-xs text-red-600"},Ot={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Nt=["required"],Rt={key:0,class:"mt-1 text-xs text-red-600"},Ft=["required"],Vt={key:0,class:"mt-1 text-xs text-red-600"},Mt=["required"],Tt={key:0,class:"mt-1 text-xs text-red-600"},Kt={class:"md:col-span-2"},Gt=["required"],zt={key:0,class:"mt-1 text-xs text-red-600"},Bt=["required"],Zt={key:0,class:"mt-1 text-xs text-red-600"},Jt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ht=["required"],Qt=["value"],Wt={key:0,class:"mt-1 text-xs text-red-600"},Xt=["required"],Yt=["value"],en={key:0,class:"mt-1 text-xs text-red-600"},tn={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},nn={class:"block text-xs text-gray-500 mb-1"},rn=["required"],an={key:0,class:"mt-1 text-xs text-red-600"},sn={key:1,class:"mt-2"},ln=["src"],on=["required"],dn={key:0,class:"mt-1 text-xs text-red-600"},un={key:1,class:"mt-2 flex flex-wrap gap-2"},cn=["src"],pn={key:0,class:"rounded border border-red-200 bg-red-50 text-red-700 px-3 py-2"},fn={class:"sticky bottom-0 z-10 bg-white border-t rounded-b-2xl"},mn={class:"px-5 py-3 flex items-center gap-3"},gn=["disabled"],vn={__name:"Index",setup(e){const n=ie(()=>!h.value),i=P({}),d=(a,t)=>{if(!t||Array.isArray(t)&&t.length===0){delete i.value[a];return}i.value[a]=Array.isArray(t)?t:[String(t)]},l=a=>{var t;return((t=i.value[a])==null?void 0:t[0])||""},y=a=>!!i.value[a],p=a=>["form-input",y(a)?"border-red-400 focus:ring-red-500":""];function S(){const a=document.querySelector(".max-h-\\[min\\(88vh\\,900px\\)\\]"),t=a==null?void 0:a.querySelector("input.border-red-400, select.border-red-400, textarea.border-red-400");t&&t.scrollIntoView({behavior:"smooth",block:"center"})}function U(){i.value={},x.value="";const a=o.value,t=s=>s!=null&&String(s).trim()!=="";return n.value?(t(a.name.en)||d("name.en","Name (EN) is required"),t(a.name.ar)||d("name.ar","Name (AR) is required"),t(a.description.en)||d("description.en","Description (EN) is required"),t(a.description.ar)||d("description.ar","Description (AR) is required"),t(a.location)||d("location","Location is required"),typeof a.lat=="number"&&a.lat>=-90&&a.lat<=90||d("lat","Latitude must be between -90 and 90"),typeof a.long=="number"&&a.long>=-180&&a.long<=180||d("long","Longitude must be between -180 and 180"),t(a.start_date)||d("start_date","Start date is required"),t(a.end_date)||d("end_date","End date is required"),t(a.start_date)&&t(a.end_date)&&new Date(a.end_date)<new Date(a.start_date)&&d("end_date","End date must be after or equal to start date"),t(a.user_id)||d("user_id","User is required"),t(a.vendor_id)||d("vendor_id","Vendor is required"),a.cover_image||d("cover_image","Cover image is required"),(!Array.isArray(a.gallery)||a.gallery.length===0)&&d("gallery","Add at least one gallery image")):(a.lat!==null&&(a.lat<-90||a.lat>90)&&d("lat","Latitude must be between -90 and 90"),a.long!==null&&(a.long<-180||a.long>180)&&d("long","Longitude must be between -180 and 180"),t(a.start_date)&&t(a.end_date)&&new Date(a.end_date)<new Date(a.start_date)&&d("end_date","End date must be after or equal to start date")),Object.keys(i.value).length?(x.value="Please fix the highlighted fields.",!1):!0}function w(a){var s,q,ee,ce;const t=(q=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:q.errors;if(!t)return!1;i.value={};for(const[Ae,qe]of Object.entries(t))d(Ae,qe);return x.value=((ce=(ee=a==null?void 0:a.response)==null?void 0:ee.data)==null?void 0:ce.message)||"Validation failed. Please review the fields below.",!0}const k=P([]),A=P([]);async function I(){const a=await et.list();k.value=a.map(s=>({id:s.id,name:s.name,email:s.email}));const t=await $e.list();A.value=t.map(s=>({id:s.id,name:s.name,email:s.email}))}oe(async()=>{await Promise.all([B(),I()])});const m=P([]),f=P(!1),E=P(!1),h=P(null),o=P({name:{en:"",ar:""},description:{en:"",ar:""},location:"",lat:null,long:null,start_date:"",end_date:"",user_id:null,vendor_id:null,status:"",cover_image:null,gallery:[]}),N=P(null),u=P([]),c=P(!1),x=P(""),_=P({});function j(a){return`/units-management/${a}/docs`}function Y(a){return`/units-management/${a}/drawing`}function H(a){return`/units-management/${a}/gallery`}function he(a){return`/units-management/${a}/timeline`}function _e(a){return`/units-management/${a}/reports`}function be(a){return`/units-management/${a}/phases`}function de(){o.value={name:{en:"",ar:""},description:{en:"",ar:""},location:"",lat:null,long:null,start_date:"",end_date:"",user_id:null,vendor_id:null,status:"",cover_image:null,gallery:[]},N.value=null,u.value=[],x.value="",_.value={},h.value=null}function xe(){de(),E.value=!0}async function we(a){de(),h.value=a.id;const t=await J.show(a.id);o.value.name.en=t.name_en||"",o.value.name.ar=t.name_ar||"",o.value.description.en=t.description_en||"",o.value.description.ar=t.description_ar||"",o.value.location=t.location||"",o.value.lat=t.lat,o.value.long=t.long,o.value.start_date=t.start_date||"",o.value.end_date=t.end_date||"",o.value.user_id=t.user_id??null,o.value.vendor_id=t.vendor_id??null,o.value.status=t.status||"",N.value=t.cover_image_url||null,E.value=!0}le(()=>E.value,async a=>{a&&await X()}),le(()=>E.value,a=>{document.body.style.overflow=a?"hidden":""});function z(){E.value=!1}function ke(a){var s;const t=((s=a.target.files)==null?void 0:s[0])||null;o.value.cover_image=t,N.value=t?URL.createObjectURL(t):N.value}function Ee(a){const t=Array.from(a.target.files||[]);o.value.gallery=t,u.value=t.map(s=>URL.createObjectURL(s))}async function B(){f.value=!0;try{m.value=await J.list()}finally{f.value=!1}}async function ue(){var a,t,s;c.value=!0;try{if(!U()){await X(),S();return}if(h.value){const q=We(o.value);await J.update(h.value,q)}else{const q=Qe(o.value);await J.create(q)}await B(),z()}catch(q){((a=q==null?void 0:q.response)==null?void 0:a.status)===422&&w(q)?(await X(),S()):x.value=((s=(t=q==null?void 0:q.response)==null?void 0:t.data)==null?void 0:s.message)||(q==null?void 0:q.message)||"Request failed"}finally{c.value=!1}}async function Se(a){confirm(`Delete unit #${a.id}?`)&&(await J.remove(a.id),await B())}return oe(B),(a,t)=>(v(),g(Z,null,[R(V(Ce),{title:"Units"}),R(Pe,null,{default:M(()=>[r("div",tt,[r("div",{class:"flex items-center justify-between"},[t[15]||(t[15]=r("h2",{class:"text-2xl font-bold text-gray-800"},"Units",-1)),r("button",{onClick:xe,class:"inline-flex items-center rounded-md bg-gray-800 px-4 py-2 text-xs font-semibold uppercase tracking-widest text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"}," + Add Unit ")]),r("div",nt,[r("div",{class:"flex items-center justify-between mb-3"},[t[16]||(t[16]=r("h3",{class:"text-lg font-bold"},"All Units",-1)),r("button",{onClick:B,class:"px-3 py-1 border rounded"},"Refresh")]),f.value?(v(),g("div",rt,"Loadingâ€¦")):(v(),g("div",at,[(v(!0),g(Z,null,Q(m.value,s=>(v(),g("div",{key:s.id,class:"rounded border overflow-hidden bg-gray-50"},[r("div",st,[s.cover_image_url?(v(),g("img",{key:0,src:s.cover_image_url,class:"w-full h-full object-cover"},null,8,it)):(v(),g("div",lt,"No Cover"))]),r("div",ot,[r("div",dt,[$(b(s.name_en||"â€”")+" ",1),s.name_ar?(v(),g("span",ut,"/")):C("",!0),$(" "+b(s.name_ar),1)]),r("div",ct,[t[17]||(t[17]=r("span",{class:"font-medium"},"Location:",-1)),$(" "+b(s.location||"â€”"),1)]),r("div",pt,[t[18]||(t[18]=r("span",{class:"font-medium"},"Period:",-1)),$(" "+b(s.start_date||"â€”")+" â†’ "+b(s.end_date||"â€”"),1)]),r("div",ft,[t[19]||(t[19]=r("span",{class:"font-medium"},"Status:",-1)),$(" "+b(s.status||"â€”"),1)]),r("div",mt,[R(V(K),{href:j(s.id),class:"px-2 py-1 border rounded text-center hover:bg-gray-100"},{default:M(()=>t[20]||(t[20]=[$(" Docs ")])),_:2},1032,["href"]),R(V(K),{href:H(s.id),class:"px-2 py-1 border rounded text-center hover:bg-gray-100"},{default:M(()=>t[21]||(t[21]=[$(" Gallery ")])),_:2},1032,["href"]),R(V(K),{href:Y(s.id),class:"px-2 py-1 border rounded text-center hover:bg-gray-100"},{default:M(()=>t[22]||(t[22]=[$(" Drawing ")])),_:2},1032,["href"]),R(V(K),{href:_e(s.id),class:"px-2 py-1 border rounded text-center hover:bg-gray-100"},{default:M(()=>t[23]||(t[23]=[$(" Reports ")])),_:2},1032,["href"]),R(V(K),{href:be(s.id),class:"px-2 py-1 border rounded text-center hover:bg-gray-100"},{default:M(()=>t[24]||(t[24]=[$(" Phases ")])),_:2},1032,["href"]),R(V(K),{href:he(s.id),class:"px-2 py-1 border rounded text-center hover:bg-gray-100"},{default:M(()=>t[25]||(t[25]=[$(" TimeLine ")])),_:2},1032,["href"])]),r("div",gt,[r("button",{class:"px-3 py-1 border rounded text-sm",onClick:q=>we(s)},"Edit",8,vt),r("button",{class:"px-3 py-1 border rounded text-sm text-red-600",onClick:q=>Se(s)},"Delete",8,yt)])])]))),128)),m.value.length?C("",!0):(v(),g("div",ht," No units found. "))]))]),E.value?(v(),g("div",{key:0,class:"fixed inset-0 z-50",onKeydown:Ue(z,["esc"])},[r("div",{class:"absolute inset-0 bg-black/40",onClick:z,"aria-hidden":"true"}),r("div",_t,[r("div",bt,[r("div",xt,[r("div",wt,[r("h3",kt,b(h.value?"Edit Unit":"Add Unit"),1),r("button",{onClick:z,class:"text-gray-400 hover:text-gray-600","aria-label":"Close"}," âœ• ")])]),r("div",Et,[r("form",{onSubmit:Ie(ue,["prevent"]),class:"space-y-4"},[r("div",St,[r("div",null,[t[26]||(t[26]=r("label",{class:"block text-xs text-gray-500 mb-1"},"Name (EN)*",-1)),O(r("input",{class:L(p("name.en")),"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.name.en=s),type:"text",required:!h.value},null,10,At),[[F,o.value.name.en]]),l("name.en")?(v(),g("p",qt,b(l("name.en")),1)):C("",!0)]),r("div",null,[t[27]||(t[27]=r("label",{class:"block text-xs text-gray-500 mb-1"},"Name (AR)*",-1)),O(r("input",{class:L(p("name.ar")),"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.name.ar=s),type:"text",required:!h.value},null,10,Ct),[[F,o.value.name.ar]]),l("name.ar")?(v(),g("p",Ut,b(l("name.ar")),1)):C("",!0)]),r("div",It,[t[28]||(t[28]=r("label",{class:"block text-xs text-gray-500 mb-1"},"Description (EN)*",-1)),O(r("input",{class:L(p("description.en")),"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.description.en=s),type:"text",required:!h.value},null,10,Pt),[[F,o.value.description.en]]),l("description.en")?(v(),g("p",$t,b(l("description.en")),1)):C("",!0)]),r("div",Lt,[t[29]||(t[29]=r("label",{class:"block text-xs text-gray-500 mb-1"},"Description (AR)*",-1)),O(r("input",{class:L(p("description.ar")),"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.description.ar=s),type:"text",required:!h.value},null,10,Dt),[[F,o.value.description.ar]]),l("description.ar")?(v(),g("p",jt,b(l("description.ar")),1)):C("",!0)])]),r("div",Ot,[r("div",null,[t[30]||(t[30]=r("label",{class:"block text-xs text-gray-500 mb-1"},"Location*",-1)),O(r("input",{class:L(p("location")),"onUpdate:modelValue":t[4]||(t[4]=s=>o.value.location=s),type:"text",required:!h.value},null,10,Nt),[[F,o.value.location]]),l("location")?(v(),g("p",Rt,b(l("location")),1)):C("",!0)]),r("div",null,[t[31]||(t[31]=r("label",{class:"block text-xs text-gray-500 mb-1"},"Latitude (-90..90)*",-1)),O(r("input",{class:L(p("lat")),"onUpdate:modelValue":t[5]||(t[5]=s=>o.value.lat=s),type:"number",step:"any",min:"-90",max:"90",required:!h.value},null,10,Ft),[[F,o.value.lat,void 0,{number:!0}]]),l("lat")?(v(),g("p",Vt,b(l("lat")),1)):C("",!0)]),r("div",null,[t[32]||(t[32]=r("label",{class:"block text-xs text-gray-500 mb-1"},"Longitude (-180..180)*",-1)),O(r("input",{class:L(p("long")),"onUpdate:modelValue":t[6]||(t[6]=s=>o.value.long=s),type:"number",step:"any",min:"-180",max:"180",required:!h.value},null,10,Mt),[[F,o.value.long,void 0,{number:!0}]]),l("long")?(v(),g("p",Tt,b(l("long")),1)):C("",!0)]),r("div",Kt,[R(Ze,{label:"Pick on map",lat:o.value.lat,"onUpdate:lat":t[7]||(t[7]=s=>o.value.lat=s),lng:o.value.long,"onUpdate:lng":t[8]||(t[8]=s=>o.value.long=s),address:o.value.location,"onUpdate:address":t[9]||(t[9]=s=>o.value.location=s)},null,8,["lat","lng","address"])]),r("div",null,[t[33]||(t[33]=r("label",{class:"block text-xs text-gray-500 mb-1"},"Start Date*",-1)),O(r("input",{class:L(p("start_date")),"onUpdate:modelValue":t[10]||(t[10]=s=>o.value.start_date=s),type:"date",required:!h.value},null,10,Gt),[[F,o.value.start_date]]),l("start_date")?(v(),g("p",zt,b(l("start_date")),1)):C("",!0)]),r("div",null,[t[34]||(t[34]=r("label",{class:"block text-xs text-gray-500 mb-1"},"End Date* (>= start)",-1)),O(r("input",{class:L(p("end_date")),"onUpdate:modelValue":t[11]||(t[11]=s=>o.value.end_date=s),type:"date",required:!h.value},null,10,Bt),[[F,o.value.end_date]]),l("end_date")?(v(),g("p",Zt,b(l("end_date")),1)):C("",!0)])]),r("div",Jt,[r("div",null,[t[36]||(t[36]=r("label",{class:"block text-xs text-gray-500 mb-1"},"User *",-1)),O(r("select",{class:L(p("user_id")),"onUpdate:modelValue":t[12]||(t[12]=s=>o.value.user_id=s),required:!h.value},[t[35]||(t[35]=r("option",{value:"",disabled:""},"Select a user",-1)),(v(!0),g(Z,null,Q(k.value,s=>(v(),g("option",{key:s.id,value:s.id},b(s.name)+" â€” "+b(s.email),9,Qt))),128))],10,Ht),[[te,o.value.user_id,void 0,{number:!0}]]),l("user_id")?(v(),g("p",Wt,b(l("user_id")),1)):C("",!0)]),r("div",null,[t[38]||(t[38]=r("label",{class:"block text-xs text-gray-500 mb-1"},"Vendor *",-1)),O(r("select",{class:L(p("vendor_id")),"onUpdate:modelValue":t[13]||(t[13]=s=>o.value.vendor_id=s),required:!h.value},[t[37]||(t[37]=r("option",{value:"",disabled:""},"Select a vendor",-1)),(v(!0),g(Z,null,Q(A.value,s=>(v(),g("option",{key:s.id,value:s.id},b(s.name)+" â€” "+b(s.email),9,Yt))),128))],10,Xt),[[te,o.value.vendor_id,void 0,{number:!0}]]),l("vendor_id")?(v(),g("p",en,b(l("vendor_id")),1)):C("",!0)]),r("div",null,[t[40]||(t[40]=r("label",{class:"block text-xs text-gray-500 mb-1"},"Status",-1)),O(r("select",{class:"form-input","onUpdate:modelValue":t[14]||(t[14]=s=>o.value.status=s)},t[39]||(t[39]=[r("option",{value:""},"(none)",-1),r("option",{value:"under_construction"},"under_construction",-1),r("option",{value:"completed"},"completed",-1)]),512),[[te,o.value.status]])])]),r("div",tn,[r("div",null,[r("label",nn," Cover Image* "+b(h.value?"(optional to replace)":""),1),r("input",{class:L(p("cover_image")),type:"file",accept:"image/*",onChange:ke,required:!h.value},null,42,rn),l("cover_image")?(v(),g("p",an,b(l("cover_image")),1)):C("",!0),N.value?(v(),g("div",sn,[r("img",{src:N.value,class:"w-40 h-28 object-cover rounded border"},null,8,ln)])):C("",!0)]),r("div",null,[t[41]||(t[41]=r("label",{class:"block text-xs text-gray-500 mb-1"},"Gallery* (multiple on create)",-1)),r("input",{class:L(p("gallery")),type:"file",accept:"image/*",multiple:"",onChange:Ee,required:!h.value},null,42,on),l("gallery")?(v(),g("p",dn,b(l("gallery")),1)):C("",!0),u.value.length?(v(),g("div",un,[(v(!0),g(Z,null,Q(u.value,(s,q)=>(v(),g("img",{key:q,src:s,class:"w-24 h-16 object-cover rounded border"},null,8,cn))),128))])):C("",!0)])]),x.value?(v(),g("div",pn,b(x.value),1)):C("",!0)],32)]),r("div",fn,[r("div",mn,[r("button",{disabled:c.value,class:"px-4 py-2 bg-indigo-600 text-white rounded disabled:opacity-60",onClick:ue},b(c.value?"Savingâ€¦":h.value?"Update":"Create"),9,gn),r("button",{type:"button",class:"px-3 py-2 border rounded",onClick:z},"Cancel")])])])])],32)):C("",!0)])]),_:1})],64))}},xn=ye(vn,[["__scopeId","data-v-dba5f8aa"]]);export{xn as default};
