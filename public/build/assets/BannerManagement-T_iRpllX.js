import{m as u,p as c,r as k,q as S,f as l,o,a as C,u as j,g as I,w as M,b as n,h as B,j as V,v as T,t as f,F as A,s as z,n as G}from"./app-Bo-3Qt58.js";import{_ as O}from"./AuthenticatedLayout-CgEzs-iN.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";function w(e={}){return{...e,image_url:e.image?`/storage/${e.image}`:"",is_enabled:Number(e.is_enabled)===1||e.is_enabled===!0}}function D(e){var a;return Array.isArray(e)?e:Array.isArray(e==null?void 0:e.message)?e.message:Array.isArray(e==null?void 0:e.data)?e.data:Array.isArray((a=e==null?void 0:e.data)==null?void 0:a.data)?e.data.data:[]}function P(e){return(e==null?void 0:e.data)??(e==null?void 0:e.message)??e}const m={index:async(e={})=>{const{data:a}=await u.get("/api/banners",{params:e});return D(a).map(w)},edit:async e=>{const{data:a}=await u.get(`/api/banners/edit/${e}`);return w(P(a))},create:async e=>{const{data:a}=await u.post("/api/banners/create",e,{headers:{"Content-Type":"multipart/form-data"}});return a},update:async(e,a)=>{const{data:i}=await u.post(`/api/banners/update/${e}`,a,{headers:{"Content-Type":"multipart/form-data"}});return i},destroy:async e=>{const{data:a}=await u.delete(`/api/banners/delete/${e}`);return a},publicGet:async()=>{const{data:e}=await u.get("/api/user/get-banner");return D(e).map(w)}};function H({image:e,is_enabled:a=!0}){const i=new FormData;return e&&i.append("image",e),i.append("is_enabled",(a?1:0).toString()),i}function F({image:e=null,is_enabled:a=null}){const i=new FormData;return e&&i.append("image",e),a!==null&&i.append("is_enabled",(a?1:0).toString()),i}const J={class:"p-6 space-y-6"},K={class:"bg-white p-4 rounded shadow"},Q={class:"grid md:grid-cols-[1fr_auto_auto] items-end gap-4"},W={key:0,class:"mt-2"},X=["src"],Y={class:"flex items-center gap-2"},Z=["disabled"],ee={key:0,class:"text-sm text-red-600 mt-2"},te={class:"bg-white p-5 rounded-2xl shadow-sm ring-1 ring-black/[0.05]"},ne={key:0,class:"text-sm text-gray-500"},se={key:1},ae={key:0},re={class:"min-w-full border-collapse"},ie={class:"px-4 py-3 text-sm text-gray-600 align-middle"},le={class:"px-4 py-3 align-middle"},oe=["src"],de={key:1,class:"text-xs text-gray-400 italic"},ce={class:"px-4 py-3 align-middle"},ue={class:"flex items-center gap-2 text-sm"},ge=["checked","onChange"],pe={class:"px-4 py-3 align-middle text-sm"},fe=["onChange"],me=["onClick","disabled"],_e={class:"px-4 py-3 text-center align-middle"},be=["onClick"],xe={key:1,class:"text-center text-gray-500 py-8"},ve={__name:"BannerManagement",setup(e){const a=c([]),i=c(!1),g=c(null),_=c(null),b=c(!0),x=c(!1),v=c("");function $(r){var t;const s=((t=r.target.files)==null?void 0:t[0])||null;g.value=s,_.value=s?URL.createObjectURL(s):null}async function N(){var r,s;if(g.value){x.value=!0,v.value="";try{const t=H({image:g.value,is_enabled:b.value});await m.create(t),await p(),g.value=null,_.value=null,b.value=!0}catch(t){v.value=((s=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:s.message)||(t==null?void 0:t.message)||"Upload failed"}finally{x.value=!1}}}async function p(){try{i.value=!0,a.value=await m.index()}finally{i.value=!1}}async function R(r){const s=r.is_enabled;r.is_enabled=!s;try{const t=F({is_enabled:r.is_enabled});await m.update(r.id,t)}catch(t){r.is_enabled=s,console.error("Toggle failed:",t)}}const h=k({}),y=k({});function U(r,s){var d;const t=((d=s.target.files)==null?void 0:d[0])||null;t&&(h[r]=t)}async function E(r){const s=h[r];if(s){y[r]=!0;try{const t=F({image:s});await m.update(r,t),delete h[r],await p()}catch(t){console.error("Replace failed:",t)}finally{y[r]=!1}}}async function L(r){confirm("Delete this banner?")&&(await m.destroy(r),await p())}return S(p),(r,s)=>(o(),l(A,null,[C(j(I),{title:"Banner Management"}),C(O,null,{default:M(()=>[n("div",J,[s[5]||(s[5]=n("h2",{class:"text-2xl font-semibold text-white"},"Banners Gallery",-1)),n("div",K,[s[2]||(s[2]=n("h3",{class:"text-lg font-bold mb-3"},"Add Banner",-1)),n("div",Q,[n("div",null,[n("input",{type:"file",accept:"image/*",onChange:$,class:"form-input"},null,32),_.value?(o(),l("div",W,[n("img",{src:_.value,class:"w-48 h-28 object-cover rounded border"},null,8,X)])):B("",!0)]),n("label",Y,[V(n("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=t=>b.value=t)},null,512),[[T,b.value]]),s[1]||(s[1]=n("span",null,"Enabled",-1))]),n("button",{disabled:x.value||!g.value,class:"px-4 py-2 bg-green-600 text-white rounded disabled:opacity-60",onClick:N},f(x.value?"Uploading…":"Upload"),9,Z)]),v.value?(o(),l("div",ee,f(v.value),1)):B("",!0)]),n("div",te,[n("div",{class:"flex items-center justify-between mb-4"},[s[3]||(s[3]=n("h3",{class:"text-lg font-semibold text-gray-800"},"All Banners",-1)),n("button",{onClick:p,class:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50"}," Refresh ")]),i.value?(o(),l("div",ne,"Loading…")):(o(),l("div",se,[a.value.length?(o(),l("div",ae,[n("table",re,[s[4]||(s[4]=n("thead",null,[n("tr",{class:"bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},[n("th",{class:"px-4 py-3 border-b"},"ID"),n("th",{class:"px-4 py-3 border-b"},"Image"),n("th",{class:"px-4 py-3 border-b"},"Status"),n("th",{class:"px-4 py-3 border-b"},"Replace Image"),n("th",{class:"px-4 py-3 border-b text-center"},"Actions")])],-1)),n("tbody",null,[(o(!0),l(A,null,z(a.value,t=>(o(),l("tr",{key:t.id,class:"hover:bg-gray-50 transition-colors odd:bg-gray-50/50"},[n("td",ie,f(t.id),1),n("td",le,[t.image_url?(o(),l("img",{key:0,src:t.image_url,class:"w-24 h-16 object-cover rounded border"},null,8,oe)):(o(),l("span",de,"No image"))]),n("td",ce,[n("label",ue,[n("input",{type:"checkbox",checked:t.is_enabled,onChange:d=>R(t)},null,40,ge),n("span",{class:G(["px-2 py-0.5 rounded-full text-xs font-medium",t.is_enabled?"bg-green-100 text-green-700":"bg-red-100 text-red-700"])},f(t.is_enabled?"Enabled":"Disabled"),3)])]),n("td",pe,[n("input",{type:"file",accept:"image/*",onChange:d=>U(t.id,d),class:"block w-full text-xs text-gray-600"},null,40,fe),n("button",{class:"mt-1 px-2 py-1 border rounded text-xs hover:bg-gray-50",onClick:d=>E(t.id),disabled:!h[t.id]||y[t.id]},f(y[t.id]?"Saving…":"Save"),9,me)]),n("td",_e,[n("button",{class:"px-2 py-1 border rounded text-xs text-red-600 hover:bg-red-50",onClick:d=>L(t.id)}," Delete ",8,be)])]))),128))])])])):(o(),l("div",xe," No banners found. "))]))])])]),_:1})],64))}},ke=q(ve,[["__scopeId","data-v-9fe0d0b2"]]);export{ke as default};
