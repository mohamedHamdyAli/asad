import{p as n,q as A,c as T,o,w as F,b as e,j as r,k as p,f as u,h as w,F as V,s as Q,t as v,N}from"./app-CHzwI3cM.js";import{_ as O}from"./AuthenticatedLayout-BJaAcZYD.js";import{U as h,b as M,a as S}from"./unitQuotes-BD2TmZFG.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"p-6 space-y-8"},G={class:"bg-white p-6 rounded-2xl shadow space-y-4"},H={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},J=["src"],K={class:"md:col-span-3"},W={key:0,class:"flex flex-wrap gap-2 mt-2"},X=["src"],Y={class:"flex justify-end"},Z=["disabled"],q={class:"bg-white p-6 rounded-2xl shadow"},ee={key:0,class:"text-sm text-gray-500"},te={key:1,class:"text-center text-gray-500 py-8"},le={key:2,class:"overflow-x-auto"},se={class:"min-w-full border border-gray-200 text-sm"},ae={class:"py-2 px-3"},ie={class:"py-2 px-3"},oe={class:"py-2 px-3"},ne={class:"py-2 px-3"},ue={class:"py-2 px-3"},de={class:"py-2 px-3 text-center"},re=["onClick"],pe=["onClick"],ve={key:0,class:"fixed inset-0 z-[1000] flex items-center justify-center"},ce={class:"relative z-10 bg-white rounded-2xl shadow-2xl w-full max-w-3xl p-6 overflow-y-auto max-h-[90vh]"},fe={class:"flex justify-between mb-4"},ye={class:"text-lg font-semibold text-gray-800"},be={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ge=["src"],me={class:"mt-6 flex justify-end gap-3"},_e=["disabled"],xe={__name:"UnitQuotes",setup(we){const U=n([]),k=n(!1),f=n(!1),y=n(!1),C=n(!1),b=n(null),g=n(null),m=n(null),_=n([]),a=n({title:"",other_title:"",user_id:"",type_of_building_id:"",type_of_price_id:"",pay_image:null,gallery:[]}),i=n({});function L(s){var d;const t=(d=s.target.files)==null?void 0:d[0];t&&(a.value.pay_image=t,g.value=URL.createObjectURL(t))}function P(s){const t=Array.from(s.target.files||[]);a.value.gallery=t,_.value=t.map(d=>URL.createObjectURL(d))}async function c(){k.value=!0;try{U.value=await h.list()}finally{k.value=!1}}async function D(){f.value=!0;try{const s=M(a.value);await h.create(s),await c(),a.value={title:"",other_title:"",user_id:"",type_of_building_id:"",type_of_price_id:"",pay_image:null,gallery:[]},g.value=null,_.value=[]}finally{f.value=!1}}function R(s){b.value=s,i.value={...s},C.value=!0}function x(){C.value=!1,b.value=null,m.value=null}function B(s){var d;const t=(d=s.target.files)==null?void 0:d[0];t&&(i.value.pay_image=t,m.value=URL.createObjectURL(t))}async function E(){y.value=!0;try{const s=S(i.value);await h.update(b.value.id,s),await c(),x()}finally{y.value=!1}}async function I(s){confirm("Delete this quotation?")&&(await h.remove(s),await c())}return A(c),(s,t)=>(o(),T(O,null,{default:F(()=>{var d;return[e("div",z,[t[26]||(t[26]=e("div",{class:"flex items-center justify-between"},[e("h2",{class:"text-2xl font-bold text-gray-800"},"Unit Quotations")],-1)),e("div",G,[t[17]||(t[17]=e("h3",{class:"text-lg font-semibold text-gray-800"},"Add New Quotation",-1)),e("div",H,[e("div",null,[t[10]||(t[10]=e("label",{class:"label"},"Title *",-1)),r(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>a.value.title=l),class:"form-input"},null,512),[[p,a.value.title]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"label"},"Other Title",-1)),r(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>a.value.other_title=l),class:"form-input"},null,512),[[p,a.value.other_title]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"label"},"User ID *",-1)),r(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>a.value.user_id=l),type:"number",class:"form-input"},null,512),[[p,a.value.user_id]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"label"},"Building Type *",-1)),r(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>a.value.type_of_building_id=l),type:"number",class:"form-input"},null,512),[[p,a.value.type_of_building_id]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"label"},"Price Type *",-1)),r(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>a.value.type_of_price_id=l),type:"number",class:"form-input"},null,512),[[p,a.value.type_of_price_id]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"label"},"Pay Image *",-1)),e("input",{type:"file",accept:"image/*,.pdf",onChange:L,class:"form-input"},null,32),g.value?(o(),u("img",{key:0,src:g.value,class:"w-32 h-24 mt-2 object-cover rounded border"},null,8,J)):w("",!0)]),e("div",K,[t[16]||(t[16]=e("label",{class:"label"},"Gallery *",-1)),e("input",{type:"file",multiple:"",accept:"image/*,.pdf",onChange:P,class:"form-input"},null,32),_.value.length?(o(),u("div",W,[(o(!0),u(V,null,Q(_.value,(l,j)=>(o(),u("img",{key:j,src:l,class:"w-24 h-16 object-cover rounded border"},null,8,X))),128))])):w("",!0)])]),e("div",Y,[e("button",{class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-60",disabled:f.value,onClick:D},v(f.value?"Saving…":"Create Quotation"),9,Z)])]),e("div",q,[e("div",{class:"flex items-center justify-between mb-4"},[t[18]||(t[18]=e("h3",{class:"text-lg font-semibold text-gray-800"},"All Quotations",-1)),e("button",{onClick:c,class:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50"}," Refresh ")]),k.value?(o(),u("div",ee,"Loading…")):U.value.length?(o(),u("div",le,[e("table",se,[t[19]||(t[19]=e("thead",{class:"bg-gray-100 text-gray-700"},[e("tr",null,[e("th",{class:"py-2 px-3 text-left"},"#"),e("th",{class:"py-2 px-3 text-left"},"Title"),e("th",{class:"py-2 px-3 text-left"},"User"),e("th",{class:"py-2 px-3 text-left"},"Building Type"),e("th",{class:"py-2 px-3 text-left"},"Price Type"),e("th",{class:"py-2 px-3 text-center"},"Actions")])],-1)),e("tbody",null,[(o(!0),u(V,null,Q(U.value,l=>(o(),u("tr",{key:l.id,class:"border-t hover:bg-gray-50 transition"},[e("td",ae,"#"+v(l.id),1),e("td",ie,v(l.title),1),e("td",oe,v(l.user_id),1),e("td",ne,v(l.type_of_building_id),1),e("td",ue,v(l.type_of_price_id),1),e("td",de,[e("button",{class:"px-3 py-1 text-xs border rounded text-blue-600 border-blue-200 hover:bg-blue-50 mr-2",onClick:j=>R(l)}," Edit ",8,re),e("button",{class:"px-3 py-1 text-xs border rounded text-red-600 border-red-200 hover:bg-red-50",onClick:j=>I(l.id)}," Delete ",8,pe)])]))),128))])])])):(o(),u("div",te,"No quotations found."))]),(o(),T(N,{to:"body"},[C.value?(o(),u("div",ve,[e("div",{class:"absolute inset-0 bg-black/40",onClick:x}),e("div",ce,[e("div",fe,[e("h3",ye,"Edit Quotation #"+v((d=b.value)==null?void 0:d.id),1),e("button",{onClick:x,class:"text-gray-500 hover:text-gray-700 text-xl"},"✕")]),e("div",be,[e("div",null,[t[20]||(t[20]=e("label",{class:"label"},"Title",-1)),r(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>i.value.title=l),class:"form-input"},null,512),[[p,i.value.title]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"label"},"Other Title",-1)),r(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>i.value.other_title=l),class:"form-input"},null,512),[[p,i.value.other_title]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"label"},"User ID",-1)),r(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>i.value.user_id=l),class:"form-input"},null,512),[[p,i.value.user_id]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"label"},"Building Type",-1)),r(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>i.value.type_of_building_id=l),class:"form-input"},null,512),[[p,i.value.type_of_building_id]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"label"},"Price Type",-1)),r(e("input",{"onUpdate:modelValue":t[9]||(t[9]=l=>i.value.type_of_price_id=l),class:"form-input"},null,512),[[p,i.value.type_of_price_id]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"label"},"Replace Pay Image",-1)),e("input",{type:"file",accept:"image/*,.pdf",onChange:B,class:"form-input"},null,32),m.value?(o(),u("img",{key:0,src:m.value,class:"w-32 h-24 mt-2 object-cover rounded border"},null,8,ge)):w("",!0)])]),e("div",me,[e("button",{class:"px-4 py-2 border rounded-lg",onClick:x},"Cancel"),e("button",{class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-60",disabled:y.value,onClick:E},v(y.value?"Saving…":"Save Changes"),9,_e)])])])):w("",!0)]))])]}),_:1}))}},je=$(xe,[["__scopeId","data-v-cbc9cae2"]]);export{je as default};
