import{p as v,C as nt,c as T,o as n,b as t,a as d,t as b,w as q,u as i,O as Z,z as ot,m as V,q as it,f as x,h as I,F as tt,s as et,e as L,n as O,T as xt,d as yt,j as R,k as at,y as lt}from"./app-Duxcg2QP.js";import{_ as gt}from"./AuthenticatedLayout-5BO_1ROD.js";import{_ as ft}from"./UnitNav-BJ9b5oCc.js";import{U as B,b as _t,a as wt}from"./unitPayments-Bx5XUheK.js";import{b as kt,U as J,a as ht}from"./unitInstallments-43_WTs7t.js";import{c as G,b as A,e as H,d as k,E as S,F as rt}from"./index.esm-SIBzUVwy.js";import{_ as dt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const $t={class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},It={class:"bg-white rounded-xl shadow-xl w-full max-w-3xl p-6 relative animate-fadeIn"},Ct={class:"text-xl font-semibold mb-4"},Pt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},At={class:"md:col-span-2"},St={class:"md:col-span-2"},Mt={class:"flex justify-end mt-6 gap-3"},Dt=["disabled"],Nt={__name:"InstallmentModal",props:{mode:String,data:Object,paymentId:[String,Number]},emits:["close","saved"],setup(y,{emit:u}){var D,U,j,g,h,p,P,w;const{show:f}=ot(),l=y,r=u,_=v(!1),M=G({title:G({en:A().required("Title (EN) is required"),ar:A().required("Title (AR) is required")}),description:G({en:A().nullable(),ar:A().nullable()}),amount:H().typeError("Amount must be a number").required("Amount is required").min(0,"Amount must be >= 0"),percentage:H().nullable().min(0,"Min 0").max(100,"Max 100").typeError("Percentage must be a number"),milestone_date:A().nullable(),submission_date:A().nullable(),consultant_approval_date:A().nullable(),due_date:A().nullable()});function $(o,a){if(!o)return a;if(typeof o=="string")try{return JSON.parse(o)}catch{return a}return o}const C=v({title:$((D=l.data)==null?void 0:D.title,{en:"",ar:""}),description:$((U=l.data)==null?void 0:U.description,{en:"",ar:""}),amount:((j=l.data)==null?void 0:j.amount)??"",percentage:((g=l.data)==null?void 0:g.percentage)??"",milestone_date:((h=l.data)==null?void 0:h.milestone_date)??"",submission_date:((p=l.data)==null?void 0:p.submission_date)??"",consultant_approval_date:((P=l.data)==null?void 0:P.consultant_approval_date)??"",due_date:((w=l.data)==null?void 0:w.due_date)??""});nt(()=>l.data,o=>{o&&(C.value={title:$(o.title,{en:"",ar:""}),description:$(o.description,{en:"",ar:""}),amount:o.amount??"",percentage:o.percentage??"",milestone_date:o.milestone_date??"",submission_date:o.submission_date??"",consultant_approval_date:o.consultant_approval_date??"",due_date:o.due_date??"",status:o.status??"pending"})},{immediate:!0});async function N(o){_.value=!0;try{if(l.mode==="add"){const a=kt(l.paymentId,o);await J.create(a)}else{const a={...o,unit_payment_id:l.paymentId},E=ht(a);await J.update(l.data.id,E)}r("saved"),r("close")}catch(a){console.error(a),f(e),alert("Failed to save installment")}finally{_.value=!1}}return(o,a)=>(n(),T(Z,{to:"body"},[t("div",$t,[t("div",It,[t("button",{onClick:a[0]||(a[0]=E=>o.$emit("close")),class:"absolute top-3 right-4 text-gray-500 hover:text-black"}," ✕ "),t("h3",Ct,b(y.mode==="add"?"Add Installment":"Edit Installment"),1),d(i(rt),{onSubmit:N,"initial-values":C.value,"validation-schema":i(M)},{default:q(()=>[t("div",Pt,[t("div",null,[a[2]||(a[2]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Title (EN) *",-1)),d(i(k),{name:"title.en",as:"input",class:"form-input"}),d(i(S),{name:"title.en",class:"text-red-600 text-xs mt-1"})]),t("div",null,[a[3]||(a[3]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Title (AR) *",-1)),d(i(k),{name:"title.ar",as:"input",class:"form-input",dir:"rtl"}),d(i(S),{name:"title.ar",class:"text-red-600 text-xs mt-1"})]),t("div",At,[a[4]||(a[4]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Description (EN)",-1)),d(i(k),{name:"description.en",as:"textarea",rows:"2",class:"form-input"}),d(i(S),{name:"description.en",class:"text-red-600 text-xs mt-1"})]),t("div",St,[a[5]||(a[5]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Description (AR)",-1)),d(i(k),{name:"description.ar",as:"textarea",rows:"2",class:"form-input",dir:"rtl"}),d(i(S),{name:"description.ar",class:"text-red-600 text-xs mt-1"})]),t("div",null,[a[6]||(a[6]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Amount *",-1)),d(i(k),{name:"amount",as:"input",type:"number",class:"form-input"}),d(i(S),{name:"amount",class:"text-red-600 text-xs mt-1"})]),t("div",null,[a[7]||(a[7]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Percentage",-1)),d(i(k),{name:"percentage",as:"input",type:"number",class:"form-input"}),d(i(S),{name:"percentage",class:"text-red-600 text-xs mt-1"})]),t("div",null,[a[8]||(a[8]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Milestone Date",-1)),d(i(k),{name:"milestone_date",as:"input",type:"date",class:"form-input"})]),t("div",null,[a[9]||(a[9]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Submission Date",-1)),d(i(k),{name:"submission_date",as:"input",type:"date",class:"form-input"})]),t("div",null,[a[10]||(a[10]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Consultant Approval Date",-1)),d(i(k),{name:"consultant_approval_date",as:"input",type:"date",class:"form-input"})]),t("div",null,[a[11]||(a[11]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Due Date",-1)),d(i(k),{name:"due_date",as:"input",type:"date",class:"form-input"})]),t("div",null,[a[13]||(a[13]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Status",-1)),d(i(k),{name:"status",as:"select",class:"form-input"},{default:q(()=>a[12]||(a[12]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"paid"},"Paid",-1),t("option",{value:"overdue"},"Overdue",-1)])),_:1})])]),t("div",Mt,[t("button",{class:"px-4 py-2 border rounded hover:bg-gray-100",onClick:a[1]||(a[1]=E=>o.$emit("close")),type:"button"}," Cancel "),t("button",{class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",type:"submit",disabled:_.value},b(_.value?"Saving…":"Save"),9,Dt)])]),_:1},8,["initial-values","validation-schema"])])])]))}},Tt=dt(Nt,[["__scopeId","data-v-546c82a5"]]),Y={list:async y=>{const{data:u}=await V.get(`/api/unit-payments/installments/${y}/invoices`);return Array.isArray(u)?u:(u==null?void 0:u.data)??[]},updateStatus:async(y,u)=>{const{data:f}=await V.post(`/api/unit-payments/installments/${y}/status`,{status:u});return f},confirmInvoice:async(y,u)=>{const{data:f}=await V.post("/api/unit-payments/invoices/confirm",{invoice_id:y,action:u});return f}},jt={class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},qt={class:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl p-6 relative animate-fadeIn max-h-[90vh] overflow-y-auto"},Ut={key:0,class:"text-sm text-gray-500"},Et={key:1},Lt={class:"flex justify-between items-start"},Ft={class:"font-semibold text-gray-800"},Vt={class:"text-blue-600"},Ot={class:"mt-2"},zt={class:"mt-3"},Rt=["src","onClick"],Bt={class:"flex flex-col gap-2"},Gt=["onClick","disabled"],Jt=["onClick","disabled"],Ht={key:0,class:"text-center text-gray-500 text-sm mt-6"},Kt={class:"bg-white rounded-xl shadow-2xl p-4 w-full max-w-lg"},Qt=["src"],Wt={__name:"InvoiceModal",props:{installment:Object},emits:["close"],setup(y,{emit:u}){const f=y,l=v([]),r=v(!1),_=v(""),M=v(""),$=v(!1),C=v(null);it(async()=>{r.value=!0,l.value=await Y.list(f.installment.id),r.value=!1});async function N(g,h){var p,P;if(_.value="",M.value="",!!confirm(`Mark invoice #${g.id} as ${h}?`))try{const w=await Y.confirmInvoice(g.id,h);(w==null?void 0:w.status)==="error"?(M.value="error",_.value=w.message||"Action failed."):(w==null?void 0:w.status)==="success"&&(M.value="success",_.value=w.message||"Action successful."),l.value=await Y.list(f.installment.id),setTimeout(()=>_.value="",4e3)}catch(w){M.value="error",_.value=((P=(p=w.response)==null?void 0:p.data)==null?void 0:P.message)||"Something went wrong.",setTimeout(()=>_.value="",4e3)}}function D(g){return g?`/storage/${g}`:""}function U(g){C.value=g,$.value=!0}function j(){C.value=null,$.value=!1}return(g,h)=>(n(),T(Z,{to:"body"},[t("div",jt,[t("div",qt,[t("button",{onClick:h[0]||(h[0]=p=>g.$emit("close")),class:"absolute top-3 right-4 text-gray-400 hover:text-gray-700 text-xl"}," ✕ "),h[2]||(h[2]=t("h3",{class:"text-2xl font-semibold text-gray-800 mb-6 border-b pb-2"}," Invoices ",-1)),r.value?(n(),x("div",Ut,"Loading...")):(n(),x("div",Et,[(n(!0),x(tt,null,et(l.value,p=>(n(),x("div",{key:p.id,class:"p-4 mb-3 border rounded-xl hover:shadow transition bg-gray-50"},[t("div",Lt,[t("div",null,[t("p",Ft,[L(" Invoice #"+b(p.id)+" — ",1),t("span",Vt,b(p.paid_amount)+" EGP",1)]),t("div",Ot,[t("span",{class:O(["inline-block px-3 py-1 text-xs rounded-full font-medium border",p.status==="confirmed"?"bg-green-100 text-green-700 border-green-200":p.status==="rejected"?"bg-red-100 text-red-700 border-red-200":"bg-yellow-100 text-yellow-700 border-yellow-200"])},b(p.status?p.status.toUpperCase():"PENDING"),3)]),t("div",zt,[t("img",{src:D(p.invoice_file),alt:"Invoice File",class:"rounded-lg shadow-sm border object-contain max-h-40 cursor-pointer hover:scale-105 transition",onClick:P=>U(p.invoice_file)},null,8,Rt)])]),t("div",Bt,[t("button",{onClick:P=>N(p,"confirm"),class:O(["px-4 py-1.5 rounded-lg text-sm font-medium text-white transition",p.status==="confirmed"?"bg-green-300 cursor-not-allowed":"bg-green-600 hover:bg-green-700"]),disabled:p.status==="confirmed"},b(p.status==="confirmed"?"Approved":"Approve"),11,Gt),t("button",{onClick:P=>N(p,"reject"),class:"px-4 py-1.5 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700 transition",disabled:p.status==="rejected"},b(p.status==="rejected"?"Rejected":"Reject"),9,Jt)])])]))),128)),l.value.length?I("",!0):(n(),x("div",Ht," No invoices found. "))])),d(xt,{name:"fade"},{default:q(()=>[_.value?(n(),x("div",{key:0,class:O(["mt-5 p-3 rounded-lg text-sm font-medium border text-center",M.value==="error"?"bg-red-50 text-red-700 border-red-200":"bg-green-50 text-green-700 border-green-200"])},b(_.value),3)):I("",!0)]),_:1}),$.value?(n(),x("div",{key:2,class:"fixed inset-0 bg-black/60 flex items-center justify-center z-[100]",onClick:yt(j,["self"])},[t("div",Kt,[t("div",{class:"flex justify-between items-center mb-2"},[h[1]||(h[1]=t("h4",{class:"font-semibold text-gray-700 text-lg"},"Invoice Preview",-1)),t("button",{onClick:j,class:"text-gray-500 hover:text-gray-700 text-xl"}," ✕ ")]),t("img",{src:D(C.value),alt:"Invoice",class:"rounded-lg object-contain max-h-[75vh] w-full"},null,8,Qt)])])):I("",!0)])])]))}},Xt=dt(Wt,[["__scopeId","data-v-48c1c86b"]]),Yt={class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},Zt={class:"bg-white w-full max-w-2xl rounded-lg p-6 relative shadow-xl animate-fadeIn"},te={key:0,class:"text-center text-gray-500 py-8"},ee={key:1,class:"divide-y divide-gray-200 max-h-96 overflow-y-auto"},se={class:"flex justify-between items-center"},ae={class:"font-medium text-gray-800"},le={class:"text-sm text-gray-600 mt-1"},ne={class:"text-sm text-gray-500"},oe={class:"text-xs text-gray-400"},ie={key:0,class:"text-sm text-gray-600 mt-1"},re={__name:"PaymentLogsModal",props:{logs:{type:Array,default:()=>[]}},setup(y){return(u,f)=>(n(),T(Z,{to:"body"},[t("div",Yt,[t("div",Zt,[t("button",{onClick:f[0]||(f[0]=l=>u.$emit("close")),class:"absolute right-4 top-3 text-gray-500 hover:text-black"},"✕"),f[1]||(f[1]=t("h3",{class:"text-lg font-semibold mb-4 text-gray-800"},"Payment Logs",-1)),y.logs.length?(n(),x("ul",ee,[(n(!0),x(tt,null,et(y.logs,l=>(n(),x("li",{key:l.id,class:"py-3"},[t("div",se,[t("div",null,[t("p",ae,b(l.action||"Action"),1),t("p",le,b(l.description||"Description"),1),t("p",ne,"By: "+b(l.created_by_name||"System Admin"),1)]),t("span",oe,b(new Date(l.created_at).toLocaleString()),1)]),l.notes?(n(),x("p",ie,b(l.notes),1)):I("",!0)]))),128))])):(n(),x("div",te,"No logs found."))])])]))}},de={unitLogs:async y=>{const{data:u}=await V.get(`/api/unit-payments/logs/${y}`);return(u==null?void 0:u.data)??[]},installmentLogs:async y=>{const{data:u}=await V.get(`/api/unit-payments/installment/${y}/logs`);return(u==null?void 0:u.data)??[]}},ue={class:"container mx-auto p-6"},me={class:"flex border-b mb-6 mt-6 items-center"},ce={key:0,class:"p-6 rounded shadow mt-6"},pe={key:0,class:"text-sm text-gray-500"},be={key:1,class:"text-center text-gray-500 py-6"},ve={key:2,class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},xe={key:1,class:"bg-white p-6 rounded shadow mt-6"},ye={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ge={class:"mt-4 text-right"},fe=["disabled"],_e={key:1,class:"space-y-6"},we={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},ke={class:"flex justify-end gap-2"},he={key:2,class:"space-y-4"},$e={class:"flex justify-between items-center mb-4"},Ie=["disabled"],Ce={key:0,class:"bg-white rounded-xl shadow-sm p-4"},Pe={class:"min-w-full text-sm text-left border"},Ae={class:"p-2 border"},Se={class:"p-2 border"},Me={class:"p-2 border"},De={class:"p-2 border"},Ne={class:"p-2 border"},Te={class:"p-2 border"},je={class:"p-2 border text-center"},qe=["onClick"],Ue={class:"p-2 border flex gap-2"},Ee=["onClick"],Le=["onClick"],Fe=["onClick"],Ve={key:0,class:"text-center py-4 text-gray-500"},Ke={__name:"UnitPaymentsAndInstallments",props:{unitId:Number},setup(y){const{show:u}=ot(),f=y,l=v("payments"),r=v(null),_=v({total_price:"",installments_count:"",payment_type:"installments",overall_status:"pending"}),M=G({total_price:H().typeError("Total price is required").required("Total price is required").positive("Total price must be greater than 0"),installments_count:H().typeError("Installments count is required").required("Installments count is required").integer("Installments count must be an integer").min(1,"At least 1 installment is required"),payment_type:A().required("Payment type is required"),overall_status:A().required("Overall status is required")}),$=v(!1),C=v(!1),N=v(!1),D=v([]);function U(c){r.value={...c,editable:{...c}}}async function j(c){N.value=!0;try{const s=await de.installmentLogs(c);D.value=s}catch{D.value=[],u(e),console.log("No logs found")}}async function g(){var c;C.value=!0;try{const s=await B.list(f.unitId);if(((c=s==null?void 0:s.data)==null?void 0:c.length)>0||(s==null?void 0:s.length)>0){const m=s.data?s.data[0]:s[0];U(m),o.value=m.id}else r.value=null,o.value=null;l.value==="installments"&&await F()}catch(s){u(s)}finally{C.value=!1}}async function h(c){try{$.value=!0;const s=_t(f.unitId,[c]);await B.create(s),await g()}catch(s){u(s)}finally{$.value=!1}}async function p(){try{if(!r.value)return;const c=wt(r.value.editable);await B.update(r.value.id,c),await g()}catch(c){u(c)}}async function P(c){confirm("Delete this payment?")&&(await B.remove(c),await g())}function w(c){const s=Number(c);return isNaN(s)?"0.00":s.toFixed(2)}const o=v(null),a=v([]),E=v(!1);async function F(){if(o.value){E.value=!0;try{a.value=await J.list(o.value)}finally{E.value=!1}}}async function ut(c){confirm("Delete this installment?")&&(await J.remove(c),await g(),await F())}const z=v(!1),K=v("add"),Q=v(null);function mt(){K.value="add",Q.value=null,z.value=!0}function ct(c){K.value="edit",Q.value={...c,unit_payment_id:o.value},z.value=!0}function pt(){z.value=!1}const W=v(!1),st=v(null);function bt(c){st.value=c,W.value=!0}function vt(){W.value=!1}return it(g),nt(l,async c=>{c==="installments"&&o.value&&await F()}),(c,s)=>(n(),T(gt,null,{default:q(()=>[t("div",ue,[d(ft,{"unit-id":Number(y.unitId),cols:2},null,8,["unit-id"]),t("div",me,[t("button",{class:O([l.value==="payments"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600","px-4 py-2 font-medium"]),onClick:s[0]||(s[0]=m=>l.value="payments")}," Payments ",2),t("button",{class:O([l.value==="installments"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600","px-4 py-2 font-medium"]),onClick:s[1]||(s[1]=m=>l.value="installments")}," Installments ",2)]),l.value==="payments"?(n(),x("div",ce,[s[12]||(s[12]=t("div",{class:"flex justify-between items-center mb-4"},[t("h3",{class:"text-lg font-semibold text-gray-800"},"Payment")],-1)),s[13]||(s[13]=t("h3",{class:"text-lg font-semibold mb-3"},"Current Payment",-1)),C.value?(n(),x("div",pe,"Loading…")):r.value?(n(),x("div",ve,[t("div",null,[s[8]||(s[8]=t("strong",null,"Total Price:",-1)),L(" "+b(w(r.value.total_price)),1)]),t("div",null,[s[9]||(s[9]=t("strong",null,"Installments:",-1)),L(" "+b(r.value.installments_count),1)]),t("div",null,[s[10]||(s[10]=t("strong",null,"Type:",-1)),L(" "+b(r.value.payment_type),1)]),t("div",null,[s[11]||(s[11]=t("strong",null,"Status:",-1)),L(" "+b(r.value.overall_status),1)])])):(n(),x("div",be," No payment created yet. "))])):I("",!0),l.value==="payments"?(n(),x("div",xe,[s[27]||(s[27]=t("h3",{class:"text-lg font-semibold mb-4"},"Unit Payment",-1)),r.value?(n(),x("div",_e,[t("div",we,[t("div",null,[s[21]||(s[21]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Total Price",-1)),R(t("input",{"onUpdate:modelValue":s[2]||(s[2]=m=>r.value.editable.total_price=m),type:"number",class:"w-full border p-2 rounded"},null,512),[[at,r.value.editable.total_price,void 0,{number:!0}]])]),t("div",null,[s[22]||(s[22]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Installments Count",-1)),R(t("input",{"onUpdate:modelValue":s[3]||(s[3]=m=>r.value.editable.installments_count=m),type:"number",class:"w-full border p-2 rounded"},null,512),[[at,r.value.editable.installments_count,void 0,{number:!0}]])]),t("div",null,[s[24]||(s[24]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Type",-1)),R(t("select",{"onUpdate:modelValue":s[4]||(s[4]=m=>r.value.editable.payment_type=m),class:"w-full border p-2 rounded"},s[23]||(s[23]=[t("option",{value:"installments"},"Installments",-1),t("option",{value:"cash"},"Cash",-1)]),512),[[lt,r.value.editable.payment_type]])]),t("div",null,[s[26]||(s[26]=t("label",{class:"block text-gray-600 text-xs mb-1"},"Status",-1)),R(t("select",{"onUpdate:modelValue":s[5]||(s[5]=m=>r.value.editable.overall_status=m),class:"w-full border p-2 rounded"},s[25]||(s[25]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"in_progress"},"In Progress",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"overdue"},"Overdue",-1)]),512),[[lt,r.value.editable.overall_status]])])]),t("div",ke,[t("button",{onClick:p,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded"}," Save Changes "),t("button",{onClick:s[6]||(s[6]=m=>P(r.value.id)),class:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded"}," Delete ")])])):(n(),T(i(rt),{key:0,"validation-schema":i(M),"initial-values":_.value,onSubmit:h},{default:q(({submitCount:m})=>[s[20]||(s[20]=t("p",{class:"text-gray-600 mb-4"}," No payment created yet for this unit. ",-1)),t("div",ye,[t("div",null,[s[14]||(s[14]=t("label",{class:"block text-sm font-medium mb-1"},"Total Price *",-1)),d(i(k),{name:"total_price",type:"number",class:"form-control w-full border p-2 rounded"}),d(i(S),{name:"total_price",class:"text-red-600 text-xs mt-1"})]),t("div",null,[s[15]||(s[15]=t("label",{class:"block text-sm font-medium mb-1"},"Installments Count *",-1)),d(i(k),{name:"installments_count",type:"number",class:"form-control w-full border p-2 rounded"}),d(i(S),{name:"installments_count",class:"text-red-600 text-xs mt-1"})]),t("div",null,[s[17]||(s[17]=t("label",{class:"block text-sm font-medium mb-1"},"Payment Type *",-1)),d(i(k),{name:"payment_type",as:"select",class:"form-control w-full border p-2 rounded"},{default:q(()=>s[16]||(s[16]=[t("option",{value:"installments"},"Installments",-1),t("option",{value:"cash"},"Cash",-1)])),_:1}),d(i(S),{name:"payment_type",class:"text-red-600 text-xs mt-1"})]),t("div",null,[s[19]||(s[19]=t("label",{class:"block text-sm font-medium mb-1"},"Overall Status *",-1)),d(i(k),{name:"overall_status",as:"select",class:"form-control w-full border p-2 rounded"},{default:q(()=>s[18]||(s[18]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"in_progress"},"In Progress",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"overdue"},"Overdue",-1)])),_:1}),d(i(S),{name:"overall_status",class:"text-red-600 text-xs mt-1"})])]),t("div",ge,[t("button",{type:"submit",disabled:$.value,class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded disabled:opacity-50"},b($.value?"Saving…":"Create Payment"),9,fe)])]),_:1},8,["validation-schema","initial-values"]))])):I("",!0),l.value==="installments"?(n(),x("div",he,[t("div",$e,[s[28]||(s[28]=t("h3",{class:"text-lg font-semibold text-gray-800"},"Installments",-1)),t("button",{disabled:!r.value,onClick:mt,class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50"}," + Add Installment ",8,Ie)]),o.value?(n(),x("div",Ce,[t("div",{class:"flex justify-between items-center mb-3"},[s[29]||(s[29]=t("h3",{class:"font-semibold text-lg text-gray-800"},"Installments",-1)),t("button",{onClick:F,class:"px-3 py-1 text-sm border rounded-lg hover:bg-gray-50"}," Refresh ")]),t("table",Pe,[s[31]||(s[31]=t("thead",{class:"bg-gray-50 text-gray-700 uppercase text-xs"},[t("tr",null,[t("th",{class:"p-2 border"}),t("th",{class:"p-2 border"},"Title"),t("th",{class:"p-2 border"},"Amount"),t("th",{class:"p-2 border"},"Percentage"),t("th",{class:"p-2 border"},"Status"),t("th",{class:"p-2 border"},"Due Date"),t("th",{class:"p-2 border"},"Invoices"),t("th",{class:"p-2 border"},"Actions")])],-1)),t("tbody",null,[(n(!0),x(tt,null,et(a.value,m=>(n(),x("tr",{key:m.id,class:"hover:bg-gray-50 transition"},[t("td",Ae,b(m.id),1),t("td",Se,b(m.title.en),1),t("td",Me,b(m.amount),1),t("td",De,b(m.percentage),1),t("td",Ne,b(m.status),1),t("td",Te,b(m.due_date||"-"),1),t("td",je,[t("button",{onClick:X=>bt(m),class:"text-blue-600 underline text-xs hover:text-blue-800"}," View ",8,qe)]),t("td",Ue,[t("button",{onClick:X=>ct(m),class:"px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700"}," Edit ",8,Ee),t("button",{onClick:X=>ut(m.id),class:"px-2 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700"}," Delete ",8,Le),t("button",{onClick:X=>j(m.id),class:"px-3 py-1 text-xs border rounded text-gray-700 border-gray-200 hover:bg-gray-50 flex items-center gap-1"},s[30]||(s[30]=[t("i",{class:"fa fa-clock text-blue-500"},null,-1),L(" Logs ")]),8,Fe)])]))),128))])]),a.value.length?I("",!0):(n(),x("div",Ve," No installments found. "))])):I("",!0)])):I("",!0)]),z.value?(n(),T(Tt,{key:0,mode:K.value,data:Q.value,paymentId:o.value,onClose:pt,onSaved:F},null,8,["mode","data","paymentId"])):I("",!0),W.value?(n(),T(Xt,{key:1,installment:st.value,onClose:vt},null,8,["installment"])):I("",!0),N.value?(n(),T(re,{key:2,logs:D.value,onClose:s[7]||(s[7]=m=>N.value=!1)},null,8,["logs"])):I("",!0)]),_:1}))}};export{Ke as default};
