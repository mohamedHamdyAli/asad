import{k as y,l as v,p as I,c as G,o as c,w as Y,b as e,f as p,h as V,F as D,q as F,t as f,n as H,d as J,j as g,s as h,y as K,v as Q,e as W}from"./app-C-x1AC2s.js";import{_ as X}from"./AuthenticatedLayout-gdQDWDWu.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";function ee(t){var l;return Array.isArray(t)?t:Array.isArray(t==null?void 0:t.message)?t.message:Array.isArray(t==null?void 0:t.data)?t.data:Array.isArray((l=t==null?void 0:t.data)==null?void 0:l.data)?t.data.data:[]}function S(t){return(t==null?void 0:t.data)??(t==null?void 0:t.message)??t}function U(t={}){return{id:t.id,name:t.name??"",email:t.email??"",phone:t.phone??"",country_code:t.country_code??"",country_name:t.country_name??"",gender:t.gender??"",role:t.role??"",is_enabled:Number(t.is_enabled)===1||t.is_enabled===!0,profile_image:t.profile_image??null,profile_image_url:t.profile_image?`/storage/${t.profile_image}`:"",created_at:t.created_at,updated_at:t.updated_at}}const A={list:async(t={})=>{const{data:l}=await y.get("/api/vendors",{params:t});return ee(l).map(U)},show:async t=>{const{data:l}=await y.get(`/api/vendors/show/${t}`);return U(S(l))},edit:async t=>{const{data:l}=await y.get(`/api/vendors/edit/${t}`);return U(S(l))},create:async t=>{const{data:l}=await y.post("/api/vendors/create",t,{headers:{"Content-Type":"multipart/form-data"}});return l},update:async(t,l)=>{const{data:m}=await y.post(`/api/vendors/update/${t}`,l,{headers:{"Content-Type":"multipart/form-data"}});return m},remove:async t=>{const{data:l}=await y.delete(`/api/vendors/delete/${t}`);return l}};function te({name:t,email:l,phone:m,password:u,country_code:r,country_name:w,gender:a,is_enabled:_=!0,profile_image:x}){const d=new FormData;return d.append("name",t??""),d.append("email",l??""),d.append("phone",m??""),d.append("password",u??""),d.append("country_code",r??""),d.append("country_name",w??""),d.append("gender",a??""),d.append("is_enabled",(_?1:0).toString()),d.append("role","vendor"),x&&d.append("profile_image",x),d}function se(t={}){const l=new FormData;for(const[m,u]of Object.entries(t))if(u!=null)if(m==="profile_image"&&u)l.append("profile_image",u);else if(m==="is_enabled")l.append("is_enabled",(u?1:0).toString());else if(typeof u=="string"){const r=u.trim();r!==""&&l.append(m,r)}else l.append(m,u);return l}const ne={class:"p-6 space-y-6"},ae={class:"flex items-center justify-between"},le={class:"bg-white shadow rounded-lg p-4"},oe={key:0,class:"text-sm text-gray-500"},re={key:1,class:"overflow-x-auto"},ie={class:"w-full text-sm text-left text-gray-700"},de={class:"px-3 py-2"},ue={class:"px-3 py-2"},ce={class:"w-10 h-10 rounded-full overflow-hidden bg-gray-100 flex items-center justify-center"},pe=["src"],me={key:1,class:"text-xs text-gray-400"},fe={class:"px-3 py-2 font-medium"},ve={class:"px-3 py-2"},_e={class:"px-3 py-2"},ge={class:"px-3 py-2"},xe={class:"px-3 py-2 text-right space-x-2"},be=["onClick"],ye=["onClick"],he={key:0},we={key:0,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},ke={class:"bg-white rounded-2xl shadow-lg w-full max-w-2xl p-5 relative"},Ve={class:"text-lg font-bold mb-4"},Ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},qe={class:"md:col-span-2"},Ae=["required"],je=["required"],Ue=["required"],Ee={class:"block text-xs text-gray-500 mb-1"},Me=["required"],$e=["required"],Ne=["required"],De={class:"flex items-center gap-2"},Fe={class:"md:col-span-2"},Se={class:"block text-xs text-gray-500 mb-1"},Pe=["required"],Le={key:0,class:"mt-2"},Oe=["src"],Be={class:"mt-4 flex items-center gap-3"},Re=["disabled"],Te={key:0,class:"text-sm text-red-600 mt-2"},ze={key:1,class:"mt-2 text-sm text-red-600 list-disc pl-6"},Ie={__name:"VendorsManagement",setup(t){const l=v([]),m=v(!1),u=v(!1),r=v(null),w=v(null),a=v({name:"",email:"",phone:"",password:"",gender:"",country_code:"",country_name:"",is_enabled:!0,profile_image:null}),_=v(null),x=v(!1),d=v(""),k=v({});function E(){a.value={name:"",email:"",phone:"",password:"",gender:"",country_code:"",country_name:"",is_enabled:!0,profile_image:null},_.value=null,d.value="",k.value={},r.value=null,w.value=null}function P(){E(),u.value=!0}function L(i){E(),r.value=i.id,w.value={...i},Object.assign(a.value,{name:i.name,email:i.email,phone:i.phone,gender:i.gender||"",country_code:i.country_code||"",country_name:i.country_name||"",is_enabled:!!i.is_enabled}),_.value=i.profile_image_url||null,u.value=!0}function j(){u.value=!1}function O(i){var n;const s=((n=i.target.files)==null?void 0:n[0])||null;a.value.profile_image=s,_.value=s?URL.createObjectURL(s):_.value}async function C(){m.value=!0;try{l.value=await A.list()}finally{m.value=!1}}async function B(){var i,s,n,b,M;x.value=!0,d.value="",k.value={};try{if(r.value){const o={};["name","email","phone","gender","country_code","country_name","is_enabled"].forEach(q=>{var $,N;((($=w.value)==null?void 0:$[q])??"")!==(((N=a.value)==null?void 0:N[q])??"")&&(o[q]=a.value[q])}),a.value.password&&a.value.password.trim()!==""&&(o.password=a.value.password),a.value.profile_image&&(o.profile_image=a.value.profile_image);const z=se(o);await A.update(r.value,z)}else{const o=te(a.value);await A.create(o)}await C(),j()}catch(o){((i=o==null?void 0:o.response)==null?void 0:i.status)===422&&((n=(s=o==null?void 0:o.response)==null?void 0:s.data)!=null&&n.errors)?(k.value=o.response.data.errors,d.value=o.response.data.message||"Validation error"):d.value=((M=(b=o==null?void 0:o.response)==null?void 0:b.data)==null?void 0:M.message)||(o==null?void 0:o.message)||"Request failed"}finally{x.value=!1}}async function R(i){confirm(`Delete vendor "${i.name}"?`)&&(await A.remove(i.id),await C())}return I(C),(i,s)=>(c(),G(X,null,{default:Y(()=>[e("div",ne,[e("div",ae,[s[9]||(s[9]=e("h2",{class:"text-2xl font-bold text-gray-800"},"Vendors Management",-1)),e("button",{onClick:s[0]||(s[0]=n=>P()),class:"inline-flex items-center rounded-md bg-gray-800 px-4 py-2 text-xs font-semibold uppercase tracking-widest text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"}," + Add Vendor ")]),e("div",le,[e("div",{class:"flex items-center justify-between mb-3"},[s[10]||(s[10]=e("h3",{class:"text-lg font-bold"},"Vendors",-1)),e("button",{onClick:C,class:"px-3 py-1 border rounded"},"Refresh")]),m.value?(c(),p("div",oe,"Loading…")):(c(),p("div",re,[e("table",ie,[s[12]||(s[12]=e("thead",{class:"text-xs uppercase bg-gray-50 text-gray-500"},[e("tr",null,[e("th",{class:"px-3 py-2"},"#"),e("th",{class:"px-3 py-2"},"Avatar"),e("th",{class:"px-3 py-2"},"Name"),e("th",{class:"px-3 py-2"},"Email"),e("th",{class:"px-3 py-2"},"Phone"),e("th",{class:"px-3 py-2"},"Enabled"),e("th",{class:"px-3 py-2 text-right"},"Actions")])],-1)),e("tbody",null,[(c(!0),p(D,null,F(l.value,n=>(c(),p("tr",{key:n.id,class:"border-b"},[e("td",de,f(n.id),1),e("td",ue,[e("div",ce,[n.profile_image_url?(c(),p("img",{key:0,src:n.profile_image_url,class:"w-full h-full object-cover"},null,8,pe)):(c(),p("span",me,"—"))])]),e("td",fe,f(n.name),1),e("td",ve,f(n.email),1),e("td",_e,f(n.phone||"—"),1),e("td",ge,[e("span",{class:H(n.is_enabled?"text-green-600":"text-gray-400")},f(n.is_enabled?"Yes":"No"),3)]),e("td",xe,[e("button",{class:"text-blue-600 hover:underline",onClick:b=>L(n)},"Edit",8,be),e("button",{class:"text-red-600 hover:underline",onClick:b=>R(n)},"Delete",8,ye)])]))),128)),l.value.length?V("",!0):(c(),p("tr",he,s[11]||(s[11]=[e("td",{colspan:"7",class:"px-3 py-6 text-center text-gray-500"},"No vendors found.",-1)])))])])]))]),u.value?(c(),p("div",we,[e("div",ke,[e("button",{onClick:j,class:"absolute top-3 right-3 text-gray-400 hover:text-gray-600"},"✕"),e("h3",Ve,f(r.value?"Edit Vendor":"Add Vendor"),1),e("form",{onSubmit:J(B,["prevent"])},[e("div",Ce,[e("div",qe,[s[13]||(s[13]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Name",-1)),g(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>a.value.name=n),class:"form-input",type:"text",required:""},null,512),[[h,a.value.name,void 0,{trim:!0}]])]),e("div",null,[s[14]||(s[14]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Email",-1)),g(e("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>a.value.email=n),class:"form-input",type:"email",required:!r.value},null,8,Ae),[[h,a.value.email,void 0,{trim:!0}]])]),e("div",null,[s[15]||(s[15]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Country Code",-1)),g(e("input",{"onUpdate:modelValue":s[3]||(s[3]=n=>a.value.country_code=n),class:"form-input",type:"text",placeholder:"+20",required:!r.value},null,8,je),[[h,a.value.country_code,void 0,{trim:!0}]])]),e("div",null,[s[16]||(s[16]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Phone",-1)),g(e("input",{"onUpdate:modelValue":s[4]||(s[4]=n=>a.value.phone=n),class:"form-input",type:"text",required:!r.value},null,8,Ue),[[h,a.value.phone,void 0,{trim:!0}]])]),e("div",null,[e("label",Ee,f(r.value?"Password (optional)":"Password"),1),g(e("input",{"onUpdate:modelValue":s[5]||(s[5]=n=>a.value.password=n),class:"form-input",type:"password",required:!r.value,minlength:"8"},null,8,Me),[[h,a.value.password]])]),e("div",null,[s[18]||(s[18]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Gender",-1)),g(e("select",{"onUpdate:modelValue":s[6]||(s[6]=n=>a.value.gender=n),class:"form-input",required:!r.value},s[17]||(s[17]=[e("option",{value:"",disabled:""},"Select gender",-1),e("option",{value:"male"},"male",-1),e("option",{value:"female"},"female",-1),e("option",{value:"other"},"other",-1)]),8,$e),[[K,a.value.gender]])]),e("div",null,[s[19]||(s[19]=e("label",{class:"block text-xs text-gray-500 mb-1"},"Country Name",-1)),g(e("input",{"onUpdate:modelValue":s[7]||(s[7]=n=>a.value.country_name=n),class:"form-input",type:"text",placeholder:"Egypt",required:!r.value},null,8,Ne),[[h,a.value.country_name,void 0,{trim:!0}]])]),e("div",De,[g(e("input",{id:"enabled",type:"checkbox","onUpdate:modelValue":s[8]||(s[8]=n=>a.value.is_enabled=n)},null,512),[[Q,a.value.is_enabled]]),s[20]||(s[20]=e("label",{for:"enabled",class:"text-sm"},"Enabled",-1))]),e("div",Fe,[e("label",Se," Profile Image "+f(r.value?"(optional; select to replace)":"(required)"),1),e("input",{type:"file",accept:"image/*",onChange:O,required:!r.value},null,40,Pe),_.value?(c(),p("div",Le,[e("img",{src:_.value,class:"w-32 h-32 object-cover rounded border"},null,8,Oe)])):V("",!0)])]),e("div",Be,[e("button",{disabled:x.value,class:"px-4 py-2 bg-indigo-600 text-white rounded disabled:opacity-60"},f(x.value?"Saving…":r.value?"Update":"Create"),9,Re),e("button",{type:"button",class:"px-3 py-2 border rounded",onClick:j},"Cancel")]),d.value?(c(),p("div",Te,f(d.value),1)):V("",!0),Object.keys(k.value).length?(c(),p("ul",ze,[(c(!0),p(D,null,F(k.value,(n,b)=>(c(),p("li",{key:b},[e("strong",null,f(b)+":",1),W(" "+f(n.join(", ")),1)]))),128))])):V("",!0)],32)])])):V("",!0)])]),_:1}))}},Je=Z(Ie,[["__scopeId","data-v-9a196f6a"]]);export{Je as default};
