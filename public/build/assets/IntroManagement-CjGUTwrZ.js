import{m as x,p as _,q as F,f as l,o as d,a as j,u as L,g as S,w as O,b as e,h,t as p,j as v,k as w,v as T,F as C,s as U,e as B,n as q}from"./app-Bo-3Qt58.js";import{_ as z}from"./AuthenticatedLayout-CgEzs-iN.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";function G(t){try{return typeof t=="string"?JSON.parse(t):t}catch{return t}}function E(t){const s=G(t);return s&&typeof s=="object"?{en:s.en??"",ar:s.ar??""}:{en:s??"",ar:s??""}}function N(t){const s=E(t==null?void 0:t.name),u=E(t==null?void 0:t.description);return{...t,name_en:s.en,name_ar:s.ar,description_en:u.en,description_ar:u.ar,image_url:t!=null&&t.image?`/storage/${t.image}`:"",is_enabled:Number(t==null?void 0:t.is_enabled)===1||(t==null?void 0:t.is_enabled)===!0}}const k={index:async(t={})=>{const{data:s}=await x.get("/api/intro",{params:t});return(Array.isArray(s)?s:(s==null?void 0:s.data)??s??[]).map(N)},edit:async t=>{const{data:s}=await x.get(`/api/intro/edit/${t}`),u=(s==null?void 0:s.data)??s;return N(u)},create:async t=>{const{data:s}=await x.post("/api/intro/create",t,{headers:{"Content-Type":"multipart/form-data"}});return s},update:async(t,s)=>{const{data:u}=await x.post(`/api/intro/update/${t}`,s,{headers:{"Content-Type":"multipart/form-data"}});return u},destroy:async t=>{const{data:s}=await x.delete(`/api/intro/delete/${t}`);return s},publicGetIntro:async()=>{const{data:t}=await x.get("/api/user/get-intro");return(Array.isArray(t)?t:(t==null?void 0:t.data)??t??[]).map(N)}};function P({name:t={en:"",ar:""},description:s={en:"",ar:""},image:u=null,order:c="",is_enabled:m=!0}){const i=new FormData;return i.append("name[en]",t.en??""),i.append("name[ar]",t.ar??""),i.append("description[en]",s.en??""),i.append("description[ar]",s.ar??""),u&&i.append("image",u),c!==""&&c!==null&&c!==void 0&&i.append("order",String(c)),i.append("is_enabled",(m?1:0).toString()),i}const Y={class:"p-6 space-y-6"},H={class:"bg-white p-4 rounded shadow"},K={class:"flex items-center justify-between mb-4"},Q={class:"text-lg font-bold"},W={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},X={class:"flex items-center gap-2"},Z={class:"space-y-2"},ee={key:0,class:"text-sm text-gray-600"},te=["src"],ae={class:"mt-4 flex items-center gap-3"},se=["disabled"],ne={key:0,class:"text-gray-500 text-sm"},re={key:0,class:"mt-3 text-red-600 text-sm"},oe={key:1,class:"mt-2 text-sm text-red-600 list-disc pl-6"},le={class:"bg-white p-5 rounded-2xl shadow-sm ring-1 ring-black/[0.05]"},de={key:0,class:"text-sm text-gray-500"},ie={key:1},ue={key:0},ce={class:"min-w-full border-collapse"},pe={class:"px-4 py-3 align-middle"},ge=["src"],_e={key:1,class:"text-xs text-gray-400 italic"},ye={class:"px-4 py-3 align-middle"},me={class:"font-medium text-gray-900 truncate"},xe={class:"text-gray-500 text-sm truncate",dir:"rtl"},ve={class:"px-4 py-3 align-middle"},be={class:"truncate text-sm text-gray-700"},fe={class:"truncate text-sm text-gray-500",dir:"rtl"},he={class:"px-4 py-3 align-middle text-sm text-gray-600"},we={class:"px-4 py-3 align-middle"},ke={class:"px-4 py-3 align-middle text-center space-x-3"},Ie=["onClick"],Ce=["onClick"],Ne={key:1,class:"text-center text-gray-500 py-8"},Ae={__name:"IntroManagement",setup(t){const s=_([]),u=_(!1),c=_(null),m=_(!1),i=_(""),b=_({}),f=_(null),o=_({name:{en:"",ar:""},description:{en:"",ar:""},image:null,order:"",is_enabled:!0});function A(){c.value=null,o.value={name:{en:"",ar:""},description:{en:"",ar:""},image:null,order:"",is_enabled:!0},f.value=null,i.value="",b.value={}}async function I(){try{u.value=!0,s.value=await k.index()}finally{u.value=!1}}async function M(){var g,a,n,y,V;m.value=!0,i.value="",b.value={};try{const r=P(o.value);c.value?await k.update(c.value,r):await k.create(r),await I(),A()}catch(r){((g=r==null?void 0:r.response)==null?void 0:g.status)===422&&((n=(a=r==null?void 0:r.response)==null?void 0:a.data)!=null&&n.errors)?(b.value=r.response.data.errors,i.value=r.response.data.message||"Validation error"):i.value=((V=(y=r==null?void 0:r.response)==null?void 0:y.data)==null?void 0:V.message)||(r==null?void 0:r.message)||"Request failed"}finally{m.value=!1}}async function D(g){const a=await k.edit(g);c.value=g,o.value={name:{en:a.name_en||"",ar:a.name_ar||""},description:{en:a.description_en||"",ar:a.description_ar||""},order:a.order??"",is_enabled:!!a.is_enabled,image:null},f.value=a.image_url||null}function R(g){var n;const a=(n=g.target.files)==null?void 0:n[0];o.value.image=a||null,f.value=a?URL.createObjectURL(a):null}async function $(g){confirm("Are you sure you want to delete this intro?")&&(await k.destroy(g),await I())}return F(I),(g,a)=>(d(),l(C,null,[j(L(S),{title:"Intro Management"}),j(z,null,{default:O(()=>[e("div",Y,[a[10]||(a[10]=e("h2",{class:"text-2xl font-semibold text-white"},"Intro Management",-1)),e("div",H,[e("div",K,[e("h3",Q,p(c.value?"Edit Intro":"Add New Intro"),1),c.value?(d(),l("button",{key:0,onClick:A,class:"px-3 py-1 border rounded"},"Cancel")):h("",!0)]),e("div",W,[v(e("input",{"onUpdate:modelValue":a[0]||(a[0]=n=>o.value.name.en=n),class:"form-input",type:"text",placeholder:"Name (EN)"},null,512),[[w,o.value.name.en]]),v(e("input",{"onUpdate:modelValue":a[1]||(a[1]=n=>o.value.name.ar=n),class:"form-input",type:"text",placeholder:"الاسم (AR)"},null,512),[[w,o.value.name.ar]]),v(e("textarea",{"onUpdate:modelValue":a[2]||(a[2]=n=>o.value.description.en=n),class:"form-input",type:"text",placeholder:"Description (EN)"},null,512),[[w,o.value.description.en]]),v(e("textarea",{"onUpdate:modelValue":a[3]||(a[3]=n=>o.value.description.ar=n),class:"form-input",type:"text",placeholder:"الوصف (AR)"},null,512),[[w,o.value.description.ar]]),v(e("input",{"onUpdate:modelValue":a[4]||(a[4]=n=>o.value.order=n),class:"form-input",type:"number",placeholder:"Order"},null,512),[[w,o.value.order,void 0,{number:!0}]]),e("label",X,[v(e("input",{type:"checkbox","onUpdate:modelValue":a[5]||(a[5]=n=>o.value.is_enabled=n)},null,512),[[T,o.value.is_enabled]]),a[6]||(a[6]=e("span",null,"Enabled",-1))]),e("div",Z,[e("input",{type:"file",onChange:R,class:"form-input"},null,32),f.value?(d(),l("div",ee,[a[7]||(a[7]=e("span",{class:"block mb-2"},"Image preview:",-1)),e("img",{src:f.value,class:"w-40 h-24 object-cover rounded border"},null,8,te)])):h("",!0)])]),e("div",ae,[e("button",{disabled:m.value,onClick:M,class:"px-4 py-2 bg-green-600 text-white rounded disabled:opacity-60"},p(c.value?"Update Intro":"Add Intro"),9,se),m.value?(d(),l("span",ne,"Saving…")):h("",!0)]),i.value?(d(),l("div",re,p(i.value),1)):h("",!0),Object.keys(b.value).length?(d(),l("ul",oe,[(d(!0),l(C,null,U(b.value,(n,y)=>(d(),l("li",{key:y},[e("strong",null,p(y)+":",1),B(" "+p(n.join(", ")),1)]))),128))])):h("",!0)]),e("div",le,[e("div",{class:"flex items-center justify-between mb-4"},[a[8]||(a[8]=e("h3",{class:"text-lg font-semibold text-gray-800"},"Intro Screens",-1)),e("button",{onClick:I,class:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50"}," Refresh ")]),u.value?(d(),l("div",de,"Loading…")):(d(),l("div",ie,[s.value.length?(d(),l("div",ue,[e("table",ce,[a[9]||(a[9]=e("thead",null,[e("tr",{class:"bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},[e("th",{class:"px-4 py-3 border-b"},"Image"),e("th",{class:"px-4 py-3 border-b"},"Name"),e("th",{class:"px-4 py-3 border-b"},"Description"),e("th",{class:"px-4 py-3 border-b"},"Order"),e("th",{class:"px-4 py-3 border-b"},"Enabled"),e("th",{class:"px-4 py-3 border-b text-center"},"Actions")])],-1)),e("tbody",null,[(d(!0),l(C,null,U(s.value,n=>(d(),l("tr",{key:n.id,class:"hover:bg-gray-50 transition-colors odd:bg-gray-50/50"},[e("td",pe,[n.image_url?(d(),l("img",{key:0,src:n.image_url,class:"w-16 h-10 object-cover rounded border"},null,8,ge)):(d(),l("span",_e,"No image"))]),e("td",ye,[e("div",me,p(n.name_en||"—"),1),e("div",xe,p(n.name_ar||"—"),1)]),e("td",ve,[e("div",be,p(n.description_en||"—"),1),e("div",fe,p(n.description_ar||"—"),1)]),e("td",he,p(n.order??"—"),1),e("td",we,[e("span",{class:q(["px-2 py-0.5 rounded-full text-xs font-medium",n.is_enabled?"bg-green-100 text-green-700":"bg-red-100 text-red-700"])},p(n.is_enabled?"Yes":"No"),3)]),e("td",ke,[e("button",{onClick:y=>D(n.id),class:"text-blue-600 hover:underline text-sm"}," Edit ",8,Ie),e("button",{onClick:y=>$(n.id),class:"text-red-600 hover:underline text-sm"}," Delete ",8,Ce)])]))),128))])])])):(d(),l("div",Ne," No intros found. "))]))])])]),_:1})],64))}},Me=J(Ae,[["__scopeId","data-v-f784895f"]]);export{Me as default};
