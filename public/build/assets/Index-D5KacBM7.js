import{i as ae,p as I,z as se,q as ie,H as W,f as p,o as f,h as U,b as n,t as w,m as D,a as L,u as R,g as Ce,w as F,F as B,s as H,e as O,S as V,K as Ue,d as Pe,j,n as $,k as N,y as Y}from"./app-Bo-3Qt58.js";import{_ as Ie}from"./AuthenticatedLayout-CgEzs-iN.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as $e}from"./vendors-DLUlr4TE.js";function De(e,r,l,d){function o(g){return g instanceof l?g:new l(function(u){u(g)})}return new(l||(l=Promise))(function(g,u){function h(k){try{C(d.next(k))}catch(E){u(E)}}function A(k){try{C(d.throw(k))}catch(E){u(E)}}function C(k){k.done?g(k.value):o(k.value).then(h,A)}C((d=d.apply(e,[])).next())})}function je(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ee,ue;function Le(){return ue||(ue=1,ee=function e(r,l){if(r===l)return!0;if(r&&l&&typeof r=="object"&&typeof l=="object"){if(r.constructor!==l.constructor)return!1;var d,o,g;if(Array.isArray(r)){if(d=r.length,d!=l.length)return!1;for(o=d;o--!==0;)if(!e(r[o],l[o]))return!1;return!0}if(r.constructor===RegExp)return r.source===l.source&&r.flags===l.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===l.valueOf();if(r.toString!==Object.prototype.toString)return r.toString()===l.toString();if(g=Object.keys(r),d=g.length,d!==Object.keys(l).length)return!1;for(o=d;o--!==0;)if(!Object.prototype.hasOwnProperty.call(l,g[o]))return!1;for(o=d;o--!==0;){var u=g[o];if(!e(r[u],l[u]))return!1}return!0}return r!==r&&l!==l}),ee}var Ne=Le(),Oe=je(Ne);const ce="__googleMapsScriptId";var T;(function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.LOADING=1]="LOADING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILURE=3]="FAILURE"})(T||(T={}));class M{constructor({apiKey:r,authReferrerPolicy:l,channel:d,client:o,id:g=ce,language:u,libraries:h=[],mapIds:A,nonce:C,region:k,retries:E=3,url:P="https://maps.googleapis.com/maps/api/js",version:y}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=r,this.authReferrerPolicy=l,this.channel=d,this.client=o,this.id=g||ce,this.language=u,this.libraries=h,this.mapIds=A,this.nonce=C,this.region=k,this.retries=E,this.url=P,this.version=y,M.instance){if(!Oe(this.options,M.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(M.instance.options)}`);return M.instance}M.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?T.FAILURE:this.done?T.SUCCESS:this.loading?T.LOADING:T.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let r=this.url;return r+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(r+=`&key=${this.apiKey}`),this.channel&&(r+=`&channel=${this.channel}`),this.client&&(r+=`&client=${this.client}`),this.libraries.length>0&&(r+=`&libraries=${this.libraries.join(",")}`),this.language&&(r+=`&language=${this.language}`),this.region&&(r+=`&region=${this.region}`),this.version&&(r+=`&v=${this.version}`),this.mapIds&&(r+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(r+=`&auth_referrer_policy=${this.authReferrerPolicy}`),r}deleteScript(){const r=document.getElementById(this.id);r&&r.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((r,l)=>{this.loadCallback(d=>{d?l(d.error):r(window.google)})})}importLibrary(r){return this.execute(),google.maps.importLibrary(r)}loadCallback(r){this.callbacks.push(r),this.execute()}setScript(){var r,l;if(document.getElementById(this.id)){this.callback();return}const d={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(d).forEach(g=>!d[g]&&delete d[g]),!((l=(r=window==null?void 0:window.google)===null||r===void 0?void 0:r.maps)===null||l===void 0)&&l.importLibrary||(g=>{let u,h,A,C="The Google Maps JavaScript API",k="google",E="importLibrary",P="__ib__",y=document,m=window;m=m[k]||(m[k]={});const b=m.maps||(m.maps={}),v=new Set,a=new URLSearchParams,_=()=>u||(u=new Promise((x,c)=>De(this,void 0,void 0,function*(){var S;yield h=y.createElement("script"),h.id=this.id,a.set("libraries",[...v]+"");for(A in g)a.set(A.replace(/[A-Z]/g,K=>"_"+K[0].toLowerCase()),g[A]);a.set("callback",k+".maps."+P),h.src=this.url+"?"+a,b[P]=x,h.onerror=()=>u=c(Error(C+" could not load.")),h.nonce=this.nonce||((S=y.querySelector("script[nonce]"))===null||S===void 0?void 0:S.nonce)||"",y.head.append(h)})));b[E]?console.warn(C+" only loads once. Ignoring:",g):b[E]=(x,...c)=>v.add(x)&&_().then(()=>b[E](x,...c))})(d);const o=this.libraries.map(g=>this.importLibrary(g));o.length||o.push(this.importLibrary("core")),Promise.all(o).then(()=>this.callback(),g=>{const u=new ErrorEvent("error",{error:g});this.loadErrorCallback(u)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(r){if(this.errors.push(r),this.errors.length<=this.retries){const l=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${l} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},l)}else this.onerrorEvent=r,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(r=>{r(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}const Re={class:"space-y-2"},Fe={key:0,class:"block text-xs text-gray-500"},Me={class:"flex gap-2"},Ve=["placeholder"],Te={__name:"MapPicker",props:{label:{type:String,default:"Select location"},searchPlaceholder:{type:String,default:"Search placeâ€¦"},lat:{type:[Number,String],default:null},lng:{type:[Number,String],default:null},address:{type:String,default:""},fallbackCenter:{type:Object,default:()=>({lat:30.0444,lng:31.2357})},zoom:{type:Number,default:13},apiKey:{type:String,default:"AIzaSyD6l04ETuUP7BfQ7MqpL2vMWEalLxNj0d4"}},emits:["update:lat","update:lng","update:address"],setup(e,{emit:r}){const l=e,d=r,o=a=>{if(typeof a=="number")return Number.isFinite(a)?a:null;if(a===""||a==null)return null;const _=Number(a);return Number.isFinite(_)?_:null};ae(()=>{const a=o(l.lat);return a==null?"-":a.toFixed(6)}),ae(()=>{const a=o(l.lng);return a==null?"-":a.toFixed(6)});const g=I(null),u=I(null);let h,A,C,k,E=null;function P({lat:a,lng:_,address:x}){a!=null&&d("update:lat",a),_!=null&&d("update:lng",_),x!==void 0&&d("update:address",x)}function y(a,_){return new Promise(x=>{if(!k)return x("");k.geocode({location:{lat:a,lng:_}},(c,S)=>{S==="OK"&&c&&c.length?x(c[0].formatted_address||""):x("")})})}async function m(){try{E=await new M({apiKey:l.apiKey,version:"weekly",libraries:["places"]}).load()}catch(c){console.error("Google Maps failed to load:",c);return}k=new E.maps.Geocoder;const a=o(l.lat),_=o(l.lng),x=a!=null&&_!=null?{lat:a,lng:_}:l.fallbackCenter;h=new E.maps.Map(g.value,{center:x,zoom:l.zoom,mapTypeControl:!1,streetViewControl:!1}),A=new E.maps.Marker({position:x,map:h,draggable:!0}),h.addListener("click",c=>{const S=c.latLng;b(S.lat(),S.lng(),!0)}),A.addListener("dragend",()=>{const c=A.getPosition();b(c.lat(),c.lng(),!0)});try{C=new E.maps.places.Autocomplete(u.value,{fields:["geometry","formatted_address","name"]}),C.addListener("place_changed",()=>{var J;const c=C.getPlace();if(!((J=c==null?void 0:c.geometry)!=null&&J.location))return;const S=c.geometry.location;h.panTo(S),h.setZoom(15);const K=c.formatted_address||c.name||"";b(S.lat(),S.lng(),!1,K)})}catch{}if(a!=null&&_!=null&&!l.address){const c=await y(a,_);P({address:c||""})}}async function b(a,_,x=!0,c=""){if(!(!A||!h)){if(A.setPosition({lat:a,lng:_}),h.panTo({lat:a,lng:_}),P({lat:a,lng:_}),c)P({address:c});else if(x){const S=await y(a,_);P({address:S||""})}}}se(()=>[l.lat,l.lng],([a,_])=>{if(!h)return;const x=o(a),c=o(_);x==null||c==null||(A.setPosition({lat:x,lng:c}),h.panTo({lat:x,lng:c}))});function v(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(a=>{const{latitude:_,longitude:x}=a.coords;b(_,x,!0),h&&h.setZoom(15)},()=>{},{enableHighAccuracy:!0,timeout:8e3})}return ie(async()=>{await W(),await m()}),(a,_)=>(f(),p("div",Re,[e.label?(f(),p("label",Fe,w(e.label),1)):U("",!0),n("div",Me,[n("input",{ref_key:"searchEl",ref:u,type:"text",class:"form-input flex-1",placeholder:e.searchPlaceholder},null,8,Ve),n("button",{type:"button",class:"px-3 py-2 border rounded",onClick:v},"ðŸ“")]),n("div",{ref_key:"mapEl",ref:g,class:"rounded border",style:{height:"320px"}},null,512)]))}},Ke=me(Te,[["__scopeId","data-v-c24049d5"]]);function Ge(e){try{return typeof e=="string"?JSON.parse(e):e}catch{return e}}function pe(e){const r=Ge(e);return r&&typeof r=="object"?{en:r.en??"",ar:r.ar??""}:{en:r??"",ar:r??""}}function te(e){var r;return Array.isArray(e)?e:Array.isArray(e==null?void 0:e.data)?e.data:Array.isArray(e==null?void 0:e.message)?e.message:Array.isArray((r=e==null?void 0:e.data)==null?void 0:r.data)?e.data.data:[]}function ze(e){return(e==null?void 0:e.data)??(e==null?void 0:e.message)??e}function re(e){return e?`/storage/${e}`:""}function fe(e){return e?String(e).slice(0,10):""}function Q(e={}){const r=pe(e.name),l=pe(e.description),d=Array.isArray(e.home_unit_gallery)?e.home_unit_gallery.map(o=>({id:o.id??void 0,image:o.image,image_url:re(o.image)})):Array.isArray(e.gallery)?e.gallery.map(o=>({id:o.id??void 0,image:o.image,image_url:re(o.image)})):[];return{...e,name_en:r.en,name_ar:r.ar,description_en:l.en,description_ar:l.ar,location:e.location??"",lat:e.lat??null,long:e.long??null,start_date:fe(e.start_date),end_date:fe(e.end_date),status:e.status??"",user_id:e.user_id??null,vendor_id:e.vendor_id??null,cover_image_url:re(e.cover_image),gallery:d}}const Z={list:async(e={})=>{const{data:r}=await D.get("/api/units",{params:e});return te(r).map(Q)},listByUser:async(e,r={})=>{const{data:l}=await D.get(`/api/units/user/${e}`,{params:r});return te(l).map(Q)},listByVendor:async(e,r={})=>{const{data:l}=await D.get(`/api/units/vendor/${e}`,{params:r});return te(l).map(Q)},show:async e=>{const{data:r}=await D.get(`/api/units/show/${e}`);return Q(ze(r))},create:async e=>{const{data:r}=await D.post("/api/units/create",e,{headers:{"Content-Type":"multipart/form-data"}});return r},update:async(e,r)=>{const{data:l}=await D.post(`/api/units/update/${e}`,r,{headers:{"Content-Type":"multipart/form-data"}});return l},remove:async e=>{const{data:r}=await D.delete(`/api/units/delete/${e}`);return r}};function Be({name:e={en:"",ar:""},description:r={en:"",ar:""},location:l,lat:d,long:o,start_date:g,end_date:u,cover_image:h,gallery:A=[],user_id:C,vendor_id:k,status:E,...P}){const y=new FormData;return y.append("name[en]",e.en??""),y.append("name[ar]",e.ar??""),y.append("description[en]",r.en??""),y.append("description[ar]",r.ar??""),y.append("location",l??""),y.append("lat",String(d??"")),y.append("long",String(o??"")),y.append("start_date",g??""),y.append("end_date",u??""),h&&y.append("cover_image",h),(A||[]).forEach((m,b)=>{m&&y.append(`gallery[${b}]`,m)}),y.append("user_id",String(C??"")),y.append("vendor_id",String(k??"")),E&&y.append("status",E),Object.entries(P).forEach(([m,b])=>{b!=null&&b!==""&&y.append(m,b)}),y}function Ze(e={}){const{name:r,description:l,location:d,lat:o,long:g,start_date:u,end_date:h,cover_image:A,gallery:C,user_id:k,vendor_id:E,status:P,...y}=e,m=new FormData;return r&&(r.en!==void 0&&m.append("name[en]",r.en??""),r.ar!==void 0&&m.append("name[ar]",r.ar??"")),l&&(l.en!==void 0&&m.append("description[en]",l.en??""),l.ar!==void 0&&m.append("description[ar]",l.ar??"")),d!==void 0&&m.append("location",d??""),o!==void 0&&m.append("lat",String(o??"")),g!==void 0&&m.append("long",String(g??"")),u!==void 0&&m.append("start_date",u??""),h!==void 0&&m.append("end_date",h??""),A&&m.append("cover_image",A),Array.isArray(C)&&C.length&&C.forEach((b,v)=>{b&&m.append(`gallery[${v}]`,b)}),k!==void 0&&m.append("user_id",String(k??"")),E!==void 0&&m.append("vendor_id",String(E??"")),P!==void 0&&P!==""&&m.append("status",P),Object.entries(y).forEach(([b,v])=>{v!=null&&v!==""&&m.append(b,v)}),m}function Je(e){return e===!0||e===1||e==="1"}function ne(e={}){const r=e.profile_image||e.profileImage||null;return{id:e.id,name:e.name||"",email:e.email||"",phone:e.phone||"",gender:e.gender||"",country_code:e.country_code||"",country_name:e.country_name||"",role:e.role||"user",is_enabled:Je(e.is_enabled),profile_image:r,profile_image_url:r?`/storage/${r}`:null,created_at:e.created_at,updated_at:e.updated_at}}function He(e){return Array.isArray(e)?e:Array.isArray(e==null?void 0:e.data)?e.data:Array.isArray(e==null?void 0:e.message)?e.message:[]}function ge(e){return(e==null?void 0:e.data)??e}const Qe={list:async()=>{const{data:e}=await D.get("/api/users");return He(e).map(ne)},show:async e=>{const{data:r}=await D.get(`/api/users/show/${e}`);return ne(ge(r))},edit:async e=>{const{data:r}=await D.get(`/api/users/edit/${e}`);return ne(ge(r))},create:async e=>{const{data:r}=await D.post("/api/users/create",e,{headers:{"Content-Type":"multipart/form-data"}});return r},update:async(e,r)=>{const l=typeof FormData<"u"&&r instanceof FormData,{data:d}=await D.post(`/api/users/update/${e}`,r,{headers:l?{"Content-Type":"multipart/form-data"}:void 0});return d},remove:async e=>{const{data:r}=await D.delete(`/api/users/delete/${e}`);return r}},We={class:"p-6 space-y-6"},Xe={class:"bg-white p-5 rounded-2xl shadow-sm ring-1 ring-black/[0.05]"},Ye={key:0,class:"text-sm text-gray-500"},et={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-5"},tt={class:"relative aspect-[4/3] bg-gray-50"},rt=["src"],nt={key:1,class:"absolute inset-0 flex items-center justify-center text-gray-400 text-sm"},at={class:"absolute top-2 left-2 flex flex-wrap gap-2"},st={class:"inline-flex items-center rounded-full bg-white/90 backdrop-blur px-2 py-0.5 text-[11px] font-medium text-gray-700 border border-gray-200"},it={class:"inline-flex items-center rounded-full bg-white/90 backdrop-blur px-2 py-0.5 text-[11px] font-medium text-gray-700 border border-gray-200"},lt={class:"p-3.5 space-y-3"},ot={class:"text-sm font-semibold text-gray-900 whitespace-pre-wrap break-words"},dt={key:0,class:"text-gray-400"},ut={dir:"rtl"},ct={class:"text-xs text-gray-500"},pt={class:"grid grid-cols-3 gap-2 pt-2 text-xs"},ft={class:"flex gap-2 pt-3"},gt=["onClick"],mt=["onClick"],vt={key:0,class:"col-span-full text-center text-gray-500 py-8"},ht={class:"relative mx-auto w-full max-w-3xl p-4 sm:p-6 h-full flex items-center justify-center"},yt={class:"bg-white rounded-2xl shadow-lg w-full max-h-[min(88vh,900px)] overflow-y-auto focus:outline-none",role:"dialog","aria-modal":"true"},_t={class:"sticky top-0 z-10 bg-white border-b rounded-t-2xl"},bt={class:"flex items-center justify-between px-5 py-3"},xt={class:"text-lg font-bold"},wt={class:"px-5 py-4 space-y-4"},kt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Et=["required"],St={key:0,class:"mt-1 text-xs text-red-600"},At=["required"],qt={key:0,class:"mt-1 text-xs text-red-600"},Ct={class:"md:col-span-2"},Ut=["required"],Pt={key:0,class:"mt-1 text-xs text-red-600"},It={class:"md:col-span-2"},$t=["required"],Dt={key:0,class:"mt-1 text-xs text-red-600"},jt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Lt={class:"md:col-span-2"},Nt=["required"],Ot={key:0,class:"mt-1 text-xs text-red-600"},Rt=["required"],Ft={key:0,class:"mt-1 text-xs text-red-600"},Mt=["required"],Vt={key:0,class:"mt-1 text-xs text-red-600"},Tt=["required"],Kt={key:0,class:"mt-1 text-xs text-red-600"},Gt=["required"],zt={key:0,class:"mt-1 text-xs text-red-600"},Bt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Zt=["required"],Jt=["value"],Ht={key:0,class:"mt-1 text-xs text-red-600"},Qt=["required"],Wt=["value"],Xt={key:0,class:"mt-1 text-xs text-red-600"},Yt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},er={class:"block text-xs text-gray-500 mb-1"},tr=["required"],rr={key:0,class:"mt-1 text-xs text-red-600"},nr={key:1,class:"mt-2"},ar=["src"],sr=["required"],ir={key:0,class:"mt-1 text-xs text-red-600"},lr={key:1,class:"mt-2 flex flex-wrap gap-2"},or=["src"],dr={key:0,class:"rounded border border-red-200 bg-red-50 text-red-700 px-3 py-2"},ur={class:"sticky bottom-0 z-10 bg-white border-t rounded-b-2xl"},cr={class:"px-5 py-3 flex items-center gap-3"},pr=["disabled"],fr={__name:"Index",setup(e){const r=ae(()=>!v.value),l=I({}),d=(i,t)=>{if(!t||Array.isArray(t)&&t.length===0){delete l.value[i];return}l.value[i]=Array.isArray(t)?t:[String(t)]},o=i=>{var t;return((t=l.value[i])==null?void 0:t[0])||""},g=i=>!!l.value[i],u=i=>["form-input",g(i)?"border-red-400 focus:ring-red-500":""];function h(){const i=document.querySelector(".max-h-\\[min\\(88vh\\,900px\\)\\]"),t=i==null?void 0:i.querySelector("input.border-red-400, select.border-red-400, textarea.border-red-400");t&&t.scrollIntoView({behavior:"smooth",block:"center"})}function A(){l.value={},S.value="";const i=a.value,t=s=>s!=null&&String(s).trim()!=="";return r.value?(t(i.name.en)||d("name.en","Name (EN) is required"),t(i.name.ar)||d("name.ar","Name (AR) is required"),t(i.description.en)||d("description.en","Description (EN) is required"),t(i.description.ar)||d("description.ar","Description (AR) is required"),t(i.location)||d("location","Location is required"),typeof i.lat=="number"&&i.lat>=-90&&i.lat<=90||d("lat","Latitude must be between -90 and 90"),typeof i.long=="number"&&i.long>=-180&&i.long<=180||d("long","Longitude must be between -180 and 180"),t(i.start_date)||d("start_date","Start date is required"),t(i.end_date)||d("end_date","End date is required"),t(i.start_date)&&t(i.end_date)&&new Date(i.end_date)<new Date(i.start_date)&&d("end_date","End date must be after or equal to start date"),t(i.user_id)||d("user_id","User is required"),t(i.vendor_id)||d("vendor_id","Vendor is required"),i.cover_image||d("cover_image","Cover image is required"),(!Array.isArray(i.gallery)||i.gallery.length===0)&&d("gallery","Add at least one gallery image")):(i.lat!==null&&(i.lat<-90||i.lat>90)&&d("lat","Latitude must be between -90 and 90"),i.long!==null&&(i.long<-180||i.long>180)&&d("long","Longitude must be between -180 and 180"),t(i.start_date)&&t(i.end_date)&&new Date(i.end_date)<new Date(i.start_date)&&d("end_date","End date must be after or equal to start date")),Object.keys(l.value).length?(S.value="Please fix the highlighted fields.",!1):!0}function C(i){var s,q,X,de;const t=(q=(s=i==null?void 0:i.response)==null?void 0:s.data)==null?void 0:q.errors;if(!t)return!1;l.value={};for(const[Ae,qe]of Object.entries(t))d(Ae,qe);return S.value=((de=(X=i==null?void 0:i.response)==null?void 0:X.data)==null?void 0:de.message)||"Validation failed. Please review the fields below.",!0}const k=I([]),E=I([]);async function P(){const i=await Qe.list();k.value=i.map(s=>({id:s.id,name:s.name,email:s.email}));const t=await $e.list();E.value=t.map(s=>({id:s.id,name:s.name,email:s.email}))}ie(async()=>{await Promise.all([z(),P()])});const y=I([]),m=I(!1),b=I(!1),v=I(null),a=I({name:{en:"",ar:""},description:{en:"",ar:""},location:"",lat:null,long:null,start_date:"",end_date:"",user_id:null,vendor_id:null,status:"",cover_image:null,gallery:[]}),_=I(null),x=I([]),c=I(!1),S=I(""),K=I({});function J(i){return`/units-management/${i}/docs`}function ve(i){return`/units-management/${i}/drawing`}function he(i){return`/units-management/${i}/gallery`}function ye(i){return`/units-management/${i}/timeline`}function _e(i){return`/units-management/${i}/reports`}function be(i){return`/units-management/${i}/phases`}function le(){a.value={name:{en:"",ar:""},description:{en:"",ar:""},location:"",lat:null,long:null,start_date:"",end_date:"",user_id:null,vendor_id:null,status:"under_construction",cover_image:null,gallery:[]},_.value=null,x.value=[],S.value="",K.value={},v.value=null}function xe(){le(),b.value=!0}async function we(i){le(),v.value=i.id;const t=await Z.show(i.id);a.value.name.en=t.name_en||"",a.value.name.ar=t.name_ar||"",a.value.description.en=t.description_en||"",a.value.description.ar=t.description_ar||"",a.value.location=t.location||"",a.value.lat=t.lat,a.value.long=t.long,a.value.start_date=t.start_date||"",a.value.end_date=t.end_date||"",a.value.user_id=t.user_id??null,a.value.vendor_id=t.vendor_id??null,a.value.status=t.status||"",_.value=t.cover_image_url||null,Array.isArray(t.gallery)&&(x.value=t.gallery.map(s=>s.image_url),a.value.gallery=[]),b.value=!0}se(()=>b.value,async i=>{i&&await W()}),se(()=>b.value,i=>{document.body.style.overflow=i?"hidden":""});function G(){b.value=!1}function ke(i){var s;const t=((s=i.target.files)==null?void 0:s[0])||null;a.value.cover_image=t,_.value=t?URL.createObjectURL(t):_.value}function Ee(i){const t=Array.from(i.target.files||[]);a.value.gallery=t,x.value=t.map(s=>URL.createObjectURL(s))}async function z(){m.value=!0;try{y.value=await Z.list()}finally{m.value=!1}}async function oe(){var i,t,s;c.value=!0;try{if(!A()){await W(),h();return}if(v.value){const q=Ze(a.value);await Z.update(v.value,q)}else{const q=Be(a.value);await Z.create(q)}await z(),G()}catch(q){((i=q==null?void 0:q.response)==null?void 0:i.status)===422&&C(q)?(await W(),h()):S.value=((s=(t=q==null?void 0:q.response)==null?void 0:t.data)==null?void 0:s.message)||(q==null?void 0:q.message)||"Request failed"}finally{c.value=!1}}async function Se(i){confirm(`Delete unit #${i.id}?`)&&(await Z.remove(i.id),await z())}return ie(z),(i,t)=>(f(),p(B,null,[L(R(Ce),{title:"Units"}),L(Ie,null,{default:F(()=>[n("div",We,[n("div",{class:"flex items-center justify-between"},[t[15]||(t[15]=n("h2",{class:"text-2xl font-bold text-white"},"Units",-1)),n("button",{onClick:xe,class:"px-3 py-1 border rounded text-white hover:bg-gray-700"}," + Add Unit ")]),n("div",Xe,[n("div",{class:"flex items-center justify-between mb-4"},[t[16]||(t[16]=n("h3",{class:"text-lg font-semibold text-gray-800"},"All Units",-1)),n("button",{onClick:z,class:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50"}," Refresh ")]),m.value?(f(),p("div",Ye,"Loadingâ€¦")):(f(),p("div",et,[(f(!0),p(B,null,H(y.value,s=>(f(),p("div",{key:s.id,class:"group rounded-2xl overflow-hidden bg-white border border-gray-200/70 shadow-[0_1px_2px_rgba(0,0,0,0.04)] hover:shadow-[0_8px_24px_rgba(0,0,0,0.08)] hover:-translate-y-0.5 transition-all duration-200"},[n("div",tt,[s.cover_image_url?(f(),p("img",{key:0,src:s.cover_image_url,class:"absolute inset-0 w-full h-full object-cover",alt:""},null,8,rt)):(f(),p("div",nt," No Cover ")),t[17]||(t[17]=n("div",{class:"pointer-events-none absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-transparent"},null,-1)),n("div",at,[n("span",st,w(s.status||"â€”"),1),n("span",it,w(s.location||"No location"),1)])]),n("div",lt,[n("div",ot,[O(w(s.name_en||"â€”")+" ",1),s.name_ar?(f(),p("span",dt," / ")):U("",!0),n("span",ut,w(s.name_ar),1)]),n("div",ct,[t[18]||(t[18]=n("span",{class:"font-medium"},"Period:",-1)),O(" "+w(s.start_date||"â€”")+" â†’ "+w(s.end_date||"â€”"),1)]),n("div",pt,[L(R(V),{href:J(s.id),class:"px-2 py-1.5 rounded-lg border text-center hover:bg-gray-50"},{default:F(()=>t[19]||(t[19]=[O(" Docs ")])),_:2},1032,["href"]),L(R(V),{href:he(s.id),class:"px-2 py-1.5 rounded-lg border text-center hover:bg-gray-50"},{default:F(()=>t[20]||(t[20]=[O(" Gallery ")])),_:2},1032,["href"]),L(R(V),{href:ve(s.id),class:"px-2 py-1.5 rounded-lg border text-center hover:bg-gray-50"},{default:F(()=>t[21]||(t[21]=[O(" Drawing ")])),_:2},1032,["href"]),L(R(V),{href:_e(s.id),class:"px-2 py-1.5 rounded-lg border text-center hover:bg-gray-50"},{default:F(()=>t[22]||(t[22]=[O(" Reports ")])),_:2},1032,["href"]),L(R(V),{href:be(s.id),class:"px-2 py-1.5 rounded-lg border text-center hover:bg-gray-50"},{default:F(()=>t[23]||(t[23]=[O(" Phases ")])),_:2},1032,["href"]),L(R(V),{href:ye(s.id),class:"px-2 py-1.5 rounded-lg border text-center hover:bg-gray-50"},{default:F(()=>t[24]||(t[24]=[O(" Timeline ")])),_:2},1032,["href"])]),n("div",ft,[n("button",{class:"px-3 py-1.5 text-sm rounded-lg border border-gray-300 bg-white hover:bg-gray-50",onClick:q=>we(s)}," Edit ",8,gt),n("button",{class:"px-3 py-1.5 text-sm rounded-lg border border-red-200 text-red-700 bg-red-50 hover:bg-red-100",onClick:q=>Se(s)}," Delete ",8,mt)])])]))),128)),y.value.length?U("",!0):(f(),p("div",vt," No units found. "))]))]),b.value?(f(),p("div",{key:0,class:"fixed inset-0 z-50",onKeydown:Ue(G,["esc"])},[n("div",{class:"absolute inset-0 bg-black/40",onClick:G,"aria-hidden":"true"}),n("div",ht,[n("div",yt,[n("div",_t,[n("div",bt,[n("h3",xt,w(v.value?"Edit Unit":"Add Unit"),1),n("button",{onClick:G,class:"text-gray-400 hover:text-gray-600","aria-label":"Close"}," âœ• ")])]),n("div",wt,[n("form",{onSubmit:Pe(oe,["prevent"]),class:"space-y-4"},[n("div",kt,[n("div",null,[t[25]||(t[25]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Name (EN)*",-1)),j(n("input",{class:$(u("name.en")),"onUpdate:modelValue":t[0]||(t[0]=s=>a.value.name.en=s),type:"text",required:!v.value},null,10,Et),[[N,a.value.name.en]]),o("name.en")?(f(),p("p",St,w(o("name.en")),1)):U("",!0)]),n("div",null,[t[26]||(t[26]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Name (AR)*",-1)),j(n("input",{class:$(u("name.ar")),"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.name.ar=s),type:"text",required:!v.value},null,10,At),[[N,a.value.name.ar]]),o("name.ar")?(f(),p("p",qt,w(o("name.ar")),1)):U("",!0)]),n("div",Ct,[t[27]||(t[27]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Description (EN)*",-1)),j(n("textarea",{class:$(u("description.en")),"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.description.en=s),type:"text",required:!v.value},null,10,Ut),[[N,a.value.description.en]]),o("description.en")?(f(),p("p",Pt,w(o("description.en")),1)):U("",!0)]),n("div",It,[t[28]||(t[28]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Description (AR)*",-1)),j(n("textarea",{class:$(u("description.ar")),"onUpdate:modelValue":t[3]||(t[3]=s=>a.value.description.ar=s),type:"text",required:!v.value},null,10,$t),[[N,a.value.description.ar]]),o("description.ar")?(f(),p("p",Dt,w(o("description.ar")),1)):U("",!0)])]),n("div",jt,[n("div",Lt,[L(Ke,{label:"Pick on map",lat:a.value.lat,"onUpdate:lat":t[4]||(t[4]=s=>a.value.lat=s),lng:a.value.long,"onUpdate:lng":t[5]||(t[5]=s=>a.value.long=s),address:a.value.location,"onUpdate:address":t[6]||(t[6]=s=>a.value.location=s)},null,8,["lat","lng","address"])]),n("div",null,[t[29]||(t[29]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Location*",-1)),j(n("input",{class:$(u("location")),"onUpdate:modelValue":t[7]||(t[7]=s=>a.value.location=s),type:"text",required:!v.value,disabled:""},null,10,Nt),[[N,a.value.location]]),o("location")?(f(),p("p",Ot,w(o("location")),1)):U("",!0)]),n("div",null,[t[30]||(t[30]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Latitude (-90..90)*",-1)),j(n("input",{class:$(u("lat")),"onUpdate:modelValue":t[8]||(t[8]=s=>a.value.lat=s),type:"number",step:"any",min:"-90",max:"90",required:!v.value,disabled:""},null,10,Rt),[[N,a.value.lat,void 0,{number:!0}]]),o("lat")?(f(),p("p",Ft,w(o("lat")),1)):U("",!0)]),n("div",null,[t[31]||(t[31]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Longitude (-180..180)*",-1)),j(n("input",{class:$(u("long")),"onUpdate:modelValue":t[9]||(t[9]=s=>a.value.long=s),type:"number",step:"any",min:"-180",max:"180",required:!v.value,disabled:""},null,10,Mt),[[N,a.value.long,void 0,{number:!0}]]),o("long")?(f(),p("p",Vt,w(o("long")),1)):U("",!0)]),n("div",null,[t[32]||(t[32]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Start Date*",-1)),j(n("input",{class:$(u("start_date")),"onUpdate:modelValue":t[10]||(t[10]=s=>a.value.start_date=s),type:"date",required:!v.value},null,10,Tt),[[N,a.value.start_date]]),o("start_date")?(f(),p("p",Kt,w(o("start_date")),1)):U("",!0)]),n("div",null,[t[33]||(t[33]=n("label",{class:"block text-xs text-gray-500 mb-1"},"End Date*",-1)),j(n("input",{class:$(u("end_date")),"onUpdate:modelValue":t[11]||(t[11]=s=>a.value.end_date=s),type:"date",required:!v.value},null,10,Gt),[[N,a.value.end_date]]),o("end_date")?(f(),p("p",zt,w(o("end_date")),1)):U("",!0)])]),n("div",Bt,[n("div",null,[t[35]||(t[35]=n("label",{class:"block text-xs text-gray-500 mb-1"},"User *",-1)),j(n("select",{class:$(u("user_id")),"onUpdate:modelValue":t[12]||(t[12]=s=>a.value.user_id=s),required:!v.value},[t[34]||(t[34]=n("option",{value:"",disabled:""},"Select a user",-1)),(f(!0),p(B,null,H(k.value,s=>(f(),p("option",{key:s.id,value:s.id},w(s.name)+" â€” "+w(s.email),9,Jt))),128))],10,Zt),[[Y,a.value.user_id,void 0,{number:!0}]]),o("user_id")?(f(),p("p",Ht,w(o("user_id")),1)):U("",!0)]),n("div",null,[t[37]||(t[37]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Project Manager *",-1)),j(n("select",{class:$(u("vendor_id")),"onUpdate:modelValue":t[13]||(t[13]=s=>a.value.vendor_id=s),required:!v.value},[t[36]||(t[36]=n("option",{value:"",disabled:""},"Select a Project Manager",-1)),(f(!0),p(B,null,H(E.value,s=>(f(),p("option",{key:s.id,value:s.id},w(s.name)+" â€” "+w(s.email),9,Wt))),128))],10,Qt),[[Y,a.value.vendor_id,void 0,{number:!0}]]),o("vendor_id")?(f(),p("p",Xt,w(o("vendor_id")),1)):U("",!0)]),n("div",null,[t[39]||(t[39]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Status",-1)),j(n("select",{class:"form-input","onUpdate:modelValue":t[14]||(t[14]=s=>a.value.status=s)},t[38]||(t[38]=[n("option",{value:"under_construction",selected:""},"under_construction",-1),n("option",{value:"completed"},"completed",-1)]),512),[[Y,a.value.status]])])]),n("div",Yt,[n("div",null,[n("label",er," Cover Image* "+w(v.value?"(optional to replace)":""),1),n("input",{class:$(u("cover_image")),type:"file",accept:"image/*",onChange:ke,required:!v.value},null,42,tr),o("cover_image")?(f(),p("p",rr,w(o("cover_image")),1)):U("",!0),_.value?(f(),p("div",nr,[n("img",{src:_.value,class:"w-40 h-28 object-cover rounded border"},null,8,ar)])):U("",!0)]),n("div",null,[t[40]||(t[40]=n("label",{class:"block text-xs text-gray-500 mb-1"},"Gallery* (multiple on create)",-1)),n("input",{class:$(u("gallery")),type:"file",accept:"image/*",multiple:"",onChange:Ee,required:!v.value},null,42,sr),o("gallery")?(f(),p("p",ir,w(o("gallery")),1)):U("",!0),x.value.length?(f(),p("div",lr,[(f(!0),p(B,null,H(x.value,(s,q)=>(f(),p("img",{key:q,src:s,class:"w-24 h-16 object-cover rounded border"},null,8,or))),128))])):U("",!0)])]),S.value?(f(),p("div",dr,w(S.value),1)):U("",!0)],32)]),n("div",ur,[n("div",cr,[n("button",{disabled:c.value,class:"px-4 py-2 bg-indigo-600 text-white rounded disabled:opacity-60",onClick:oe},w(c.value?"Savingâ€¦":v.value?"Update":"Create"),9,pr),n("button",{type:"button",class:"px-3 py-2 border rounded",onClick:G},"Cancel")])])])])],32)):U("",!0)])]),_:1})],64))}},yr=me(fr,[["__scopeId","data-v-e0a1659a"]]);export{yr as default};
