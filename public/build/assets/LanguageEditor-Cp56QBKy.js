import{p as r,i as L,q as $,A,B,f as i,o as u,a as S,u as D,g as F,w as M,b as s,h as V,j as b,t as p,F as m,s as C,y as U,k as O,C as q}from"./app-F6bKQEA1.js";import{_ as z}from"./AuthenticatedLayout-BX6gmCjd.js";import{h as E}from"./http-CdqPvgFv.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const I={class:"p-6 space-y-6"},P={class:"flex justify-between items-center"},W={class:"text-2xl font-semibold text-dash-title"},G=["value"],H={key:0,class:"p-3 bg-red-50 text-red-600 rounded"},J={key:1,class:"text-sm text-gray-500"},K={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Q={class:"block text-sm font-medium text-gray-600 mb-1"},R=["onUpdate:modelValue"],X={class:"text-right pt-4"},Y=["disabled"],se={__name:"LanguageEditor",props:{id:[Number,String],type:String},setup(T){const _=T,g=_.id,o=r(_.type||"panel"),d=r({}),v=r(!1),f=r(!1),c=r(""),h=r(!1);let n=null;const x=[{type:"panel",label:"Admin Panel"},{type:"app",label:"User App"},{type:"vendor",label:"Vendor Dashboard"},{type:"web",label:"Website"}],j=L(()=>{const t=x.find(l=>l.type===o.value);return t?t.label:"Language"}),w=L(()=>Object.keys(d.value??{}));async function k(){var t,l,a;if(!g){c.value="Missing language ID.";return}if(n)try{n.abort()}catch{}n=new AbortController,v.value=!0,c.value="";try{const e=await E.get(`/api/language/languageedit/${g}/${o.value}`,{signal:n.signal});if(!e||!e.data||e.data.status!=="success"){console.warn("Non-success response, keeping previous translations");return}const y=(l=(t=e.data)==null?void 0:t.data)==null?void 0:l.enLabels;y&&typeof y=="object"&&Object.keys(y).length>0?d.value=y:console.warn("Empty/invalid enLabels; keeping previous translations")}catch(e){(e==null?void 0:e.name)==="CanceledError"||(a=e==null?void 0:e.message)!=null&&a.includes("canceled")||(console.error(e),c.value="Failed to load language data.")}finally{n&&!n.signal.aborted&&(v.value=!1,n=null)}}async function N(){if(g){f.value=!0;try{await E.post(`/api/language/updatelanguageValues/${g}/${o.value}`,{values:d.value}),alert("Translations updated successfully.")}catch(t){console.error(t),alert("Save failed.")}finally{f.value=!1}}}return $(async()=>{await A(),await k(),h.value=!0}),B(o,async(t,l)=>{h.value&&t!==l&&await k()}),(t,l)=>(u(),i(m,null,[S(D(F),{title:"Language Editor"}),S(z,null,{default:M(()=>[s("div",I,[s("div",P,[s("h2",W," Translate "+p(j.value)+" Language File ",1),b(s("select",{"onUpdate:modelValue":l[0]||(l[0]=a=>o.value=a),class:"border border-gray-300 rounded px-3 py-1 text-sm"},[(u(),i(m,null,C(x,a=>s("option",{key:a.type,value:a.type},p(a.label),9,G)),64))],512),[[U,o.value]])]),c.value?(u(),i("div",H,p(c.value),1)):V("",!0),v.value?(u(),i("div",J,"Loading…")):V("",!0),b(s("div",K,[(u(!0),i(m,null,C(w.value,a=>(u(),i("div",{key:a},[s("label",Q,p(a),1),b(s("input",{"onUpdate:modelValue":e=>d.value[a]=e,type:"text",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter translation"},null,8,R),[[O,d.value[a]]])]))),128))],512),[[q,w.value.length]]),s("div",X,[s("button",{disabled:f.value||v.value,onClick:N,class:"bg-black text-white px-3 py-2 rounded hover:bg-gray-700 disabled:opacity-50"},p(f.value?"Saving…":"Save"),9,Y)])])]),_:1})],64))}};export{se as default};
