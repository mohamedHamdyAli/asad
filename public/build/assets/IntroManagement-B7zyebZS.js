import{m as w,p as _,i as P,q as G,f as o,o as l,a as F,u as H,g as Q,w as W,b as e,h as v,F as R,s as X,t as u,n as m,e as Y,z as Z,d as ee,j as k,k as E,v as te}from"./app-ClThdbk1.js";import{_ as se}from"./AuthenticatedLayout-CMtBQwfm.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";function ne(t){try{return typeof t=="string"?JSON.parse(t):t}catch{return t}}function $(t){const a=ne(t);return a&&typeof a=="object"?{en:a.en??"",ar:a.ar??""}:{en:a??"",ar:a??""}}function M(t){const a=$(t==null?void 0:t.name),c=$(t==null?void 0:t.description);return{...t,name_en:a.en,name_ar:a.ar,description_en:c.en,description_ar:c.ar,image_url:t!=null&&t.image?`/storage/${t.image}`:"",is_enabled:Number(t==null?void 0:t.is_enabled)===1||(t==null?void 0:t.is_enabled)===!0}}const j={index:async(t={})=>{const{data:a}=await w.get("/api/intro",{params:t});return(Array.isArray(a)?a:(a==null?void 0:a.data)??a??[]).map(M)},edit:async t=>{const{data:a}=await w.get(`/api/intro/edit/${t}`),c=(a==null?void 0:a.data)??a;return M(c)},create:async t=>{const{data:a}=await w.post("/api/intro/create",t,{headers:{"Content-Type":"multipart/form-data"}});return a},update:async(t,a)=>{const{data:c}=await w.post(`/api/intro/update/${t}`,a,{headers:{"Content-Type":"multipart/form-data"}});return c},destroy:async t=>{const{data:a}=await w.delete(`/api/intro/delete/${t}`);return a},publicGetIntro:async()=>{const{data:t}=await w.get("/api/user/get-intro");return(Array.isArray(t)?t:(t==null?void 0:t.data)??t??[]).map(M)}};function re({name:t={en:"",ar:""},description:a={en:"",ar:""},image:c=null,order:f="",is_enabled:x=!0}){const p=new FormData;return p.append("name[en]",t.en??""),p.append("name[ar]",t.ar??""),p.append("description[en]",a.en??""),p.append("description[ar]",a.ar??""),c&&p.append("image",c),f!==""&&f!==null&&f!==void 0&&p.append("order",String(f)),p.append("is_enabled",(x?1:0).toString()),p}const oe={class:"p-6 space-y-6"},le={class:"bg-white p-5 rounded-2xl shadow-sm ring-1 ring-black/[0.05]"},ie={key:0,class:"text-sm text-gray-500"},de={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-5"},ue={class:"relative aspect-[4/3] bg-gray-50"},ce=["src"],pe={key:1,class:"absolute inset-0 flex items-center justify-center text-gray-400 text-sm"},ge={class:"absolute top-2 left-2 flex flex-wrap gap-2"},ve={class:"inline-flex items-center rounded-full bg-white/90 px-2 py-0.5 text-[11px] border"},fe={class:"p-3.5 space-y-3"},xe={class:"text-sm font-semibold text-gray-900"},_e={key:0,class:"text-gray-400"},be={dir:"rtl"},ye={class:"text-xs text-gray-600"},me={dir:"rtl",class:"text-gray-500"},he={class:"flex gap-2 pt-3"},we=["onClick"],ke=["onClick"],Ce={key:0,class:"col-span-full text-center text-gray-500 py-8"},Ie={class:"relative mx-auto w-full max-w-2xl p-4 sm:p-6 h-full flex items-center justify-center"},Ne={class:"bg-white rounded-2xl shadow-lg w-full max-h-[90vh] overflow-y-auto"},Ee={class:"sticky top-0 z-10 bg-white border-b rounded-t-2xl px-5 py-3 flex justify-between"},Ae={class:"text-lg font-bold"},Ve={class:"px-5 py-4 space-y-4 max-h-[min(88vh,900px)] overflow-y-auto"},je={key:0,class:"rounded border border-red-200 bg-red-50 text-red-700 px-3 py-2"},Me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Se={key:0,class:"mt-1 text-xs text-red-600"},qe={key:0,class:"mt-1 text-xs text-red-600"},De={key:0,class:"mt-1 text-xs text-red-600"},Ue={key:0,class:"mt-1 text-xs text-red-600"},Fe={key:0,class:"mt-1 text-xs text-red-600"},Re={class:"flex items-center gap-2"},$e={class:"space-y-2 md:col-span-2"},ze={key:0,class:"mt-1 text-xs text-red-600"},Le={key:1,class:"mt-2"},Oe=["src"],Te={class:"sticky bottom-0 z-10 bg-white border-t rounded-b-2xl px-5 py-3 flex gap-3"},Be=["disabled"],Je={__name:"IntroManagement",setup(t){const a=_([]),c=_(!1),f=_(!1),x=_(null),p=_(!1),b=_(""),y=_({}),C=_(null),i=_({name:{en:"",ar:""},description:{en:"",ar:""},image:null,order:"",is_enabled:!0}),z=P(()=>!x.value),g=r=>{var s;return((s=y.value[r])==null?void 0:s[0])||""},L=r=>!!y.value[r],h=r=>["form-input",L(r)?"border-red-400 focus:ring-red-500":""];function I(r,s){y.value[r]=[s]}function S(){const r=document.querySelector(".max-h-\\[min\\(88vh\\,900px\\)\\]"),s=r==null?void 0:r.querySelector("input.border-red-400, textarea.border-red-400");s&&s.scrollIntoView({behavior:"smooth",block:"center"})}function O(){y.value={},b.value="";const r=i.value,s=n=>n!=null&&String(n).trim()!=="";return z.value&&(s(r.name.en)||I("name.en","Name (EN) is required"),s(r.name.ar)||I("name.ar","Name (AR) is required"),s(r.description.en)||I("description.en","Description (EN) is required"),s(r.description.ar)||I("description.ar","Description (AR) is required"),r.image||I("image","Image is required")),Object.keys(y.value).length?(b.value="Please fix the highlighted fields.",S(),!1):!0}function q(){x.value=null,i.value={name:{en:"",ar:""},description:{en:"",ar:""},image:null,order:"",is_enabled:!0},C.value=null,b.value="",y.value={}}function T(){q(),f.value=!0}async function B(r){q(),x.value=r.id,i.value={name:{en:r.name_en||"",ar:r.name_ar||""},description:{en:r.description_en||"",ar:r.description_ar||""},order:r.order??"",is_enabled:!!r.is_enabled,image:null},C.value=r.image_url||null,f.value=!0}function N(){f.value=!1}function J(r){var n;const s=(n=r.target.files)==null?void 0:n[0];i.value.image=s||null,C.value=s?URL.createObjectURL(s):null}async function A(){try{c.value=!0,a.value=await j.index()}finally{c.value=!1}}async function D(){var r,s,n,V,U;if(O()){p.value=!0,b.value="",y.value={};try{const d=re(i.value);x.value?await j.update(x.value,d):await j.create(d),await A(),N()}catch(d){((r=d==null?void 0:d.response)==null?void 0:r.status)===422&&((n=(s=d==null?void 0:d.response)==null?void 0:s.data)!=null&&n.errors)?(y.value=d.response.data.errors,b.value=d.response.data.message||"Validation error",S()):b.value=((U=(V=d==null?void 0:d.response)==null?void 0:V.data)==null?void 0:U.message)||(d==null?void 0:d.message)||"Request failed"}finally{p.value=!1}}}async function K(r){confirm("Are you sure you want to delete this intro?")&&(await j.destroy(r),await A())}return G(A),(r,s)=>(l(),o(R,null,[F(H(Q),{title:"Intro Management"}),F(se,null,{default:W(()=>[e("div",oe,[e("div",{class:"flex items-center justify-between"},[s[6]||(s[6]=e("h2",{class:"text-2xl font-semibold text-dash-title"},"Intro Management",-1)),e("button",{onClick:T,class:"bg-black text-white px-3 py-2 rounded hover:bg-gray-700 disabled:opacity-50"}," + Add Intro ")]),e("div",le,[e("div",{class:"flex items-center justify-between mb-4"},[s[7]||(s[7]=e("h3",{class:"text-lg font-semibold text-gray-800"},"Intro Screens",-1)),e("button",{onClick:A,class:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50"},"Refresh")]),c.value?(l(),o("div",ie,"Loading…")):(l(),o("div",de,[(l(!0),o(R,null,X(a.value,n=>(l(),o("div",{key:n.id,class:"group rounded-2xl overflow-hidden bg-white border border-gray-200/70 shadow hover:shadow-lg hover:-translate-y-0.5 transition-all duration-200"},[e("div",ue,[n.image_url?(l(),o("img",{key:0,src:n.image_url,class:"absolute inset-0 w-full h-full object-cover"},null,8,ce)):(l(),o("div",pe,"No Image")),e("div",ge,[e("span",ve," Order: "+u(n.order??"—"),1),e("span",{class:m(["inline-flex items-center rounded-full px-2 py-0.5 text-[11px] border",n.is_enabled?"bg-green-100 text-green-700 border-green-200":"bg-red-100 text-red-700 border-red-200"])},u(n.is_enabled?"Enabled":"Disabled"),3)])]),e("div",fe,[e("div",xe,[Y(u(n.name_en||"—")+" ",1),n.name_ar?(l(),o("span",_e," / ")):v("",!0),e("span",be,u(n.name_ar),1)]),e("div",ye,[e("p",null,u(n.description_en||"—"),1),e("p",me,u(n.description_ar||"—"),1)]),e("div",he,[e("button",{class:"px-3 py-1.5 text-sm rounded-lg border bg-white hover:bg-gray-50",onClick:V=>B(n)}," Edit ",8,we),e("button",{class:"px-3 py-1.5 text-sm rounded-lg border border-red-200 text-red-700 bg-red-50 hover:bg-red-100",onClick:V=>K(n.id)}," Delete ",8,ke)])])]))),128)),a.value.length?v("",!0):(l(),o("div",Ce,"No intros found."))]))]),f.value?(l(),o("div",{key:0,class:"fixed inset-0 z-50",onKeydown:Z(N,["esc"])},[e("div",{class:"absolute inset-0 bg-black/40 back-drop",onClick:N}),e("div",Ie,[e("div",Ne,[e("div",Ee,[e("h3",Ae,u(x.value?"Edit Intro":"Add Intro"),1),e("button",{onClick:N,class:"text-gray-400 hover:text-gray-600"},"✕")]),e("div",Ve,[b.value?(l(),o("div",je,u(b.value),1)):v("",!0),e("form",{onSubmit:ee(D,["prevent"]),class:"space-y-4"},[e("div",Me,[e("div",null,[k(e("input",{class:m(h("name.en")),"onUpdate:modelValue":s[0]||(s[0]=n=>i.value.name.en=n),type:"text",placeholder:"Name (EN)"},null,2),[[E,i.value.name.en]]),g("name.en")?(l(),o("p",Se,u(g("name.en")),1)):v("",!0)]),e("div",null,[k(e("input",{class:m(h("name.ar")),"onUpdate:modelValue":s[1]||(s[1]=n=>i.value.name.ar=n),type:"text",placeholder:"الاسم (AR)"},null,2),[[E,i.value.name.ar]]),g("name.ar")?(l(),o("p",qe,u(g("name.ar")),1)):v("",!0)]),e("div",null,[k(e("textarea",{class:m(h("description.en")),"onUpdate:modelValue":s[2]||(s[2]=n=>i.value.description.en=n),placeholder:"Description (EN)"},null,2),[[E,i.value.description.en]]),g("description.en")?(l(),o("p",De,u(g("description.en")),1)):v("",!0)]),e("div",null,[k(e("textarea",{class:m(h("description.ar")),"onUpdate:modelValue":s[3]||(s[3]=n=>i.value.description.ar=n),placeholder:"الوصف (AR)"},null,2),[[E,i.value.description.ar]]),g("description.ar")?(l(),o("p",Ue,u(g("description.ar")),1)):v("",!0)]),e("div",null,[k(e("input",{class:m(h("order")),"onUpdate:modelValue":s[4]||(s[4]=n=>i.value.order=n),type:"number",placeholder:"Order"},null,2),[[E,i.value.order,void 0,{number:!0}]]),g("order")?(l(),o("p",Fe,u(g("order")),1)):v("",!0)]),e("label",Re,[k(e("input",{type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=n=>i.value.is_enabled=n)},null,512),[[te,i.value.is_enabled]]),s[8]||(s[8]=e("span",null,"Enabled",-1))]),e("div",$e,[e("input",{class:m(h("image")),type:"file",onChange:J},null,34),g("image")?(l(),o("p",ze,u(g("image")),1)):v("",!0),C.value?(l(),o("div",Le,[e("img",{src:C.value,class:"w-40 h-24 object-cover rounded border"},null,8,Oe)])):v("",!0)])])],32)]),e("div",Te,[e("button",{disabled:p.value,class:"px-4 py-2 bg-green-600 text-white rounded disabled:opacity-60",onClick:D},u(p.value?"Saving…":x.value?"Update":"Create"),9,Be),e("button",{type:"button",class:"px-3 py-2 border rounded",onClick:N},"Cancel")])])])],32)):v("",!0)])]),_:1})],64))}},Qe=ae(Je,[["__scopeId","data-v-8490add0"]]);export{Qe as default};
