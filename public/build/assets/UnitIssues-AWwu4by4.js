import{m as p,p as d,i as b,q as T,f as m,o as x,a as n,u as o,g as z,w as h,b as t,h as F,j as A,k as G,F as M,s as H,t as u,n as J}from"./app-CArYjKSu.js";import{_ as K}from"./AuthenticatedLayout-BfXxHflC.js";import{c as Q,d as w,a as N,e as R,F as _,E as f}from"./index.esm-sSX5eMhC.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const k={list:async()=>{const{data:i}=await p.get("/api/unit-issues");return i.data??[]},show:async i=>{const{data:l}=await p.get(`/api/unit-issues/show/${i}`);return l.data},create:async i=>{const{data:l}=await p.post("/api/unit-issues/store",{data:i});return l},update:async(i,l)=>{const{data:c}=await p.post(`/api/unit-issues/update/${i}`,{data:l});return c},remove:async i=>{const{data:l}=await p.delete(`/api/unit-issues/delete/${i}`);return l}},X={class:"p-6 space-y-6"},Y={class:"flex gap-4"},Z={class:"bg-white rounded-xl shadow border overflow-hidden"},tt={class:"w-full text-sm"},et={class:"px-4 py-3"},st={class:"px-4 py-3"},at={class:"px-4 py-3"},nt={class:"px-4 py-3"},ot={class:"px-4 py-3 text-right space-x-2"},it=["onClick"],lt=["onClick"],rt={key:0},dt={class:"flex justify-between items-center"},ut={class:"text-sm text-gray-600"},ct={class:"flex gap-2"},pt=["disabled"],mt=["disabled"],xt={key:0,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},_t={class:"bg-white w-full max-w-lg rounded-xl p-6"},ft={class:"space-y-3"},C=10,vt={__name:"UnitIssues",setup(i){const l=d([]),c=d(""),r=d(1),v=d(!1),I=d(null),$=d({}),P=Q({unit_id:N().required(),user_id:N().required(),title:w().required(),description:w().required(),status:w().oneOf(["open","close"])});async function y(){l.value=await k.list()}const g=b(()=>{const s=c.value.toLowerCase();return l.value.filter(e=>{var a;return((a=e.title)==null?void 0:a.toLowerCase().includes(s))||String(e.unit_id).includes(s)||String(e.user_id).includes(s)})}),U=b(()=>Math.ceil(g.value.length/C)),j=b(()=>{const s=(r.value-1)*C;return g.value.slice(s,s+C)});function V(s){I.value=s.id,$.value={unit_id:s.unit_id,user_id:s.user_id,title:s.title,description:s.description,status:s.status},v.value=!0}function D(){v.value=!1}async function B(s){await k.update(I.value,{data:s}),D(),y()}async function L(s){confirm("Delete this issue?")&&(await k.remove(s),y())}return T(y),(s,e)=>(x(),m(M,null,[n(o(z),{title:"Unit Issues"}),n(K,null,{default:h(()=>[t("div",X,[e[8]||(e[8]=t("h2",{class:"text-2xl font-semibold"},"Unit Issues",-1)),t("div",Y,[A(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>c.value=a),class:"form-input w-72",placeholder:"Search by title, unit or user"},null,512),[[G,c.value]])]),t("div",Z,[t("table",tt,[e[4]||(e[4]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left"},"Unit"),t("th",{class:"px-4 py-3 text-left"},"User"),t("th",{class:"px-4 py-3 text-left"},"Title"),t("th",{class:"px-4 py-3 text-left"},"Status"),t("th",{class:"px-4 py-3 text-right"},"Actions")])],-1)),t("tbody",null,[(x(!0),m(M,null,H(j.value,a=>{var S,q,E;return x(),m("tr",{key:a.id,class:"border-t"},[t("td",et,u(((q=(S=a.unit)==null?void 0:S.name)==null?void 0:q.en)??a.unit_id),1),t("td",st,u(((E=a.user)==null?void 0:E.name)??a.user_id),1),t("td",at,u(a.title),1),t("td",nt,[t("span",{class:J(["px-2 py-1 rounded text-xs",a.status==="open"?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"])},u(a.status),3)]),t("td",ot,[t("button",{class:"text-blue-600 text-sm",onClick:O=>V(a)}," Edit ",8,it),t("button",{class:"text-red-600 text-sm",onClick:O=>L(a.id)}," Delete ",8,lt)])])}),128)),g.value.length===0?(x(),m("tr",rt,e[3]||(e[3]=[t("td",{colspan:"5",class:"text-center py-6 text-gray-500"}," No issues found ",-1)]))):F("",!0)])])]),t("div",dt,[t("span",ut," Page "+u(r.value)+" of "+u(U.value),1),t("div",ct,[t("button",{class:"px-3 py-1 border rounded",disabled:r.value===1,onClick:e[1]||(e[1]=a=>r.value--)}," Prev ",8,pt),t("button",{class:"px-3 py-1 border rounded",disabled:r.value===U.value,onClick:e[2]||(e[2]=a=>r.value++)}," Next ",8,mt)])]),v.value?(x(),m("div",xt,[t("div",_t,[e[7]||(e[7]=t("h3",{class:"text-lg font-semibold mb-4"}," Edit Issue ",-1)),n(o(R),{"validation-schema":o(P),"initial-values":$.value,onSubmit:B},{default:h(()=>[t("div",ft,[n(o(_),{name:"unit_id",class:"form-input",placeholder:"Unit ID"}),n(o(f),{name:"unit_id",class:"error"}),n(o(_),{name:"user_id",class:"form-input",placeholder:"User ID"}),n(o(f),{name:"user_id",class:"error"}),n(o(_),{name:"title",class:"form-input",placeholder:"Title"}),n(o(f),{name:"title",class:"error"}),n(o(_),{name:"description",as:"textarea",rows:"3",class:"form-input",placeholder:"Description"}),n(o(f),{name:"description",class:"error"}),n(o(_),{name:"status",as:"select",class:"form-input"},{default:h(()=>e[5]||(e[5]=[t("option",{value:"open"},"Open",-1),t("option",{value:"close"},"Close",-1)])),_:1})]),t("div",{class:"flex justify-end gap-2 mt-4"},[t("button",{type:"button",class:"px-4 py-2 border rounded",onClick:D}," Cancel "),e[6]||(e[6]=t("button",{type:"submit",class:"px-4 py-2 bg-green-600 text-white rounded"}," Save ",-1))])]),_:1},8,["validation-schema","initial-values"])])])):F("",!0)])]),_:1})],64))}},wt=W(vt,[["__scopeId","data-v-c97ceba1"]]);export{wt as default};
