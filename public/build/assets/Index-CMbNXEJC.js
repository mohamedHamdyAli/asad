import{p,i as N,r as w,q as I,c as L,o as n,w as S,b as t,j as d,k as r,f as c,h as C,t as h,F as T,s as B}from"./app-DRIePbG3.js";import{_ as O}from"./AuthenticatedLayout-MFNb3plu.js";import{C as y,b as $,a as M}from"./contractors-N-Dx5X_z.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"p-6 space-y-6"},z={class:"bg-white p-4 rounded shadow"},G={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},H={class:"md:col-span-1"},J=["src"],K={class:"md:col-span-2"},Q={class:"md:col-span-2"},W={class:"mt-4 flex items-center gap-3"},X=["disabled"],Y={key:0,class:"text-sm text-red-600"},Z={class:"bg-white p-4 rounded shadow"},ee={key:0,class:"text-sm text-gray-500"},te={key:1,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4"},le={class:"h-40 bg-white flex items-center justify-center"},se=["src"],ae={key:1,class:"text-gray-400"},ie={class:"p-3 space-y-3 text-sm"},oe={class:"flex items-center justify-between"},ne=["onClick"],de={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},re=["onUpdate:modelValue"],ue=["onUpdate:modelValue"],ce={class:"md:col-span-2"},pe=["onUpdate:modelValue"],me={class:"md:col-span-2"},ve=["onUpdate:modelValue"],xe=["onUpdate:modelValue"],ge=["onChange"],be=["disabled","onClick"],fe={key:0,class:"col-span-full text-center text-gray-500 py-8"},ye={__name:"Index",setup(_e){const i=p({title:{en:"",ar:""},description:{en:"",ar:""},email:"",image:null}),v=p(null);function U(a){var l;const e=((l=a.target.files)==null?void 0:l[0])||null;i.value.image=e,v.value=e?URL.createObjectURL(e):null}const x=p(!1),g=p(""),V=N(()=>{var a,e,l,s,u;return!!((a=i.value.title.en)!=null&&a.trim())&&!!((e=i.value.title.ar)!=null&&e.trim())&&!!((l=i.value.description.en)!=null&&l.trim())&&!!((s=i.value.description.ar)!=null&&s.trim())&&!!((u=i.value.email)!=null&&u.trim())&&!!i.value.image});async function E(){var a,e;x.value=!0,g.value="";try{const l=$([i.value]);await y.create(l),await m(),i.value={title:{en:"",ar:""},description:{en:"",ar:""},email:"",image:null},v.value=null}catch(l){console.error(l),g.value=((e=(a=l==null?void 0:l.response)==null?void 0:a.data)==null?void 0:e.message)||(l==null?void 0:l.message)||"Create failed"}finally{x.value=!1}}const b=p([]),_=p(!1),o=w({}),f=w({}),k=w({});function D(a){Object.keys(o).forEach(e=>delete o[e]),a.forEach(e=>{o[e.id]={title:{en:e.title_en||"",ar:e.title_ar||""},description:{en:e.description_en||"",ar:e.description_ar||""},email:e.email||""}})}async function m(){_.value=!0;try{b.value=await y.list(),D(b.value)}finally{_.value=!1}}function R(a,e){var s;const l=((s=e.target.files)==null?void 0:s[0])||null;l&&(k[a]=l)}async function j(a){var l,s;const e=o[a];if(e){f[a]=!0;try{const u={title:e.title,description:e.description,email:e.email,image:k[a]},F=M(u);await y.update(a,F),delete k[a],await m()}catch(u){console.error(u),alert(((s=(l=u==null?void 0:u.response)==null?void 0:l.data)==null?void 0:s.message)||"Update failed")}finally{f[a]=!1}}}async function A(a){confirm("Delete this contractor?")&&(await y.remove(a),await m())}return I(m),(a,e)=>(n(),L(O,null,{default:S(()=>[t("div",P,[t("div",{class:"flex items-center justify-between"},[e[5]||(e[5]=t("h2",{class:"text-2xl font-bold text-dash-title"},"Contractors",-1)),t("button",{class:"px-3 py-1 border rounded text-black",onClick:m},"Refresh")]),t("div",z,[e[12]||(e[12]=t("h3",{class:"text-lg font-bold mb-3"},"Add Contractor",-1)),t("div",G,[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Title (EN) *",-1)),d(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>i.value.title.en=l),type:"text",class:"form-input"},null,512),[[r,i.value.title.en]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Title (AR) *",-1)),d(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>i.value.title.ar=l),type:"text",class:"form-input"},null,512),[[r,i.value.title.ar]])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Email *",-1)),d(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>i.value.email=l),type:"email",class:"form-input"},null,512),[[r,i.value.email]])]),t("div",H,[e[9]||(e[9]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Image *",-1)),t("input",{type:"file",accept:"image/*",onChange:U},null,32),v.value?(n(),c("img",{key:0,src:v.value,class:"mt-2 w-24 h-16 object-cover rounded border"},null,8,J)):C("",!0)]),t("div",K,[e[10]||(e[10]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Description (EN) *",-1)),d(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=l=>i.value.description.en=l),type:"text",class:"form-input"},null,512),[[r,i.value.description.en]])]),t("div",Q,[e[11]||(e[11]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Description (AR) *",-1)),d(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=l=>i.value.description.ar=l),type:"text",class:"form-input"},null,512),[[r,i.value.description.ar]])])]),t("div",W,[t("button",{class:"px-4 py-2 bg-green-600 text-white rounded disabled:opacity-60",disabled:x.value||!V.value,onClick:E},h(x.value?"Saving…":"Add"),9,X),g.value?(n(),c("span",Y,h(g.value),1)):C("",!0)])]),t("div",Z,[e[19]||(e[19]=t("h3",{class:"text-lg font-bold mb-3"},"All Contractors",-1)),_.value?(n(),c("div",ee,"Loading…")):(n(),c("div",te,[(n(!0),c(T,null,B(b.value,l=>(n(),c("div",{key:l.id,class:"border rounded bg-gray-50 overflow-hidden"},[t("div",le,[l.image_url?(n(),c("img",{key:0,src:l.image_url,class:"max-h-40 object-contain"},null,8,se)):(n(),c("div",ae,"No image"))]),t("div",ie,[t("div",oe,[t("button",{class:"px-2 py-1 border rounded text-red-600",onClick:s=>A(l.id)},"Delete",8,ne)]),t("div",de,[t("div",null,[e[13]||(e[13]=t("label",{class:"block text-[11px] text-gray-500 mb-1"},"Title (EN)",-1)),d(t("input",{"onUpdate:modelValue":s=>o[l.id].title.en=s,class:"form-input",type:"text"},null,8,re),[[r,o[l.id].title.en]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-[11px] text-gray-500 mb-1"},"Title (AR)",-1)),d(t("input",{"onUpdate:modelValue":s=>o[l.id].title.ar=s,class:"form-input",type:"text"},null,8,ue),[[r,o[l.id].title.ar]])]),t("div",ce,[e[15]||(e[15]=t("label",{class:"block text-[11px] text-gray-500 mb-1"},"Description (EN)",-1)),d(t("input",{"onUpdate:modelValue":s=>o[l.id].description.en=s,class:"form-input",type:"text"},null,8,pe),[[r,o[l.id].description.en]])]),t("div",me,[e[16]||(e[16]=t("label",{class:"block text-[11px] text-gray-500 mb-1"},"Description (AR)",-1)),d(t("input",{"onUpdate:modelValue":s=>o[l.id].description.ar=s,class:"form-input",type:"text"},null,8,ve),[[r,o[l.id].description.ar]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-[11px] text-gray-500 mb-1"},"Email",-1)),d(t("input",{"onUpdate:modelValue":s=>o[l.id].email=s,class:"form-input",type:"email"},null,8,xe),[[r,o[l.id].email]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-[11px] text-gray-500 mb-1"},"Replace Image",-1)),t("input",{type:"file",accept:"image/*",onChange:s=>R(l.id,s)},null,40,ge)])]),t("div",null,[t("button",{class:"px-3 py-1 border rounded",disabled:f[l.id],onClick:s=>j(l.id)},h(f[l.id]?"Saving…":"Save"),9,be)])])]))),128)),b.value.length?C("",!0):(n(),c("div",fe," No contractors found. "))]))])])]),_:1}))}},Ue=q(ye,[["__scopeId","data-v-d8c2da89"]]);export{Ue as default};
