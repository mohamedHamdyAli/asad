import{p as n,i as C,q as T,c as V,o as i,w as j,b as e,f as c,h as A,j as U,k as z,F as O,s as G,t as d,a as o,u as l}from"./app-BrbL6Oim.js";import{_ as H}from"./AuthenticatedLayout-DsYQAd5H.js";import{c as k,a as u,F as J,b as p,E as m}from"./index.esm-DyduwyoQ.js";import{C as x,b as K,a as Q}from"./contractors-CoqnbQyr.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"p-6 space-y-6"},Y={class:"flex gap-4"},Z={class:"bg-white rounded-xl shadow border overflow-hidden"},ee={class:"w-full text-sm"},te={class:"px-4 py-3"},se=["src"],ae={key:1,class:"text-gray-400"},le={class:"px-4 py-3"},oe={class:"px-4 py-3"},ne={class:"px-4 py-3 text-right space-x-2"},ie=["onClick"],re=["onClick"],ce={key:0},de={class:"flex justify-between items-center"},ue={class:"text-sm text-gray-600"},pe={class:"flex gap-2"},me=["disabled"],fe=["disabled"],ve={key:0,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},_e={class:"bg-white w-full max-w-xl rounded-xl p-6"},xe={class:"text-lg font-semibold mb-4"},be={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},E=10,he={__name:"Index",setup(ge){const D=n([]),b=n(""),r=n(1),f=n(!1),v=n(!1),F=n(null),h=n(null),g=n({}),I=k({title:k({en:u().required(),ar:u().required()}),description:k({en:u().required(),ar:u().required()}),email:u().email().required()});async function y(){D.value=await x.list()}const w=C(()=>{const s=b.value.toLowerCase();return D.value.filter(t=>{var a,_,$;return((a=t.title_en)==null?void 0:a.toLowerCase().includes(s))||((_=t.title_ar)==null?void 0:_.toLowerCase().includes(s))||(($=t.email)==null?void 0:$.toLowerCase().includes(s))})}),N=C(()=>Math.ceil(w.value.length/E)),L=C(()=>{const s=(r.value-1)*E;return w.value.slice(s,s+E)});function M(){v.value=!1,g.value={title:{en:"",ar:""},description:{en:"",ar:""},email:""},h.value=null,f.value=!0}function P(s){v.value=!0,F.value=s.id,g.value={title:{en:s.title_en,ar:s.title_ar},description:{en:s.description_en,ar:s.description_ar},email:s.email},f.value=!0}function q(){f.value=!1}function B(s){var t;h.value=((t=s.target.files)==null?void 0:t[0])||null}async function R(s){const t={...s,image:h.value};v.value?await x.update(F.value,K(t)):await x.create(Q([t])),q(),y()}async function S(s){confirm("Delete this contractor?")&&(await x.remove(s),y())}return T(y),(s,t)=>(i(),V(H,null,{default:j(()=>[e("div",X,[e("div",{class:"flex justify-between items-center"},[t[3]||(t[3]=e("h2",{class:"text-2xl font-bold"},"Contractors",-1)),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded",onClick:M}," + Add Contractor ")]),e("div",Y,[U(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>b.value=a),placeholder:"Search by title or email",class:"form-input w-72"},null,512),[[z,b.value]])]),e("div",Z,[e("table",ee,[t[5]||(t[5]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left"},"Image"),e("th",{class:"px-4 py-3 text-left"},"Title (EN)"),e("th",{class:"px-4 py-3 text-left"},"Email"),e("th",{class:"px-4 py-3 text-right"},"Actions")])],-1)),e("tbody",null,[(i(!0),c(O,null,G(L.value,a=>(i(),c("tr",{key:a.id,class:"border-t"},[e("td",te,[a.image_url?(i(),c("img",{key:0,src:a.image_url,class:"w-16 h-12 object-cover rounded border"},null,8,se)):(i(),c("span",ae,"â€”"))]),e("td",le,d(a.title_en),1),e("td",oe,d(a.email),1),e("td",ne,[e("button",{class:"text-blue-600",onClick:_=>P(a)},"Details",8,ie),e("button",{class:"text-red-600",onClick:_=>S(a.id)},"Delete",8,re)])]))),128)),w.value.length===0?(i(),c("tr",ce,t[4]||(t[4]=[e("td",{colspan:"4",class:"text-center py-6 text-gray-500"}," No contractors found ",-1)]))):A("",!0)])])]),e("div",de,[e("span",ue," Page "+d(r.value)+" of "+d(N.value),1),e("div",pe,[e("button",{class:"px-3 py-1 border rounded",disabled:r.value===1,onClick:t[1]||(t[1]=a=>r.value--)}," Prev ",8,me),e("button",{class:"px-3 py-1 border rounded",disabled:r.value===N.value,onClick:t[2]||(t[2]=a=>r.value++)}," Next ",8,fe)])]),f.value?(i(),c("div",ve,[e("div",_e,[e("h3",xe,d(v.value?"Edit Contractor":"Add Contractor"),1),o(l(J),{"validation-schema":l(I),"initial-values":g.value,onSubmit:R},{default:j(()=>[e("div",be,[o(l(p),{name:"title.en",class:"form-input",placeholder:"Title (EN)"}),o(l(m),{name:"title.en",class:"error"}),o(l(p),{name:"title.ar",class:"form-input",placeholder:"Title (AR)"}),o(l(m),{name:"title.ar",class:"error"}),o(l(p),{name:"email",type:"email",class:"form-input",placeholder:"Email"}),o(l(m),{name:"email",class:"error"}),o(l(p),{name:"description.en",as:"textarea",class:"form-input md:col-span-2",placeholder:"Description (EN)"}),o(l(m),{name:"description.en",class:"error md:col-span-2"}),o(l(p),{name:"description.ar",as:"textarea",class:"form-input md:col-span-2",placeholder:"Description (AR)"}),o(l(m),{name:"description.ar",class:"error md:col-span-2"}),e("input",{type:"file",accept:"image/*",onChange:B,class:"md:col-span-2"},null,32)]),e("div",{class:"flex justify-end gap-2 mt-4"},[e("button",{type:"button",class:"px-4 py-2 border rounded",onClick:q}," Cancel "),t[6]||(t[6]=e("button",{type:"submit",class:"px-4 py-2 bg-green-600 text-white rounded"}," Save ",-1))])]),_:1},8,["validation-schema","initial-values"])])])):A("",!0)])]),_:1}))}},De=W(he,[["__scopeId","data-v-25256d42"]]);export{De as default};
