import{p as c,q as I,c as E,o as l,w as V,b as t,j as d,k as y,y as m,t as u,f as a,F as f,s as S,n as D}from"./app-Duxcg2QP.js";import{_ as T}from"./AuthenticatedLayout-5BO_1ROD.js";import{U as x,b as j,a as B}from"./unitPayments-Bx5XUheK.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={class:"p-6 space-y-8"},F={class:"flex items-center justify-between"},L=["href"],M={class:"bg-white p-6 rounded-2xl shadow space-y-4"},N={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},O={class:"flex justify-end"},q=["disabled"],z={class:"bg-white p-6 rounded-2xl shadow"},R={key:0,class:"text-sm text-gray-500"},G={key:1,class:"text-center text-gray-500 py-8"},H={key:2,class:"overflow-x-auto"},J={class:"min-w-full border border-gray-200 text-sm"},K={class:"py-2 px-3"},Q=["onUpdate:modelValue"],W={key:1},X={class:"py-2 px-3"},Y=["onUpdate:modelValue"],Z={key:1},tt={class:"py-2 px-3"},et=["onUpdate:modelValue"],st={key:1,class:"capitalize"},nt={class:"py-2 px-3"},lt=["onUpdate:modelValue"],at={class:"py-2 px-3 text-center"},ot={class:"flex justify-center gap-2"},it=["onClick"],dt=["onClick"],rt=["onClick"],ut=["href"],pt=["onClick"],ct={__name:"UnitPayments",props:{unitId:{type:[Number,String],required:!0}},setup(b){const _=b,v=c([]),g=c(!1),p=c(!1),i=c({total_price:"",installments_count:"",payment_type:"",overall_status:"pending"});async function r(){g.value=!0;try{const n=await x.list(_.unitId);v.value=n.map(e=>({...e,isEditing:!1,editable:{...e}}))}finally{g.value=!1}}async function h(){p.value=!0;try{const n=j(_.unitId,[i.value]);await x.create(n),await r(),i.value={total_price:"",installments_count:"",payment_type:"",overall_status:"pending"}}finally{p.value=!1}}function k(n){n.isEditing=!0,n.editable={...n}}function w(n){n.isEditing=!1,n.editable={...n}}async function U(n){const e=B({data:n.editable});await x.update(n.id,e),n.isEditing=!1,await r()}async function P(n){confirm("Delete this payment?")&&(await x.remove(n),await r())}function C(n){switch(n){case"completed":return"bg-green-100 text-green-700";case"in_progress":return"bg-blue-100 text-blue-700";case"overdue":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}}return I(r),(n,e)=>(l(),E(T,null,{default:V(()=>[t("div",A,[t("div",F,[e[4]||(e[4]=t("h2",{class:"text-2xl font-bold text-gray-800"},"Unit Payments",-1)),t("a",{href:n.route("units.timeline",{unitId:b.unitId}),class:"px-3 py-1 border rounded text-gray-700 hover:bg-gray-100"}," ← Back to Unit Timeline ",8,L)]),t("div",M,[e[11]||(e[11]=t("h3",{class:"text-lg font-semibold text-gray-800"}," Add Unit Payment",-1)),t("div",N,[t("div",null,[e[5]||(e[5]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Total Price *",-1)),d(t("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=s=>i.value.total_price=s),class:"form-input"},null,512),[[y,i.value.total_price,void 0,{number:!0}]])]),t("div",null,[e[6]||(e[6]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Installments Count *",-1)),d(t("input",{type:"number","onUpdate:modelValue":e[1]||(e[1]=s=>i.value.installments_count=s),class:"form-input"},null,512),[[y,i.value.installments_count,void 0,{number:!0}]])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Payment Type *",-1)),d(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>i.value.payment_type=s),class:"form-input"},e[7]||(e[7]=[t("option",{value:"",disabled:""},"Select type",-1),t("option",{value:"cash"},"Cash",-1),t("option",{value:"installments"},"Installments",-1)]),512),[[m,i.value.payment_type]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Overall Status",-1)),d(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>i.value.overall_status=s),class:"form-input"},e[9]||(e[9]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"in_progress"},"In Progress",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"overdue"},"Overdue",-1)]),512),[[m,i.value.overall_status]])])]),t("div",O,[t("button",{class:"bg-black text-white px-3 py-2 rounded hover:bg-gray-700 disabled:opacity-50",disabled:p.value,onClick:h},u(p.value?"Saving…":"Add Payment"),9,q)])]),t("div",z,[t("div",{class:"flex items-center justify-between mb-4"},[e[12]||(e[12]=t("h3",{class:"text-lg font-semibold text-gray-800"},"Existing Payments",-1)),t("button",{onClick:r,class:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50"}," Refresh ")]),g.value?(l(),a("div",R,"Loading…")):v.value.length?(l(),a("div",H,[t("table",J,[e[16]||(e[16]=t("thead",{class:"bg-gray-100 text-gray-700"},[t("tr",null,[t("th",{class:"py-2 px-3 text-left"}),t("th",{class:"py-2 px-3 text-left"},"Total Price"),t("th",{class:"py-2 px-3 text-left"},"Installments"),t("th",{class:"py-2 px-3 text-left"},"Type"),t("th",{class:"py-2 px-3 text-left"},"Status"),t("th",{class:"py-2 px-3 text-center w-[220px]"},"Actions")])],-1)),t("tbody",null,[(l(!0),a(f,null,S(v.value,s=>(l(),a("tr",{key:s.id,class:"border-t hover:bg-gray-50 transition"},[e[15]||(e[15]=t("td",{class:"py-2 px-3 text-gray-600"},null,-1)),t("td",K,[s.isEditing?d((l(),a("input",{key:0,type:"number","onUpdate:modelValue":o=>s.editable.total_price=o,class:"form-input text-sm"},null,8,Q)),[[y,s.editable.total_price,void 0,{number:!0}]]):(l(),a("span",W,u(s.total_price.toLocaleString()),1))]),t("td",X,[s.isEditing?d((l(),a("input",{key:0,type:"number","onUpdate:modelValue":o=>s.editable.installments_count=o,class:"form-input text-sm"},null,8,Y)),[[y,s.editable.installments_count,void 0,{number:!0}]]):(l(),a("span",Z,u(s.installments_count),1))]),t("td",tt,[s.isEditing?d((l(),a("select",{key:0,"onUpdate:modelValue":o=>s.editable.payment_type=o,class:"form-input text-sm"},e[13]||(e[13]=[t("option",{value:"cash"},"Cash",-1),t("option",{value:"installments"},"Installments",-1)]),8,et)),[[m,s.editable.payment_type]]):(l(),a("span",st,u(s.payment_type),1))]),t("td",nt,[s.isEditing?d((l(),a("select",{key:0,"onUpdate:modelValue":o=>s.editable.overall_status=o,class:"form-input text-sm"},e[14]||(e[14]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"in_progress"},"In Progress",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"overdue"},"Overdue",-1)]),8,lt)),[[m,s.editable.overall_status]]):(l(),a("span",{key:1,class:D(["px-2 py-0.5 rounded-full text-xs font-medium",C(s.overall_status)])},u(s.overall_status.replace("_"," ")),3))]),t("td",at,[t("div",ot,[s.isEditing?(l(),a(f,{key:0},[t("button",{class:"px-3 py-1 text-xs rounded bg-green-600 text-white hover:bg-green-700",onClick:o=>U(s)}," Save ",8,it),t("button",{class:"px-3 py-1 text-xs rounded bg-gray-300 hover:bg-gray-400",onClick:o=>w(s)}," Cancel ",8,dt)],64)):(l(),a(f,{key:1},[t("button",{class:"px-3 py-1 text-xs border rounded text-blue-600 border-blue-200 hover:bg-blue-50",onClick:o=>k(s)}," Edit ",8,rt),t("a",{href:n.route("units.installments",{unitId:b.unitId,unitPaymentId:s.id}),class:"px-3 py-1 text-xs border rounded text-green-600 border-green-200 hover:bg-green-50"}," Installments ",8,ut),t("button",{class:"px-3 py-1 text-xs border rounded text-red-600 border-red-200 hover:bg-red-50",onClick:o=>P(s.id)}," Delete ",8,pt)],64))])])]))),128))])])])):(l(),a("div",G," No payments found. "))])])]),_:1}))}},vt=$(ct,[["__scopeId","data-v-30bc5f84"]]);export{vt as default};
