import{m as p,p as c,q as D,f as n,o as i,a as C,u as E,g as P,w as B,b as e,j as A,k as F,F as _,s as g,t as d,e as T,h as V,y as j}from"./app-KlDn5v0D.js";import{_ as q}from"./AuthenticatedLayout-CIKrmh8G.js";import{U as $}from"./users-uWjhU9wi.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";const x={list:async()=>{const{data:l}=await p.get("/api/roles");return l.data},show:async l=>{const{data:r}=await p.get(`/api/roles/show/${l}`);return r.data},create:async l=>p.post("/api/roles/create",l),update:async(l,r)=>p.post(`/api/roles/update/${l}`,r),remove:async l=>p.delete(`/api/roles/delete/${l}`)},z={list:async()=>{const{data:l}=await p.get("/api/permissions");return l.data}},G={class:"p-6 space-y-10"},H={class:"bg-white p-6 rounded shadow space-y-4"},J={class:"flex gap-2"},K={class:"w-full text-sm border"},O={class:"p-2 font-medium"},Q={class:"p-2"},W={class:"grid grid-cols-3 gap-2"},X=["checked","onChange"],Y={class:"p-2"},Z=["onClick"],I={class:"bg-white p-6 rounded shadow space-y-4"},ee={class:"w-full text-sm"},te={class:"px-4 py-3"},se={class:"px-4 py-3"},ae={class:"px-4 py-3"},le=["onUpdate:modelValue"],oe=["value"],ne={class:"px-4 py-3 text-right"},ie=["disabled","onClick"],ce={key:0,class:"text-green-600 text-sm"},de={key:1,class:"text-red-600 text-sm"},re={__name:"RolesManagement",setup(l){const r=c([]),w=c([]),b=c([]),m=c(""),v=c({}),u=c({}),h=c(""),y=c("");async function f(){r.value=await x.list(),w.value=await z.list(),b.value=await $.list(),b.value.forEach(a=>{var s,t;a.id in v.value||(v.value[a.id]=((t=(s=a.roles)==null?void 0:s[0])==null?void 0:t.name)||""),a.id in u.value||(u.value[a.id]=!1)})}async function M(){m.value&&(await x.create({name:m.value}),m.value="",await f())}async function U(a){confirm("Delete role?")&&(await x.remove(a),await f())}async function N(a,s){await x.update(a.id,{permission:s}),await f()}async function S(a){h.value="",y.value="",u.value[a]=!0;try{await $.assignRole(a,v.value[a]),h.value="Role assigned successfully"}catch{y.value="Failed to assign role"}finally{u.value[a]=!1}}return D(f),(a,s)=>(i(),n(_,null,[C(E(P),{title:"Roles & Permissions"}),C(q,null,{default:B(()=>[e("div",G,[e("section",H,[s[2]||(s[2]=e("h2",{class:"text-xl font-semibold"},"Roles",-1)),e("div",J,[A(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>m.value=t),placeholder:"Role name",class:"form-input w-64"},null,512),[[F,m.value]]),e("button",{class:"btn-primary",onClick:M}," Add Role ")]),e("table",K,[s[1]||(s[1]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"p-2 text-left"},"Role"),e("th",{class:"p-2"},"Permissions"),e("th",{class:"p-2"},"Actions")])],-1)),e("tbody",null,[(i(!0),n(_,null,g(r.value,t=>(i(),n("tr",{key:t.id,class:"border-t"},[e("td",O,d(t.name),1),e("td",Q,[e("div",W,[(i(!0),n(_,null,g(w.value,o=>{var k;return i(),n("label",{key:o.id,class:"flex items-center gap-1 text-xs"},[e("input",{type:"checkbox",checked:(k=t.permissions)==null?void 0:k.some(R=>R.name===o.name),onChange:R=>N(t,o.name)},null,40,X),T(" "+d(o.name),1)])}),128))])]),e("td",Y,[e("button",{class:"btn-danger",onClick:o=>U(t.id)}," Delete ",8,Z)])]))),128))])])]),e("section",I,[s[5]||(s[5]=e("h2",{class:"text-xl font-semibold"},"Users",-1)),e("table",ee,[s[4]||(s[4]=e("thead",{class:"bg-gray-100 text-left"},[e("tr",null,[e("th",{class:"px-4 py-3"},"Name"),e("th",{class:"px-4 py-3"},"Email"),e("th",{class:"px-4 py-3"},"Role"),e("th",{class:"px-4 py-3 text-right"},"Action")])],-1)),e("tbody",null,[(i(!0),n(_,null,g(b.value,t=>(i(),n("tr",{key:t.id,class:"border-t"},[e("td",te,d(t.name),1),e("td",se,d(t.email),1),e("td",ae,[A(e("select",{"onUpdate:modelValue":o=>v.value[t.id]=o,class:"form-input"},[s[3]||(s[3]=e("option",{value:""},"— Select role —",-1)),(i(!0),n(_,null,g(r.value,o=>(i(),n("option",{key:o.id,value:o.name},d(o.name),9,oe))),128))],8,le),[[j,v.value[t.id]]])]),e("td",ne,[e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded disabled:opacity-50",disabled:u.value[t.id],onClick:o=>S(t.id)},d(u.value[t.id]?"Saving…":"Save"),9,ie)])]))),128))])]),h.value?(i(),n("p",ce,d(h.value),1)):V("",!0),y.value?(i(),n("p",de,d(y.value),1)):V("",!0)])])]),_:1})],64))}},_e=L(re,[["__scopeId","data-v-4b511dcd"]]);export{_e as default};
