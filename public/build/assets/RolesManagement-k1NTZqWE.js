import{m as r,p as g,q as M,f as n,o as i,a as b,u as $,g as U,w as V,b as e,j as x,k as S,F as p,s as y,t as d,e as D,y as E}from"./app-B5oUatUK.js";import{_ as N}from"./AuthenticatedLayout-YO06gPm3.js";import{U as w}from"./users-0YgdyCYN.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const _={list:async()=>{const{data:l}=await r.get("/api/roles");return l.data},show:async l=>{const{data:c}=await r.get(`/api/roles/show/${l}`);return c.data},create:async l=>r.post("/api/roles/create",l),update:async(l,c)=>r.post(`/api/roles/update/${l}`,c),remove:async l=>r.delete(`/api/roles/delete/${l}`)},B={list:async()=>{const{data:l}=await r.get("/api/permissions");return l.data}},F={class:"p-6 space-y-10"},T={class:"bg-white p-6 rounded shadow space-y-4"},j={class:"flex gap-2"},q={class:"w-full text-sm border"},L={class:"p-2 font-medium"},z={class:"p-2"},G={class:"grid grid-cols-3 gap-2"},H=["checked","onChange"],J={class:"p-2"},K=["onClick"],O={class:"bg-white p-6 rounded shadow space-y-4"},Q={class:"w-full text-sm"},W={class:"px-4 py-3"},X={class:"px-4 py-3"},Y={class:"px-4 py-3"},Z=["onUpdate:modelValue"],I=["value"],ee={class:"px-4 py-3 text-right"},se=["disabled","onClick"],te={__name:"RolesManagement",setup(l){const c=g([]),h=g([]),v=g([]),u=g("");async function m(){c.value=await _.list(),h.value=await B.list(),v.value=await w.list()}async function R(){u.value&&(await _.create({name:u.value}),u.value="",await m())}async function k(a){confirm("Delete role?")&&(await _.remove(a),await m())}async function C(a,t){await _.update(a.id,{permission:t}),await m()}async function A(a){globalMsg.value="",globalError.value="",saving[a]=!0;try{await w.assignRole(a,selectedRoles[a]),globalMsg.value="Role assigned successfully"}catch{globalError.value="Failed to assign role"}finally{saving[a]=!1}}return M(m),(a,t)=>(i(),n(p,null,[b($(U),{title:"Roles & Permissions"}),b(N,null,{default:V(()=>[e("div",F,[e("section",T,[t[2]||(t[2]=e("h2",{class:"text-xl font-semibold"},"Roles",-1)),e("div",j,[x(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>u.value=s),placeholder:"Role name",class:"form-input w-64"},null,512),[[S,u.value]]),e("button",{class:"btn-primary",onClick:R}," Add Role ")]),e("table",q,[t[1]||(t[1]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"p-2 text-left"},"Role"),e("th",{class:"p-2"},"Permissions"),e("th",{class:"p-2"},"Actions")])],-1)),e("tbody",null,[(i(!0),n(p,null,y(c.value,s=>(i(),n("tr",{key:s.id,class:"border-t"},[e("td",L,d(s.name),1),e("td",z,[e("div",G,[(i(!0),n(p,null,y(h.value,o=>(i(),n("label",{key:o.id,class:"flex items-center gap-1 text-xs"},[e("input",{type:"checkbox",checked:s.permissions.some(f=>f.name===o.name),onChange:f=>C(s,o.name)},null,40,H),D(" "+d(o.name),1)]))),128))])]),e("td",J,[e("button",{class:"btn-danger",onClick:o=>k(s.id)}," Delete ",8,K)])]))),128))])])]),e("section",O,[t[5]||(t[5]=e("h2",{class:"text-xl font-semibold"},"Users",-1)),e("table",Q,[t[4]||(t[4]=e("thead",{class:"bg-gray-100 text-left"},[e("tr",null,[e("th",{class:"px-4 py-3"},"Name"),e("th",{class:"px-4 py-3"},"Email"),e("th",{class:"px-4 py-3"},"Role"),e("th",{class:"px-4 py-3 text-right"},"Action")])],-1)),e("tbody",null,[(i(!0),n(p,null,y(v.value,s=>(i(),n("tr",{key:s.id,class:"border-t"},[e("td",W,d(s.name),1),e("td",X,d(s.email),1),e("td",Y,[x(e("select",{"onUpdate:modelValue":o=>a.selectedRoles[s.id]=o,class:"form-input"},[t[3]||(t[3]=e("option",{value:""},"— Select role —",-1)),(i(!0),n(p,null,y(c.value,o=>(i(),n("option",{key:o.id,value:o.name},d(o.name),9,I))),128))],8,Z),[[E,a.selectedRoles[s.id]]])]),e("td",ee,[e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded disabled:opacity-50",disabled:a.saving[s.id],onClick:o=>A(s.id)},d(a.saving[s.id]?"Saving…":"Save"),9,se)])]))),128))])])])])]),_:1})],64))}},ie=P(te,[["__scopeId","data-v-57f4151e"]]);export{ie as default};
