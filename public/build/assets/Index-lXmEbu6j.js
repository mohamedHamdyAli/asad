import{i as B,p as U,B as ce,q as pe,A as te,f as c,o as d,h as w,b as t,t as u,r as ie,c as $e,w as F,j as I,k as $,y as X,F as J,s as H,e as R,a as T,u as G,S as K,z as Oe,d as Re,n as N}from"./app-CO_WisUp.js";import{_ as Ve}from"./AuthenticatedLayout-Gk-O-HUM.js";import{_ as ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{U as z,b as Me,a as Fe}from"./units-Bc0mxVkb.js";import{U as Te}from"./users-D9y3Gtcv.js";import{V as Ge}from"./vendors-DCtWcMTg.js";function Ke(x,r,n,o){function p(v){return v instanceof n?v:new n(function(_){_(v)})}return new(n||(n=Promise))(function(v,_){function h(E){try{D(o.next(E))}catch(q){_(q)}}function P(E){try{D(o.throw(E))}catch(q){_(q)}}function D(E){E.done?v(E.value):p(E.value).then(h,P)}D((o=o.apply(x,[])).next())})}function ze(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var ee,de;function Be(){return de||(de=1,ee=function x(r,n){if(r===n)return!0;if(r&&n&&typeof r=="object"&&typeof n=="object"){if(r.constructor!==n.constructor)return!1;var o,p,v;if(Array.isArray(r)){if(o=r.length,o!=n.length)return!1;for(p=o;p--!==0;)if(!x(r[p],n[p]))return!1;return!0}if(r.constructor===RegExp)return r.source===n.source&&r.flags===n.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===n.valueOf();if(r.toString!==Object.prototype.toString)return r.toString()===n.toString();if(v=Object.keys(r),o=v.length,o!==Object.keys(n).length)return!1;for(p=o;p--!==0;)if(!Object.prototype.hasOwnProperty.call(n,v[p]))return!1;for(p=o;p--!==0;){var _=v[p];if(!x(r[_],n[_]))return!1}return!0}return r!==r&&n!==n}),ee}var Ze=Be(),Je=ze(Ze);const ue="__googleMapsScriptId";var Q;(function(x){x[x.INITIALIZED=0]="INITIALIZED",x[x.LOADING=1]="LOADING",x[x.SUCCESS=2]="SUCCESS",x[x.FAILURE=3]="FAILURE"})(Q||(Q={}));class Z{constructor({apiKey:r,authReferrerPolicy:n,channel:o,client:p,id:v=ue,language:_,libraries:h=[],mapIds:P,nonce:D,region:E,retries:q=3,url:j="https://maps.googleapis.com/maps/api/js",version:m}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=r,this.authReferrerPolicy=n,this.channel=o,this.client=p,this.id=v||ue,this.language=_,this.libraries=h,this.mapIds=P,this.nonce=D,this.region=E,this.retries=q,this.url=j,this.version=m,Z.instance){if(!Je(this.options,Z.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(Z.instance.options)}`);return Z.instance}Z.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?Q.FAILURE:this.done?Q.SUCCESS:this.loading?Q.LOADING:Q.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let r=this.url;return r+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(r+=`&key=${this.apiKey}`),this.channel&&(r+=`&channel=${this.channel}`),this.client&&(r+=`&client=${this.client}`),this.libraries.length>0&&(r+=`&libraries=${this.libraries.join(",")}`),this.language&&(r+=`&language=${this.language}`),this.region&&(r+=`&region=${this.region}`),this.version&&(r+=`&v=${this.version}`),this.mapIds&&(r+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(r+=`&auth_referrer_policy=${this.authReferrerPolicy}`),r}deleteScript(){const r=document.getElementById(this.id);r&&r.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((r,n)=>{this.loadCallback(o=>{o?n(o.error):r(window.google)})})}importLibrary(r){return this.execute(),google.maps.importLibrary(r)}loadCallback(r){this.callbacks.push(r),this.execute()}setScript(){var r,n;if(document.getElementById(this.id)){this.callback();return}const o={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(o).forEach(v=>!o[v]&&delete o[v]),!((n=(r=window==null?void 0:window.google)===null||r===void 0?void 0:r.maps)===null||n===void 0)&&n.importLibrary||(v=>{let _,h,P,D="The Google Maps JavaScript API",E="google",q="importLibrary",j="__ib__",m=document,O=window;O=O[E]||(O[E]={});const A=O.maps||(O.maps={}),f=new Set,i=new URLSearchParams,g=()=>_||(_=new Promise((y,a)=>Ke(this,void 0,void 0,function*(){var C;yield h=m.createElement("script"),h.id=this.id,i.set("libraries",[...f]+"");for(P in v)i.set(P.replace(/[A-Z]/g,V=>"_"+V[0].toLowerCase()),v[P]);i.set("callback",E+".maps."+j),h.src=this.url+"?"+i,A[j]=y,h.onerror=()=>_=a(Error(D+" could not load.")),h.nonce=this.nonce||((C=m.querySelector("script[nonce]"))===null||C===void 0?void 0:C.nonce)||"",m.head.append(h)})));A[q]?console.warn(D+" only loads once. Ignoring:",v):A[q]=(y,...a)=>f.add(y)&&g().then(()=>A[q](y,...a))})(o);const p=this.libraries.map(v=>this.importLibrary(v));p.length||p.push(this.importLibrary("core")),Promise.all(p).then(()=>this.callback(),v=>{const _=new ErrorEvent("error",{error:v});this.loadErrorCallback(_)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(r){if(this.errors.push(r),this.errors.length<=this.retries){const n=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${n} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},n)}else this.onerrorEvent=r,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(r=>{r(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}const He={class:"space-y-2"},Qe={key:0,class:"block text-xs text-gray-500"},We={class:"flex gap-2"},Xe=["placeholder"],Ye={__name:"MapPicker",props:{label:{type:String,default:"Select location"},searchPlaceholder:{type:String,default:"Search placeâ€¦"},lat:{type:[Number,String],default:null},lng:{type:[Number,String],default:null},address:{type:String,default:""},fallbackCenter:{type:Object,default:()=>({lat:30.0444,lng:31.2357})},zoom:{type:Number,default:13},apiKey:{type:String,default:"AIzaSyD6l04ETuUP7BfQ7MqpL2vMWEalLxNj0d4"}},emits:["update:lat","update:lng","update:address"],setup(x,{emit:r}){const n=x,o=r,p=i=>{if(typeof i=="number")return Number.isFinite(i)?i:null;if(i===""||i==null)return null;const g=Number(i);return Number.isFinite(g)?g:null};B(()=>{const i=p(n.lat);return i==null?"-":i.toFixed(6)}),B(()=>{const i=p(n.lng);return i==null?"-":i.toFixed(6)});const v=U(null),_=U(null);let h,P,D,E,q=null;function j({lat:i,lng:g,address:y}){i!=null&&o("update:lat",i),g!=null&&o("update:lng",g),y!==void 0&&o("update:address",y)}function m(i,g){return new Promise(y=>{if(!E)return y("");E.geocode({location:{lat:i,lng:g}},(a,C)=>{C==="OK"&&a&&a.length?y(a[0].formatted_address||""):y("")})})}async function O(){try{q=await new Z({apiKey:n.apiKey,version:"weekly",libraries:["places"]}).load()}catch(a){console.error("Google Maps failed to load:",a);return}E=new q.maps.Geocoder;const i=p(n.lat),g=p(n.lng),y=i!=null&&g!=null?{lat:i,lng:g}:n.fallbackCenter;h=new q.maps.Map(v.value,{center:y,zoom:n.zoom,mapTypeControl:!1,streetViewControl:!1}),P=new q.maps.Marker({position:y,map:h,draggable:!0}),h.addListener("click",a=>{const C=a.latLng;A(C.lat(),C.lng(),!0)}),P.addListener("dragend",()=>{const a=P.getPosition();A(a.lat(),a.lng(),!0)});try{D=new q.maps.places.Autocomplete(_.value,{fields:["geometry","formatted_address","name"]}),D.addListener("place_changed",()=>{var M;const a=D.getPlace();if(!((M=a==null?void 0:a.geometry)!=null&&M.location))return;const C=a.geometry.location;h.panTo(C),h.setZoom(15);const V=a.formatted_address||a.name||"";A(C.lat(),C.lng(),!1,V)})}catch{}if(i!=null&&g!=null&&!n.address){const a=await m(i,g);j({address:a||""})}}async function A(i,g,y=!0,a=""){if(!(!P||!h)){if(P.setPosition({lat:i,lng:g}),h.panTo({lat:i,lng:g}),j({lat:i,lng:g}),a)j({address:a});else if(y){const C=await m(i,g);j({address:C||""})}}}ce(()=>[n.lat,n.lng],([i,g])=>{if(!h)return;const y=p(i),a=p(g);y==null||a==null||(P.setPosition({lat:y,lng:a}),h.panTo({lat:y,lng:a}))});function f(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(i=>{const{latitude:g,longitude:y}=i.coords;A(g,y,!0),h&&h.setZoom(15)},()=>{},{enableHighAccuracy:!0,timeout:8e3})}return pe(async()=>{await te(),await O()}),(i,g)=>(d(),c("div",He,[x.label?(d(),c("label",Qe,u(x.label),1)):w("",!0),t("div",We,[t("input",{ref_key:"searchEl",ref:_,type:"text",class:"form-input flex-1",placeholder:x.searchPlaceholder},null,8,Xe),t("button",{type:"button",class:"px-3 py-2 border rounded",onClick:f},"ðŸ“")]),t("div",{ref_key:"mapEl",ref:v,class:"rounded border",style:{height:"320px"}},null,512)]))}},et=ve(Ye,[["__scopeId","data-v-c24049d5"]]),tt={class:"p-6 space-y-6"},st={class:"bg-white p-4 rounded-xl shadow-sm ring-1 ring-black/5"},lt={class:"grid grid-cols-1 md:grid-cols-4 gap-3"},at={class:"bg-white rounded-xl shadow-sm ring-1 ring-black/5 overflow-x-auto"},rt={class:"min-w-full text-sm"},nt={key:0},ot={class:"px-4 py-2"},it={class:"px-4 py-2"},dt={class:"font-medium text-gray-900"},ut={class:"text-gray-500",dir:"rtl"},ct={class:"px-4 py-2"},pt={class:"text-gray-900"},vt={key:0,class:"text-xs text-gray-500"},gt={class:"px-4 py-2"},mt={class:"px-4 py-2"},ft={class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs border"},yt={class:"px-4 py-2 space-x-2"},ht=["href"],bt=["onClick"],xt=["onClick"],_t={key:1},wt={class:"flex items-center justify-between px-4 py-3 border-t"},kt={class:"text-xs text-gray-500"},Ct={class:"flex items-center gap-2"},Et=["disabled"],qt={class:"text-sm"},St=["disabled"],Ut={key:0,class:"fixed inset-0 z-50 modal-top"},Pt={class:"relative mx-auto w-full max-w-5xl p-6 sm:p-8 h-full flex items-center justify-center"},It={class:"bg-white rounded-2xl shadow-2xl w-full max-h-[90vh] overflow-y-auto transition-all"},Dt={key:0,class:"p-5 text-sm text-gray-500"},At={key:1,class:"p-6 space-y-6"},jt={class:"relative rounded-xl overflow-hidden shadow-md h-64 sm:h-72 md:h-80"},Lt=["src"],Nt={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-100 text-gray-400 text-sm"},$t={class:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex flex-col justify-end p-6 text-white"},Ot={class:"text-2xl font-bold"},Rt={key:0,class:"text-sm text-gray-200",dir:"rtl"},Vt={class:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm"},Mt={class:"bg-gray-50 rounded-lg p-3"},Ft={class:"font-semibold text-gray-800"},Tt={class:"bg-gray-50 rounded-lg p-3"},Gt={class:"font-semibold text-gray-800"},Kt={class:"bg-gray-50 rounded-lg p-3"},zt={class:"font-semibold text-gray-800"},Bt={class:"bg-white border rounded-xl p-5 shadow-sm"},Zt={class:"text-sm text-gray-700 whitespace-pre-wrap mb-4"},Jt={class:"text-sm text-gray-700 whitespace-pre-wrap",dir:"rtl"},Ht={key:0,class:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-2"},Qt=["src"],Wt={key:1,class:"text-sm text-gray-500"},Xt={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-3 pt-4 border-t"},Yt={class:"relative mx-auto w-full max-w-3xl p-4 sm:p-6 h-full flex items-center justify-center"},es={class:"bg-white rounded-2xl shadow-lg w-full max-h-[min(88vh,900px)] overflow-y-auto focus:outline-none"},ts={class:"sticky top-0 z-10 bg-white border-b rounded-t-2xl"},ss={class:"flex items-center justify-between px-5 py-3"},ls={class:"text-lg font-bold"},as={class:"px-5 py-4 space-y-4"},rs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ns=["required"],os={key:0,class:"mt-1 text-xs text-red-600"},is=["required"],ds={key:0,class:"mt-1 text-xs text-red-600"},us={class:"md:col-span-2"},cs=["required"],ps={key:0,class:"mt-1 text-xs text-red-600"},vs={class:"md:col-span-2"},gs=["required"],ms={key:0,class:"mt-1 text-xs text-red-600"},fs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ys={class:"md:col-span-2"},hs=["required"],bs={key:0,class:"mt-1 text-xs text-red-600"},xs=["required"],_s={key:0,class:"mt-1 text-xs text-red-600"},ws=["required"],ks={key:0,class:"mt-1 text-xs text-red-600"},Cs=["required"],Es={key:0,class:"mt-1 text-xs text-red-600"},qs=["required"],Ss={key:0,class:"mt-1 text-xs text-red-600"},Us={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ps=["required"],Is=["value"],Ds={key:0,class:"mt-1 text-xs text-red-600"},As=["required"],js=["value"],Ls={key:0,class:"mt-1 text-xs text-red-600"},Ns={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},$s={class:"block text-xs text-gray-500 mb-1"},Os=["required"],Rs={key:0,class:"mt-1 text-xs text-red-600"},Vs={key:1,class:"mt-2 relative inline-block"},Ms=["src"],Fs=["required"],Ts={key:0,class:"mt-1 text-xs text-red-600"},Gs={key:1,class:"mt-2 flex flex-wrap gap-2"},Ks=["src"],zs=["onClick"],Bs={key:2,class:"mt-2 flex flex-wrap gap-2"},Zs=["src"],Js=["onClick"],Hs={key:0,class:"rounded border border-red-200 bg-red-50 text-red-700 px-3 py-2"},Qs={class:"sticky bottom-0 z-10 bg-white border-t rounded-b-2xl"},Ws={class:"px-5 py-3 flex items-center gap-3"},Xs=["disabled"],Ys={__name:"Index",setup(x){const r=U([]),n=U(!1),o=ie({q:"",status:"",from:"",to:""}),p=U(1),v=U(10),_=B(()=>{let l=[...r.value];const e=o.q.trim().toLowerCase();return e&&(l=l.filter(s=>(s.name_en||"").toLowerCase().includes(e)||(s.name_ar||"").toLowerCase().includes(e)||(s.location||"").toLowerCase().includes(e))),o.status&&(l=l.filter(s=>s.status===o.status)),o.from&&(l=l.filter(s=>!s.start_date||s.start_date>=o.from)),o.to&&(l=l.filter(s=>!s.end_date||s.end_date<=o.to)),l}),h=B(()=>(p.value-1)*v.value),P=B(()=>Math.min(h.value+v.value,_.value.length)),D=B(()=>_.value.slice(h.value,P.value));ce([()=>o.q,()=>o.status,()=>o.from,()=>o.to,v],()=>{p.value=1});async function E(){n.value=!0;try{r.value=await z.list()}finally{n.value=!1}}const q=U(!1),j=ie({loading:!1,data:null}),m=B(()=>j.data||{});function O(){q.value=!1,j.data=null}const A=U(!1),f=U(null),i=U({}),g=U(""),y=U(!1),a=U({name:{en:"",ar:""},description:{en:"",ar:""},location:"",lat:null,long:null,start_date:"",end_date:"",user_id:null,vendor_id:null,status:"under_construction",cover_image:null,gallery:[]}),C=U(null),V=U([]),M=U([]),se=U([]),le=U([]),S=(l,e)=>{if(!e||Array.isArray(e)&&e.length===0){delete i.value[l];return}i.value[l]=Array.isArray(e)?e:[String(e)]},b=l=>{var e;return((e=i.value[l])==null?void 0:e[0])||""},ge=l=>!!i.value[l],L=l=>["form-input",ge(l)?"border-red-400 focus:ring-red-500":""].join(" ");function me(l){return`/units-management/${l}/docs`}function fe(l){return`/units-management/${l}/gallery`}function ye(l){return`/units-management/${l}/drawing`}function he(l){return`/units-management/${l}/reports`}function be(l){return`/units-management/${l}/phases`}function xe(l){return`/units-management/${l}/timeline`}function _e(l){return`/units-management/${l}/contractors`}function we(l){return`/units-management/${l}/payments`}function ke(l){return`/units-management/${l}/details`}function ae(){const l=document.querySelector(".max-h-\\[min\\(88vh\\,900px\\)\\]"),e=l==null?void 0:l.querySelector("input.border-red-400, select.border-red-400, textarea.border-red-400");e&&e.scrollIntoView({behavior:"smooth",block:"center"})}function Ce(){i.value={},g.value="";const l=a.value,e=s=>s!=null&&String(s).trim()!=="";return f.value?(l.lat!==null&&(l.lat<-90||l.lat>90)&&S("lat","Latitude must be between -90 and 90"),l.long!==null&&(l.long<-180||l.long>180)&&S("long","Longitude must be between -180 and 180"),e(l.start_date)&&e(l.end_date)&&new Date(l.end_date)<new Date(l.start_date)&&S("end_date","End date must be after or equal to start date")):(e(l.name.en)||S("name.en","Name (EN) is required"),e(l.name.ar)||S("name.ar","Name (AR) is required"),e(l.description.en)||S("description.en","Description (EN) is required"),e(l.description.ar)||S("description.ar","Description (AR) is required"),e(l.location)||S("location","Location is required"),typeof l.lat=="number"&&l.lat>=-90&&l.lat<=90||S("lat","Latitude must be between -90 and 90"),typeof l.long=="number"&&l.long>=-180&&l.long<=180||S("long","Longitude must be between -180 and 180"),e(l.start_date)||S("start_date","Start date is required"),e(l.end_date)||S("end_date","End date is required"),e(l.start_date)&&e(l.end_date)&&new Date(l.end_date)<new Date(l.start_date)&&S("end_date","End date must be after or equal to start date"),e(l.user_id)||S("user_id","User is required"),e(l.vendor_id)||S("vendor_id","Vendor is required"),l.cover_image||S("cover_image","Cover image is required"),(!Array.isArray(l.gallery)||l.gallery.length===0)&&S("gallery","Add at least one gallery image")),Object.keys(i.value).length?(g.value="Please fix the highlighted fields.",!1):!0}function Ee(){re(),A.value=!0}async function qe(l){re(),f.value=l.id;const e=await z.show(l.id);a.value.name.en=e.name_en||"",a.value.name.ar=e.name_ar||"",a.value.description.en=e.description_en||"",a.value.description.ar=e.description_ar||"",a.value.location=e.location||"",a.value.lat=e.lat,a.value.long=e.long,a.value.start_date=e.start_date||"",a.value.end_date=e.end_date||"",a.value.user_id=e.user_id??null,a.value.vendor_id=e.vendor_id??null,a.value.status=e.status||"under_construction",C.value=e.cover_image_url||null,M.value=Array.isArray(e.gallery)?e.gallery:[],A.value=!0}function re(){a.value={name:{en:"",ar:""},description:{en:"",ar:""},location:"",lat:null,long:null,start_date:"",end_date:"",user_id:null,vendor_id:null,status:"under_construction",cover_image:null,gallery:[]},C.value=null,V.value=[],M.value=[],i.value={},g.value="",f.value=null}function W(){A.value=!1}function Se(l){var s;const e=((s=l.target.files)==null?void 0:s[0])||null;a.value.cover_image=e,C.value=e?URL.createObjectURL(e):C.value}function Ue(l){const e=Array.from(l.target.files||[]);a.value.gallery=e,V.value=e.map(s=>URL.createObjectURL(s))}async function Pe(){confirm("Delete cover image?")&&(await z.deleteCover(f.value),C.value=null)}async function Ie(l){confirm("Delete this image?")&&(await z.deleteGalleryImage(f.value,l),M.value=M.value.filter(e=>e.id!==l))}function De(l){var s,k,Y,oe;const e=(k=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:k.errors;if(!e)return!1;i.value={};for(const[Le,Ne]of Object.entries(e))S(Le,Ne);return g.value=((oe=(Y=l==null?void 0:l.response)==null?void 0:Y.data)==null?void 0:oe.message)||"Validation failed. Please review the fields below.",!0}async function ne(){var l,e,s;y.value=!0;try{if(!Ce()){await te(),ae();return}if(f.value){const k=Me(a.value);await z.update(f.value,k)}else{const k=Fe(a.value);await z.create(k)}await E(),W()}catch(k){((l=k==null?void 0:k.response)==null?void 0:l.status)===422&&De(k)?(await te(),ae()):g.value=((s=(e=k==null?void 0:k.response)==null?void 0:e.data)==null?void 0:s.message)||(k==null?void 0:k.message)||"Request failed"}finally{y.value=!1}}async function Ae(l){confirm(`Delete unit #${l.id}?`)&&(await z.remove(l.id),await E())}async function je(){const l=await Te.list();se.value=l.map(s=>({id:s.id,name:s.name,email:s.email}));const e=await Ge.list();le.value=e.map(s=>({id:s.id,name:s.name,email:s.email}))}return pe(async()=>{await Promise.all([E(),je()])}),(l,e)=>(d(),$e(Ve,null,{default:F(()=>[t("div",tt,[t("div",{class:"flex items-center justify-between"},[e[22]||(e[22]=t("h2",{class:"text-2xl font-bold text-dash-title"},"Units",-1)),t("button",{onClick:Ee,class:"bg-black text-white px-3 py-2 rounded hover:bg-gray-700"}," + Add Unit ")]),t("div",st,[t("div",lt,[I(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.q=s),type:"text",placeholder:"Search by name or locationâ€¦",class:"form-input"},null,512),[[$,o.q,void 0,{trim:!0}]]),I(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.status=s),class:"form-input"},e[23]||(e[23]=[t("option",{value:""},"All statuses",-1),t("option",{value:"under_construction"},"under_construction",-1),t("option",{value:"completed"},"completed",-1)]),512),[[X,o.status]]),I(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.from=s),type:"date",class:"form-input"},null,512),[[$,o.from]]),I(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.to=s),type:"date",class:"form-input"},null,512),[[$,o.to]])])]),t("div",at,[t("table",rt,[e[26]||(e[26]=t("thead",{class:"bg-gray-50 text-gray-600"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left"},"ID"),t("th",{class:"px-4 py-2 text-left"},"Name (EN / AR)"),t("th",{class:"px-4 py-2 text-left"},"Location"),t("th",{class:"px-4 py-2 text-left"},"Period"),t("th",{class:"px-4 py-2 text-left"},"Status"),t("th",{class:"px-4 py-2 text-left"},"Actions")])],-1)),t("tbody",null,[n.value?(d(),c("tr",nt,e[24]||(e[24]=[t("td",{colspan:"6",class:"px-4 py-6 text-center text-gray-500"},"Loadingâ€¦",-1)]))):w("",!0),(d(!0),c(J,null,H(D.value,s=>(d(),c("tr",{key:s.id,class:"border-t"},[t("td",ot,"#"+u(s.id),1),t("td",it,[t("div",dt,u(s.name_en||"â€”"),1),t("div",ut,u(s.name_ar),1)]),t("td",ct,[t("div",pt,u(s.location||"â€”"),1),s.lat&&s.long?(d(),c("div",vt,"("+u(s.lat)+", "+u(s.long)+")",1)):w("",!0)]),t("td",gt,[t("div",null,u(s.start_date||"â€”")+" â†’ "+u(s.end_date||"â€”"),1)]),t("td",mt,[t("span",ft,u(s.status||"â€”"),1)]),t("td",yt,[t("a",{href:ke(s.id),target:"_blank",rel:"noopener noreferrer",class:"px-2 py-1.5 border rounded hover:bg-gray-50"}," Details ",8,ht),t("button",{class:"px-2 py-1.5 border rounded hover:bg-gray-50",onClick:k=>qe(s)},"Edit",8,bt),t("button",{class:"px-2 py-1.5 border rounded text-red-600 hover:bg-red-50",onClick:k=>Ae(s)}," Delete ",8,xt)])]))),128)),!n.value&&!_.value.length?(d(),c("tr",_t,e[25]||(e[25]=[t("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500"},"No units found.",-1)]))):w("",!0)])]),t("div",wt,[t("div",kt,[e[27]||(e[27]=R(" Showing ")),t("strong",null,u(h.value+1),1),e[28]||(e[28]=R("â€“")),t("strong",null,u(P.value),1),e[29]||(e[29]=R(" of ")),t("strong",null,u(_.value.length),1)]),t("div",Ct,[t("button",{class:"px-3 py-1.5 border rounded disabled:opacity-50",disabled:p.value===1,onClick:e[4]||(e[4]=s=>p.value--)}," Prev ",8,Et),t("span",qt,"Page "+u(p.value),1),t("button",{class:"px-3 py-1.5 border rounded disabled:opacity-50",disabled:p.value*v.value>=_.value.length,onClick:e[5]||(e[5]=s=>p.value++)}," Next ",8,St),I(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>v.value=s),class:"form-input w-24"},e[30]||(e[30]=[t("option",{value:10},"10",-1),t("option",{value:20},"20",-1),t("option",{value:50},"50",-1)]),512),[[X,v.value,void 0,{number:!0}]])])])]),q.value?(d(),c("div",Ut,[t("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:O}),t("div",Pt,[t("div",It,[t("div",{class:"sticky top-0 bg-gradient-to-r from-yellow-50 to-yellow-100 border-b px-6 py-4 rounded-t-2xl flex items-center justify-between"},[e[31]||(e[31]=t("h3",{class:"text-xl font-bold text-gray-800 flex items-center gap-2"}," Unit Details ",-1)),t("button",{onClick:O,class:"text-gray-500 hover:text-gray-800 hover:bg-gray-100 rounded-full p-2"}," âœ• ")]),j.loading?(d(),c("div",Dt,"Loadingâ€¦")):(d(),c("div",At,[t("div",jt,[m.value.cover_image_url?(d(),c("img",{key:0,src:m.value.cover_image_url,alt:"Unit Cover",class:"absolute inset-0 w-full h-full object-cover"},null,8,Lt)):(d(),c("div",Nt," No Cover Image ")),t("div",$t,[t("div",Ot,u(m.value.name_en||"Unnamed Unit"),1),m.value.name_ar?(d(),c("div",Rt,u(m.value.name_ar),1)):w("",!0)])]),t("div",Vt,[t("div",Mt,[e[32]||(e[32]=t("span",{class:"block text-gray-400 text-xs uppercase"},"Status",-1)),t("span",Ft,u(m.value.status||"â€”"),1)]),t("div",Tt,[e[33]||(e[33]=t("span",{class:"block text-gray-400 text-xs uppercase"},"Location",-1)),t("span",Gt,u(m.value.location||"â€”"),1)]),t("div",Kt,[e[34]||(e[34]=t("span",{class:"block text-gray-400 text-xs uppercase"},"Duration",-1)),t("span",zt,u(m.value.start_date||"â€”")+" â†’ "+u(m.value.end_date||"â€”"),1)])]),t("div",Bt,[e[35]||(e[35]=t("div",{class:"mb-2 text-gray-700 font-semibold text-base"},"Description (EN)",-1)),t("p",Zt,u(m.value.description_en||"â€”"),1),e[36]||(e[36]=t("div",{class:"mb-2 text-gray-700 font-semibold text-base"},"Description (AR)",-1)),t("p",Jt,u(m.value.description_ar||"â€”"),1)]),t("div",null,[e[37]||(e[37]=t("div",{class:"text-gray-800 font-semibold mb-3"},"Gallery",-1)),m.value.gallery&&m.value.gallery.length?(d(),c("div",Ht,[(d(!0),c(J,null,H(m.value.gallery,s=>(d(),c("div",{key:s.id,class:"aspect-[4/3] rounded-lg overflow-hidden bg-gray-100 border hover:shadow-md transition"},[t("img",{src:s.image_url,class:"w-full h-full object-cover"},null,8,Qt)]))),128))])):(d(),c("div",Wt,"No images available."))]),t("div",Xt,[T(G(K),{href:me(m.value.id),class:"nav-btn"},{default:F(()=>e[38]||(e[38]=[R(" ðŸ“„ Docs ")])),_:1},8,["href"]),T(G(K),{href:fe(m.value.id),class:"nav-btn"},{default:F(()=>e[39]||(e[39]=[R(" ðŸ–¼ï¸ Gallery ")])),_:1},8,["href"]),T(G(K),{href:ye(m.value.id),class:"nav-btn"},{default:F(()=>e[40]||(e[40]=[R(" âœï¸ Drawings ")])),_:1},8,["href"]),T(G(K),{href:he(m.value.id),class:"nav-btn"},{default:F(()=>e[41]||(e[41]=[R(" ðŸ“Š Reports ")])),_:1},8,["href"]),T(G(K),{href:be(m.value.id),class:"nav-btn"},{default:F(()=>e[42]||(e[42]=[R(" ðŸ§© Phases ")])),_:1},8,["href"]),T(G(K),{href:xe(m.value.id),class:"nav-btn"},{default:F(()=>e[43]||(e[43]=[R(" ðŸ•’ Timeline ")])),_:1},8,["href"]),T(G(K),{href:_e(m.value.id),class:"nav-btn"},{default:F(()=>e[44]||(e[44]=[R(" ðŸ‘· Assignments ")])),_:1},8,["href"]),T(G(K),{href:we(m.value.id),class:"nav-btn"},{default:F(()=>e[45]||(e[45]=[R(" ðŸ’° Payments & Installment ")])),_:1},8,["href"])]),t("div",{class:"sticky bottom-0 bg-white border-t pt-3 text-right"},[t("button",{onClick:O,class:"px-4 py-2 border rounded-lg hover:bg-gray-100 text-gray-700"}," Close ")])]))])])])):w("",!0),A.value?(d(),c("div",{key:1,class:"fixed inset-0 z-50",onKeydown:Oe(W,["esc"])},[t("div",{class:"absolute inset-0 bg-black/40 back-drop",onClick:W,"aria-hidden":"true"}),t("div",Yt,[t("div",es,[t("div",ts,[t("div",ss,[t("h3",ls,u(f.value?"Edit Unit":"Add Unit"),1),t("button",{onClick:W,class:"text-gray-400 hover:text-gray-600","aria-label":"Close"},"âœ•")])]),t("div",as,[t("form",{onSubmit:Re(ne,["prevent"]),class:"space-y-4"},[t("div",rs,[t("div",null,[e[46]||(e[46]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Name (EN)*",-1)),I(t("input",{class:N(L("name.en")),"onUpdate:modelValue":e[7]||(e[7]=s=>a.value.name.en=s),type:"text",required:!f.value},null,10,ns),[[$,a.value.name.en]]),b("name.en")?(d(),c("p",os,u(b("name.en")),1)):w("",!0)]),t("div",null,[e[47]||(e[47]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Name (AR)*",-1)),I(t("input",{class:N(L("name.ar")),"onUpdate:modelValue":e[8]||(e[8]=s=>a.value.name.ar=s),type:"text",required:!f.value},null,10,is),[[$,a.value.name.ar]]),b("name.ar")?(d(),c("p",ds,u(b("name.ar")),1)):w("",!0)]),t("div",us,[e[48]||(e[48]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Description (EN)*",-1)),I(t("textarea",{class:N(L("description.en")),"onUpdate:modelValue":e[9]||(e[9]=s=>a.value.description.en=s),required:!f.value},null,10,cs),[[$,a.value.description.en]]),b("description.en")?(d(),c("p",ps,u(b("description.en")),1)):w("",!0)]),t("div",vs,[e[49]||(e[49]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Description (AR)*",-1)),I(t("textarea",{class:N(L("description.ar")),"onUpdate:modelValue":e[10]||(e[10]=s=>a.value.description.ar=s),required:!f.value},null,10,gs),[[$,a.value.description.ar]]),b("description.ar")?(d(),c("p",ms,u(b("description.ar")),1)):w("",!0)])]),t("div",fs,[t("div",ys,[T(et,{label:"Pick on map",lat:a.value.lat,"onUpdate:lat":e[11]||(e[11]=s=>a.value.lat=s),lng:a.value.long,"onUpdate:lng":e[12]||(e[12]=s=>a.value.long=s),address:a.value.location,"onUpdate:address":e[13]||(e[13]=s=>a.value.location=s)},null,8,["lat","lng","address"])]),t("div",null,[e[50]||(e[50]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Location*",-1)),I(t("input",{class:N(L("location")),"onUpdate:modelValue":e[14]||(e[14]=s=>a.value.location=s),type:"text",required:!f.value,disabled:""},null,10,hs),[[$,a.value.location]]),b("location")?(d(),c("p",bs,u(b("location")),1)):w("",!0)]),t("div",null,[e[51]||(e[51]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Latitude (-90..90)*",-1)),I(t("input",{class:N(L("lat")),"onUpdate:modelValue":e[15]||(e[15]=s=>a.value.lat=s),type:"number",step:"any",min:"-90",max:"90",required:!f.value,disabled:""},null,10,xs),[[$,a.value.lat,void 0,{number:!0}]]),b("lat")?(d(),c("p",_s,u(b("lat")),1)):w("",!0)]),t("div",null,[e[52]||(e[52]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Longitude (-180..180)*",-1)),I(t("input",{class:N(L("long")),"onUpdate:modelValue":e[16]||(e[16]=s=>a.value.long=s),type:"number",step:"any",min:"-180",max:"180",required:!f.value,disabled:""},null,10,ws),[[$,a.value.long,void 0,{number:!0}]]),b("long")?(d(),c("p",ks,u(b("long")),1)):w("",!0)]),t("div",null,[e[53]||(e[53]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Start Date*",-1)),I(t("input",{class:N(L("start_date")),"onUpdate:modelValue":e[17]||(e[17]=s=>a.value.start_date=s),type:"date",required:!f.value},null,10,Cs),[[$,a.value.start_date]]),b("start_date")?(d(),c("p",Es,u(b("start_date")),1)):w("",!0)]),t("div",null,[e[54]||(e[54]=t("label",{class:"block text-xs text-gray-500 mb-1"},"End Date*",-1)),I(t("input",{class:N(L("end_date")),"onUpdate:modelValue":e[18]||(e[18]=s=>a.value.end_date=s),type:"date",required:!f.value},null,10,qs),[[$,a.value.end_date]]),b("end_date")?(d(),c("p",Ss,u(b("end_date")),1)):w("",!0)])]),t("div",Us,[t("div",null,[e[56]||(e[56]=t("label",{class:"block text-xs text-gray-500 mb-1"},"User *",-1)),I(t("select",{class:N(L("user_id")),"onUpdate:modelValue":e[19]||(e[19]=s=>a.value.user_id=s),required:!f.value},[e[55]||(e[55]=t("option",{value:"",disabled:""},"Select a user",-1)),(d(!0),c(J,null,H(se.value,s=>(d(),c("option",{key:s.id,value:s.id},u(s.name)+" â€” "+u(s.email),9,Is))),128))],10,Ps),[[X,a.value.user_id,void 0,{number:!0}]]),b("user_id")?(d(),c("p",Ds,u(b("user_id")),1)):w("",!0)]),t("div",null,[e[58]||(e[58]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Project Manager *",-1)),I(t("select",{class:N(L("vendor_id")),"onUpdate:modelValue":e[20]||(e[20]=s=>a.value.vendor_id=s),required:!f.value},[e[57]||(e[57]=t("option",{value:"",disabled:""},"Select a Project Manager",-1)),(d(!0),c(J,null,H(le.value,s=>(d(),c("option",{key:s.id,value:s.id},u(s.name)+" â€” "+u(s.email),9,js))),128))],10,As),[[X,a.value.vendor_id,void 0,{number:!0}]]),b("vendor_id")?(d(),c("p",Ls,u(b("vendor_id")),1)):w("",!0)]),t("div",null,[e[60]||(e[60]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Status",-1)),I(t("select",{class:"form-input","onUpdate:modelValue":e[21]||(e[21]=s=>a.value.status=s)},e[59]||(e[59]=[t("option",{value:"under_construction",selected:""},"under_construction",-1),t("option",{value:"completed"},"completed",-1)]),512),[[X,a.value.status]])])]),t("div",Ns,[t("div",null,[t("label",$s," Cover Image* "+u(f.value?"(optional to replace)":""),1),t("input",{class:N(L("cover_image")),type:"file",accept:"image/*",onChange:Se,required:!f.value},null,42,Os),b("cover_image")?(d(),c("p",Rs,u(b("cover_image")),1)):w("",!0),C.value?(d(),c("div",Vs,[t("img",{src:C.value,class:"w-40 h-28 object-cover rounded border"},null,8,Ms),t("button",{type:"button",class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center shadow hover:bg-red-600",onClick:Pe}," âœ• ")])):w("",!0)]),t("div",null,[e[61]||(e[61]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Gallery* (multiple on create)",-1)),t("input",{class:N(L("gallery")),type:"file",accept:"image/*",multiple:"",onChange:Ue,required:!f.value},null,42,Fs),b("gallery")?(d(),c("p",Ts,u(b("gallery")),1)):w("",!0),M.value.length?(d(),c("div",Gs,[(d(!0),c(J,null,H(M.value,s=>(d(),c("div",{key:s.id,class:"relative inline-block"},[t("img",{src:s.image_url,class:"w-24 h-16 object-cover rounded border"},null,8,Ks),t("button",{type:"button",class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center shadow hover:bg-red-600",onClick:k=>Ie(s.id)}," âœ• ",8,zs)]))),128))])):w("",!0),V.value.length?(d(),c("div",Bs,[(d(!0),c(J,null,H(V.value,(s,k)=>(d(),c("div",{key:k,class:"relative inline-block"},[t("img",{src:s,class:"w-24 h-16 object-cover rounded border"},null,8,Zs),t("button",{type:"button",class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center shadow hover:bg-red-600",onClick:Y=>V.value.splice(k,1)}," âœ• ",8,Js)]))),128))])):w("",!0)])]),g.value?(d(),c("div",Hs,u(g.value),1)):w("",!0)],32)]),t("div",Qs,[t("div",Ws,[t("button",{disabled:y.value,class:"px-4 py-2 bg-green-600 text-white rounded disabled:opacity-60",onClick:ne},u(y.value?"Savingâ€¦":f.value?"Update":"Create"),9,Xs),t("button",{type:"button",class:"px-3 py-2 border rounded",onClick:W},"Cancel")])])])])],32)):w("",!0)])]),_:1}))}},nl=ve(Ys,[["__scopeId","data-v-fc38fb7d"]]);export{nl as default};
