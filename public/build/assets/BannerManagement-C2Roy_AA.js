import{m as u,p as c,r as C,q as R,f as l,o,a as B,u as I,g as M,w as S,b as n,h as y,j as V,v as T,t as _,F as A,s as z,n as G}from"./app-CeiZJvCU.js";import{_ as O}from"./AuthenticatedLayout-z4qvtCuL.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";function k(e={}){return{...e,image_url:e.image?`/storage/${e.image}`:"",is_enabled:Number(e.is_enabled)===1||e.is_enabled===!0}}function D(e){var a;return Array.isArray(e)?e:Array.isArray(e==null?void 0:e.message)?e.message:Array.isArray(e==null?void 0:e.data)?e.data:Array.isArray((a=e==null?void 0:e.data)==null?void 0:a.data)?e.data.data:[]}function P(e){return(e==null?void 0:e.data)??(e==null?void 0:e.message)??e}const m={index:async(e={})=>{const{data:a}=await u.get("/api/banners",{params:e});return D(a).map(k)},edit:async e=>{const{data:a}=await u.get(`/api/banners/edit/${e}`);return k(P(a))},create:async e=>{const{data:a}=await u.post("/api/banners/create",e,{headers:{"Content-Type":"multipart/form-data"}});return a},update:async(e,a)=>{const{data:i}=await u.post(`/api/banners/update/${e}`,a,{headers:{"Content-Type":"multipart/form-data"}});return i},destroy:async e=>{const{data:a}=await u.delete(`/api/banners/delete/${e}`);return a},publicGet:async()=>{const{data:e}=await u.get("/api/user/get-banner");return D(e).map(k)}};function H({image:e,is_enabled:a=!0}){const i=new FormData;return e&&i.append("image",e),i.append("is_enabled",(a?1:0).toString()),i}function F({image:e=null,is_enabled:a=null}){const i=new FormData;return e&&i.append("image",e),a!==null&&i.append("is_enabled",(a?1:0).toString()),i}const J={class:"p-6 space-y-6"},K={class:"bg-white p-4 rounded-2xl shadow-sm ring-1 ring-black/[0.05]"},Q={class:"grid md:grid-cols-[1fr_auto_auto] items-end gap-4"},W={key:0,class:"mt-2"},X=["src"],Y={class:"flex items-center gap-2"},Z=["disabled"],ee={key:0,class:"text-sm text-red-600 mt-2"},te={class:"bg-white p-5 rounded-2xl shadow-sm ring-1 ring-black/[0.05]"},ne={key:0,class:"text-sm text-gray-500"},se={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5"},ae={class:"relative aspect-[4/3] bg-gray-50"},re=["src"],ie={key:1,class:"absolute inset-0 flex items-center justify-center text-gray-400 text-sm"},le={class:"absolute top-2 left-2"},oe={class:"p-3.5 space-y-3"},de={class:"flex items-center gap-2 text-sm"},ce=["checked","onChange"],ue={class:"space-y-2"},ge=["onChange"],fe=["onClick","disabled"],_e={class:"pt-2"},me=["onClick"],ve={key:0,class:"col-span-full text-center text-gray-500 py-8"},be={__name:"BannerManagement",setup(e){const a=c([]),i=c(!1),g=c(null),v=c(null),b=c(!0),p=c(!1),h=c("");function N(r){var t;const s=((t=r.target.files)==null?void 0:t[0])||null;g.value=s,v.value=s?URL.createObjectURL(s):null}async function $(){var r,s;if(g.value){p.value=!0,h.value="";try{const t=H({image:g.value,is_enabled:b.value});await m.create(t),await f(),g.value=null,v.value=null,b.value=!0}catch(t){h.value=((s=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:s.message)||(t==null?void 0:t.message)||"Upload failed"}finally{p.value=!1}}}async function f(){try{i.value=!0,a.value=await m.index()}finally{i.value=!1}}async function U(r){const s=r.is_enabled;r.is_enabled=!s;try{const t=F({is_enabled:r.is_enabled});await m.update(r.id,t)}catch(t){r.is_enabled=s,console.error("Toggle failed:",t)}}const x=C({}),w=C({});function j(r,s){var d;const t=((d=s.target.files)==null?void 0:d[0])||null;t&&(x[r]=t)}async function E(r){const s=x[r];if(s){w[r]=!0;try{const t=F({image:s});await m.update(r,t),delete x[r],await f()}catch(t){console.error("Replace failed:",t)}finally{w[r]=!1}}}async function L(r){confirm("Delete this banner?")&&(await m.destroy(r),await f())}return R(f),(r,s)=>(o(),l(A,null,[B(I(M),{title:"Banner Management"}),B(O,null,{default:S(()=>[n("div",J,[s[4]||(s[4]=n("h2",{class:"text-2xl font-semibold text-dash-title"},"Banners Gallery",-1)),n("div",K,[s[2]||(s[2]=n("h3",{class:"text-lg font-bold mb-3"},"Add Banner",-1)),n("div",Q,[n("div",null,[n("input",{type:"file",accept:"image/*",onChange:N,class:"form-input"},null,32),v.value?(o(),l("div",W,[n("img",{src:v.value,class:"w-48 h-28 object-cover rounded border"},null,8,X)])):y("",!0)]),n("label",Y,[V(n("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=t=>b.value=t)},null,512),[[T,b.value]]),s[1]||(s[1]=n("span",null,"Enabled",-1))]),n("button",{disabled:p.value||!g.value,class:"px-4 py-2 bg-green-600 text-white rounded disabled:opacity-60",onClick:$},_(p.value?"Uploading…":"Upload"),9,Z)]),h.value?(o(),l("div",ee,_(h.value),1)):y("",!0)]),n("div",te,[n("div",{class:"flex items-center justify-between mb-4"},[s[3]||(s[3]=n("h3",{class:"text-lg font-semibold text-gray-800"},"All Banners",-1)),n("button",{onClick:f,class:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50"}," Refresh ")]),i.value?(o(),l("div",ne,"Loading…")):(o(),l("div",se,[(o(!0),l(A,null,z(a.value,t=>(o(),l("div",{key:t.id,class:"group rounded-2xl overflow-hidden bg-white border border-gray-200/70 shadow hover:shadow-lg hover:-translate-y-0.5 transition-all duration-200"},[n("div",ae,[t.image_url?(o(),l("img",{key:0,src:t.image_url,class:"absolute inset-0 w-full h-full object-cover"},null,8,re)):(o(),l("div",ie," No Image ")),n("div",le,[n("span",{class:G(["px-2 py-0.5 rounded-full text-xs font-medium border",t.is_enabled?"bg-green-100 text-green-700 border-green-200":"bg-red-100 text-red-700 border-red-200"])},_(t.is_enabled?"Enabled":"Disabled"),3)])]),n("div",oe,[n("label",de,[n("input",{type:"checkbox",checked:t.is_enabled,onChange:d=>U(t)},null,40,ce),n("span",null,_(t.is_enabled?"Active":"Inactive"),1)]),n("div",ue,[n("input",{type:"file",accept:"image/*",onChange:d=>j(t.id,d),class:"block w-full text-xs text-gray-600"},null,40,ge),n("button",{class:"px-2 py-1 border rounded text-xs hover:bg-gray-50",onClick:d=>E(t.id),disabled:!x[t.id]||w[t.id]},_(w[t.id]?"Saving…":"Save New Image"),9,fe)]),n("div",_e,[n("button",{class:"px-3 py-1.5 text-sm rounded-lg border border-red-200 text-red-700 bg-red-50 hover:bg-red-100 w-full",onClick:d=>L(t.id)}," Delete ",8,me)])])]))),128)),a.value.length?y("",!0):(o(),l("div",ve," No banners found. "))]))])])]),_:1})],64))}},we=q(be,[["__scopeId","data-v-a6e743a1"]]);export{we as default};
