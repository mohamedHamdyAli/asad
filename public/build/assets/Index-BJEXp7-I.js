import{i as B,p as S,B as pe,q as ve,A as se,f as c,o as d,h as k,b as t,t as u,r as de,c as $e,w as M,j as I,k as N,y as Y,F as H,s as Q,e as O,a as F,u as G,S as K,z as Oe,d as Re,n as L}from"./app-F6bKQEA1.js";import{_ as Ve}from"./AuthenticatedLayout-BX6gmCjd.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{U as z,b as Me,a as Fe}from"./units-Dlo2WOPw.js";import{U as Te}from"./users-DeifczNP.js";import{V as Ge}from"./vendors-NOcAdEHs.js";function Ke(x,r,o,i){function v(g){return g instanceof o?g:new o(function(_){_(g)})}return new(o||(o=Promise))(function(g,_){function h(C){try{D(i.next(C))}catch(E){_(E)}}function U(C){try{D(i.throw(C))}catch(E){_(E)}}function D(C){C.done?g(C.value):v(C.value).then(h,U)}D((i=i.apply(x,[])).next())})}function ze(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var te,ue;function Be(){return ue||(ue=1,te=function x(r,o){if(r===o)return!0;if(r&&o&&typeof r=="object"&&typeof o=="object"){if(r.constructor!==o.constructor)return!1;var i,v,g;if(Array.isArray(r)){if(i=r.length,i!=o.length)return!1;for(v=i;v--!==0;)if(!x(r[v],o[v]))return!1;return!0}if(r.constructor===RegExp)return r.source===o.source&&r.flags===o.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===o.valueOf();if(r.toString!==Object.prototype.toString)return r.toString()===o.toString();if(g=Object.keys(r),i=g.length,i!==Object.keys(o).length)return!1;for(v=i;v--!==0;)if(!Object.prototype.hasOwnProperty.call(o,g[v]))return!1;for(v=i;v--!==0;){var _=g[v];if(!x(r[_],o[_]))return!1}return!0}return r!==r&&o!==o}),te}var Ze=Be(),Je=ze(Ze);const ce="__googleMapsScriptId";var W;(function(x){x[x.INITIALIZED=0]="INITIALIZED",x[x.LOADING=1]="LOADING",x[x.SUCCESS=2]="SUCCESS",x[x.FAILURE=3]="FAILURE"})(W||(W={}));class Z{constructor({apiKey:r,authReferrerPolicy:o,channel:i,client:v,id:g=ce,language:_,libraries:h=[],mapIds:U,nonce:D,region:C,retries:E=3,url:P="https://maps.googleapis.com/maps/api/js",version:f}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=r,this.authReferrerPolicy=o,this.channel=i,this.client=v,this.id=g||ce,this.language=_,this.libraries=h,this.mapIds=U,this.nonce=D,this.region=C,this.retries=E,this.url=P,this.version=f,Z.instance){if(!Je(this.options,Z.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(Z.instance.options)}`);return Z.instance}Z.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?W.FAILURE:this.done?W.SUCCESS:this.loading?W.LOADING:W.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let r=this.url;return r+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(r+=`&key=${this.apiKey}`),this.channel&&(r+=`&channel=${this.channel}`),this.client&&(r+=`&client=${this.client}`),this.libraries.length>0&&(r+=`&libraries=${this.libraries.join(",")}`),this.language&&(r+=`&language=${this.language}`),this.region&&(r+=`&region=${this.region}`),this.version&&(r+=`&v=${this.version}`),this.mapIds&&(r+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(r+=`&auth_referrer_policy=${this.authReferrerPolicy}`),r}deleteScript(){const r=document.getElementById(this.id);r&&r.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((r,o)=>{this.loadCallback(i=>{i?o(i.error):r(window.google)})})}importLibrary(r){return this.execute(),google.maps.importLibrary(r)}loadCallback(r){this.callbacks.push(r),this.execute()}setScript(){var r,o;if(document.getElementById(this.id)){this.callback();return}const i={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(i).forEach(g=>!i[g]&&delete i[g]),!((o=(r=window==null?void 0:window.google)===null||r===void 0?void 0:r.maps)===null||o===void 0)&&o.importLibrary||(g=>{let _,h,U,D="The Google Maps JavaScript API",C="google",E="importLibrary",P="__ib__",f=document,R=window;R=R[C]||(R[C]={});const A=R.maps||(R.maps={}),V=new Set,n=new URLSearchParams,m=()=>_||(_=new Promise((y,p)=>Ke(this,void 0,void 0,function*(){var a;yield h=f.createElement("script"),h.id=this.id,n.set("libraries",[...V]+"");for(U in g)n.set(U.replace(/[A-Z]/g,$=>"_"+$[0].toLowerCase()),g[U]);n.set("callback",C+".maps."+P),h.src=this.url+"?"+n,A[P]=y,h.onerror=()=>_=p(Error(D+" could not load.")),h.nonce=this.nonce||((a=f.querySelector("script[nonce]"))===null||a===void 0?void 0:a.nonce)||"",f.head.append(h)})));A[E]?console.warn(D+" only loads once. Ignoring:",g):A[E]=(y,...p)=>V.add(y)&&m().then(()=>A[E](y,...p))})(i);const v=this.libraries.map(g=>this.importLibrary(g));v.length||v.push(this.importLibrary("core")),Promise.all(v).then(()=>this.callback(),g=>{const _=new ErrorEvent("error",{error:g});this.loadErrorCallback(_)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(r){if(this.errors.push(r),this.errors.length<=this.retries){const o=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${o} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},o)}else this.onerrorEvent=r,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(r=>{r(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}const He={class:"space-y-2"},Qe={key:0,class:"block text-xs text-gray-500"},We={class:"flex gap-2"},Xe=["placeholder"],Ye={__name:"MapPicker",props:{label:{type:String,default:"Select location"},searchPlaceholder:{type:String,default:"Search place‚Ä¶"},lat:{type:[Number,String],default:null},lng:{type:[Number,String],default:null},address:{type:String,default:""},fallbackCenter:{type:Object,default:()=>({lat:30.0444,lng:31.2357})},zoom:{type:Number,default:13},apiKey:{type:String,default:"AIzaSyD6l04ETuUP7BfQ7MqpL2vMWEalLxNj0d4"}},emits:["update:lat","update:lng","update:address"],setup(x,{emit:r}){const o=x,i=r,v=n=>{if(typeof n=="number")return Number.isFinite(n)?n:null;if(n===""||n==null)return null;const m=Number(n);return Number.isFinite(m)?m:null};B(()=>{const n=v(o.lat);return n==null?"-":n.toFixed(6)}),B(()=>{const n=v(o.lng);return n==null?"-":n.toFixed(6)});const g=S(null),_=S(null);let h,U,D,C,E=null;function P({lat:n,lng:m,address:y}){n!=null&&i("update:lat",n),m!=null&&i("update:lng",m),y!==void 0&&i("update:address",y)}function f(n,m){return new Promise(y=>{if(!C)return y("");C.geocode({location:{lat:n,lng:m}},(p,a)=>{a==="OK"&&p&&p.length?y(p[0].formatted_address||""):y("")})})}async function R(){try{E=await new Z({apiKey:o.apiKey,version:"weekly",libraries:["places"]}).load()}catch(p){console.error("Google Maps failed to load:",p);return}C=new E.maps.Geocoder;const n=v(o.lat),m=v(o.lng),y=n!=null&&m!=null?{lat:n,lng:m}:o.fallbackCenter;h=new E.maps.Map(g.value,{center:y,zoom:o.zoom,mapTypeControl:!1,streetViewControl:!1}),U=new E.maps.Marker({position:y,map:h,draggable:!0}),h.addListener("click",p=>{const a=p.latLng;A(a.lat(),a.lng(),!0)}),U.addListener("dragend",()=>{const p=U.getPosition();A(p.lat(),p.lng(),!0)});try{D=new E.maps.places.Autocomplete(_.value,{fields:["geometry","formatted_address","name"]}),D.addListener("place_changed",()=>{var T;const p=D.getPlace();if(!((T=p==null?void 0:p.geometry)!=null&&T.location))return;const a=p.geometry.location;h.panTo(a),h.setZoom(15);const $=p.formatted_address||p.name||"";A(a.lat(),a.lng(),!1,$)})}catch{}if(n!=null&&m!=null&&!o.address){const p=await f(n,m);P({address:p||""})}}async function A(n,m,y=!0,p=""){if(!(!U||!h)){if(U.setPosition({lat:n,lng:m}),h.panTo({lat:n,lng:m}),P({lat:n,lng:m}),p)P({address:p});else if(y){const a=await f(n,m);P({address:a||""})}}}pe(()=>[o.lat,o.lng],([n,m])=>{if(!h)return;const y=v(n),p=v(m);y==null||p==null||(U.setPosition({lat:y,lng:p}),h.panTo({lat:y,lng:p}))});function V(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(n=>{const{latitude:m,longitude:y}=n.coords;A(m,y,!0),h&&h.setZoom(15)},()=>{},{enableHighAccuracy:!0,timeout:8e3})}return ve(async()=>{await se(),await R()}),(n,m)=>(d(),c("div",He,[x.label?(d(),c("label",Qe,u(x.label),1)):k("",!0),t("div",We,[t("input",{ref_key:"searchEl",ref:_,type:"text",class:"form-input flex-1",placeholder:x.searchPlaceholder},null,8,Xe),t("button",{type:"button",class:"px-3 py-2 border rounded",onClick:V},"üìç")]),t("div",{ref_key:"mapEl",ref:g,class:"rounded border",style:{height:"320px"}},null,512)]))}},et=ge(Ye,[["__scopeId","data-v-c24049d5"]]),tt={class:"p-6 space-y-6"},st={class:"bg-white p-4 rounded-xl shadow-sm ring-1 ring-black/5"},lt={class:"grid grid-cols-1 md:grid-cols-4 gap-3"},at={class:"bg-white rounded-xl shadow-sm ring-1 ring-black/5 overflow-x-auto"},nt={class:"min-w-full text-sm"},rt={key:0},ot={class:"px-4 py-2"},it={class:"px-4 py-2"},dt={class:"font-medium text-gray-900"},ut={class:"text-gray-500",dir:"rtl"},ct={class:"px-4 py-2"},pt={class:"text-gray-900"},vt={key:0,class:"text-xs text-gray-500"},gt={class:"px-4 py-2"},mt={class:"px-4 py-2"},ft={class:"inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-xs border"},yt={class:"px-4 py-2 space-x-2"},ht=["onClick"],bt=["onClick"],xt=["onClick"],_t={key:1},wt={class:"flex items-center justify-between px-4 py-3 border-t"},kt={class:"text-xs text-gray-500"},Ct={class:"flex items-center gap-2"},Et=["disabled"],qt={class:"text-sm"},St=["disabled"],Ut={key:0,class:"fixed inset-0 z-50 modal-top"},Pt={class:"relative mx-auto w-full max-w-5xl p-6 sm:p-8 h-full flex items-center justify-center"},It={class:"bg-white rounded-2xl shadow-2xl w-full max-h-[90vh] overflow-y-auto transition-all"},Dt={key:0,class:"p-5 text-sm text-gray-500"},At={key:1,class:"p-6 space-y-6"},jt={class:"relative rounded-xl overflow-hidden shadow-md h-64 sm:h-72 md:h-80"},Lt=["src"],Nt={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-100 text-gray-400 text-sm"},$t={class:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex flex-col justify-end p-6 text-white"},Ot={class:"text-2xl font-bold"},Rt={key:0,class:"text-sm text-gray-200",dir:"rtl"},Vt={class:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm"},Mt={class:"bg-gray-50 rounded-lg p-3"},Ft={class:"font-semibold text-gray-800"},Tt={class:"bg-gray-50 rounded-lg p-3"},Gt={class:"font-semibold text-gray-800"},Kt={class:"bg-gray-50 rounded-lg p-3"},zt={class:"font-semibold text-gray-800"},Bt={class:"bg-white border rounded-xl p-5 shadow-sm"},Zt={class:"text-sm text-gray-700 whitespace-pre-wrap mb-4"},Jt={class:"text-sm text-gray-700 whitespace-pre-wrap",dir:"rtl"},Ht={key:0,class:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-2"},Qt=["src"],Wt={key:1,class:"text-sm text-gray-500"},Xt={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-3 pt-4 border-t"},Yt={class:"relative mx-auto w-full max-w-3xl p-4 sm:p-6 h-full flex items-center justify-center"},es={class:"bg-white rounded-2xl shadow-lg w-full max-h-[min(88vh,900px)] overflow-y-auto focus:outline-none"},ts={class:"sticky top-0 z-10 bg-white border-b rounded-t-2xl"},ss={class:"flex items-center justify-between px-5 py-3"},ls={class:"text-lg font-bold"},as={class:"px-5 py-4 space-y-4"},ns={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},rs=["required"],os={key:0,class:"mt-1 text-xs text-red-600"},is=["required"],ds={key:0,class:"mt-1 text-xs text-red-600"},us={class:"md:col-span-2"},cs=["required"],ps={key:0,class:"mt-1 text-xs text-red-600"},vs={class:"md:col-span-2"},gs=["required"],ms={key:0,class:"mt-1 text-xs text-red-600"},fs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ys={class:"md:col-span-2"},hs=["required"],bs={key:0,class:"mt-1 text-xs text-red-600"},xs=["required"],_s={key:0,class:"mt-1 text-xs text-red-600"},ws=["required"],ks={key:0,class:"mt-1 text-xs text-red-600"},Cs=["required"],Es={key:0,class:"mt-1 text-xs text-red-600"},qs=["required"],Ss={key:0,class:"mt-1 text-xs text-red-600"},Us={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ps=["required"],Is=["value"],Ds={key:0,class:"mt-1 text-xs text-red-600"},As=["required"],js=["value"],Ls={key:0,class:"mt-1 text-xs text-red-600"},Ns={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},$s={class:"block text-xs text-gray-500 mb-1"},Os=["required"],Rs={key:0,class:"mt-1 text-xs text-red-600"},Vs={key:1,class:"mt-2 relative inline-block"},Ms=["src"],Fs=["required"],Ts={key:0,class:"mt-1 text-xs text-red-600"},Gs={key:1,class:"mt-2 flex flex-wrap gap-2"},Ks=["src"],zs=["onClick"],Bs={key:2,class:"mt-2 flex flex-wrap gap-2"},Zs=["src"],Js=["onClick"],Hs={key:0,class:"rounded border border-red-200 bg-red-50 text-red-700 px-3 py-2"},Qs={class:"sticky bottom-0 z-10 bg-white border-t rounded-b-2xl"},Ws={class:"px-5 py-3 flex items-center gap-3"},Xs=["disabled"],Ys={__name:"Index",setup(x){const r=S([]),o=S(!1),i=de({q:"",status:"",from:"",to:""}),v=S(1),g=S(10),_=B(()=>{let l=[...r.value];const e=i.q.trim().toLowerCase();return e&&(l=l.filter(s=>(s.name_en||"").toLowerCase().includes(e)||(s.name_ar||"").toLowerCase().includes(e)||(s.location||"").toLowerCase().includes(e))),i.status&&(l=l.filter(s=>s.status===i.status)),i.from&&(l=l.filter(s=>!s.start_date||s.start_date>=i.from)),i.to&&(l=l.filter(s=>!s.end_date||s.end_date<=i.to)),l}),h=B(()=>(v.value-1)*g.value),U=B(()=>Math.min(h.value+g.value,_.value.length)),D=B(()=>_.value.slice(h.value,U.value));pe([()=>i.q,()=>i.status,()=>i.from,()=>i.to,g],()=>{v.value=1});async function C(){o.value=!0;try{r.value=await z.list()}finally{o.value=!1}}const E=S(!1),P=de({loading:!1,data:null}),f=B(()=>P.data||{});async function R(l){E.value=!0,P.loading=!0;try{const e=await z.show(l.id);P.data=e}catch(e){console.error(e),P.data=l}finally{P.loading=!1}}function A(){E.value=!1,P.data=null}const V=S(!1),n=S(null),m=S({}),y=S(""),p=S(!1),a=S({name:{en:"",ar:""},description:{en:"",ar:""},location:"",lat:null,long:null,start_date:"",end_date:"",user_id:null,vendor_id:null,status:"under_construction",cover_image:null,gallery:[]}),$=S(null),T=S([]),J=S([]),le=S([]),ae=S([]),q=(l,e)=>{if(!e||Array.isArray(e)&&e.length===0){delete m.value[l];return}m.value[l]=Array.isArray(e)?e:[String(e)]},b=l=>{var e;return((e=m.value[l])==null?void 0:e[0])||""},me=l=>!!m.value[l],j=l=>["form-input",me(l)?"border-red-400 focus:ring-red-500":""].join(" ");function fe(l){return`/units-management/${l}/docs`}function ye(l){return`/units-management/${l}/gallery`}function he(l){return`/units-management/${l}/drawing`}function be(l){return`/units-management/${l}/reports`}function xe(l){return`/units-management/${l}/phases`}function _e(l){return`/units-management/${l}/timeline`}function we(l){return`/units-management/${l}/contractors`}function ke(l){return`/units-management/${l}/payments`}function ne(){const l=document.querySelector(".max-h-\\[min\\(88vh\\,900px\\)\\]"),e=l==null?void 0:l.querySelector("input.border-red-400, select.border-red-400, textarea.border-red-400");e&&e.scrollIntoView({behavior:"smooth",block:"center"})}function Ce(){m.value={},y.value="";const l=a.value,e=s=>s!=null&&String(s).trim()!=="";return n.value?(l.lat!==null&&(l.lat<-90||l.lat>90)&&q("lat","Latitude must be between -90 and 90"),l.long!==null&&(l.long<-180||l.long>180)&&q("long","Longitude must be between -180 and 180"),e(l.start_date)&&e(l.end_date)&&new Date(l.end_date)<new Date(l.start_date)&&q("end_date","End date must be after or equal to start date")):(e(l.name.en)||q("name.en","Name (EN) is required"),e(l.name.ar)||q("name.ar","Name (AR) is required"),e(l.description.en)||q("description.en","Description (EN) is required"),e(l.description.ar)||q("description.ar","Description (AR) is required"),e(l.location)||q("location","Location is required"),typeof l.lat=="number"&&l.lat>=-90&&l.lat<=90||q("lat","Latitude must be between -90 and 90"),typeof l.long=="number"&&l.long>=-180&&l.long<=180||q("long","Longitude must be between -180 and 180"),e(l.start_date)||q("start_date","Start date is required"),e(l.end_date)||q("end_date","End date is required"),e(l.start_date)&&e(l.end_date)&&new Date(l.end_date)<new Date(l.start_date)&&q("end_date","End date must be after or equal to start date"),e(l.user_id)||q("user_id","User is required"),e(l.vendor_id)||q("vendor_id","Vendor is required"),l.cover_image||q("cover_image","Cover image is required"),(!Array.isArray(l.gallery)||l.gallery.length===0)&&q("gallery","Add at least one gallery image")),Object.keys(m.value).length?(y.value="Please fix the highlighted fields.",!1):!0}function Ee(){re(),V.value=!0}async function qe(l){re(),n.value=l.id;const e=await z.show(l.id);a.value.name.en=e.name_en||"",a.value.name.ar=e.name_ar||"",a.value.description.en=e.description_en||"",a.value.description.ar=e.description_ar||"",a.value.location=e.location||"",a.value.lat=e.lat,a.value.long=e.long,a.value.start_date=e.start_date||"",a.value.end_date=e.end_date||"",a.value.user_id=e.user_id??null,a.value.vendor_id=e.vendor_id??null,a.value.status=e.status||"under_construction",$.value=e.cover_image_url||null,J.value=Array.isArray(e.gallery)?e.gallery:[],V.value=!0}function re(){a.value={name:{en:"",ar:""},description:{en:"",ar:""},location:"",lat:null,long:null,start_date:"",end_date:"",user_id:null,vendor_id:null,status:"under_construction",cover_image:null,gallery:[]},$.value=null,T.value=[],J.value=[],m.value={},y.value="",n.value=null}function X(){V.value=!1}function Se(l){var s;const e=((s=l.target.files)==null?void 0:s[0])||null;a.value.cover_image=e,$.value=e?URL.createObjectURL(e):$.value}function Ue(l){const e=Array.from(l.target.files||[]);a.value.gallery=e,T.value=e.map(s=>URL.createObjectURL(s))}async function Pe(){confirm("Delete cover image?")&&(await z.deleteCover(n.value),$.value=null)}async function Ie(l){confirm("Delete this image?")&&(await z.deleteGalleryImage(n.value,l),J.value=J.value.filter(e=>e.id!==l))}function De(l){var s,w,ee,ie;const e=(w=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:w.errors;if(!e)return!1;m.value={};for(const[Le,Ne]of Object.entries(e))q(Le,Ne);return y.value=((ie=(ee=l==null?void 0:l.response)==null?void 0:ee.data)==null?void 0:ie.message)||"Validation failed. Please review the fields below.",!0}async function oe(){var l,e,s;p.value=!0;try{if(!Ce()){await se(),ne();return}if(n.value){const w=Me(a.value);await z.update(n.value,w)}else{const w=Fe(a.value);await z.create(w)}await C(),X()}catch(w){((l=w==null?void 0:w.response)==null?void 0:l.status)===422&&De(w)?(await se(),ne()):y.value=((s=(e=w==null?void 0:w.response)==null?void 0:e.data)==null?void 0:s.message)||(w==null?void 0:w.message)||"Request failed"}finally{p.value=!1}}async function Ae(l){confirm(`Delete unit #${l.id}?`)&&(await z.remove(l.id),await C())}async function je(){const l=await Te.list();le.value=l.map(s=>({id:s.id,name:s.name,email:s.email}));const e=await Ge.list();ae.value=e.map(s=>({id:s.id,name:s.name,email:s.email}))}return ve(async()=>{await Promise.all([C(),je()])}),(l,e)=>(d(),$e(Ve,null,{default:M(()=>[t("div",tt,[t("div",{class:"flex items-center justify-between"},[e[22]||(e[22]=t("h2",{class:"text-2xl font-bold text-dash-title"},"Units",-1)),t("button",{onClick:Ee,class:"bg-black text-white px-3 py-2 rounded hover:bg-gray-700"}," + Add Unit ")]),t("div",st,[t("div",lt,[I(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>i.q=s),type:"text",placeholder:"Search by name or location‚Ä¶",class:"form-input"},null,512),[[N,i.q,void 0,{trim:!0}]]),I(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>i.status=s),class:"form-input"},e[23]||(e[23]=[t("option",{value:""},"All statuses",-1),t("option",{value:"under_construction"},"under_construction",-1),t("option",{value:"completed"},"completed",-1)]),512),[[Y,i.status]]),I(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>i.from=s),type:"date",class:"form-input"},null,512),[[N,i.from]]),I(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>i.to=s),type:"date",class:"form-input"},null,512),[[N,i.to]])])]),t("div",at,[t("table",nt,[e[26]||(e[26]=t("thead",{class:"bg-gray-50 text-gray-600"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left"},"ID"),t("th",{class:"px-4 py-2 text-left"},"Name (EN / AR)"),t("th",{class:"px-4 py-2 text-left"},"Location"),t("th",{class:"px-4 py-2 text-left"},"Period"),t("th",{class:"px-4 py-2 text-left"},"Status"),t("th",{class:"px-4 py-2 text-left"},"Actions")])],-1)),t("tbody",null,[o.value?(d(),c("tr",rt,e[24]||(e[24]=[t("td",{colspan:"6",class:"px-4 py-6 text-center text-gray-500"},"Loading‚Ä¶",-1)]))):k("",!0),(d(!0),c(H,null,Q(D.value,s=>(d(),c("tr",{key:s.id,class:"border-t"},[t("td",ot,"#"+u(s.id),1),t("td",it,[t("div",dt,u(s.name_en||"‚Äî"),1),t("div",ut,u(s.name_ar),1)]),t("td",ct,[t("div",pt,u(s.location||"‚Äî"),1),s.lat&&s.long?(d(),c("div",vt,"("+u(s.lat)+", "+u(s.long)+")",1)):k("",!0)]),t("td",gt,[t("div",null,u(s.start_date||"‚Äî")+" ‚Üí "+u(s.end_date||"‚Äî"),1)]),t("td",mt,[t("span",ft,u(s.status||"‚Äî"),1)]),t("td",yt,[t("button",{class:"px-2 py-1.5 border rounded hover:bg-gray-50",onClick:w=>R(s)},"Details",8,ht),t("button",{class:"px-2 py-1.5 border rounded hover:bg-gray-50",onClick:w=>qe(s)},"Edit",8,bt),t("button",{class:"px-2 py-1.5 border rounded text-red-600 hover:bg-red-50",onClick:w=>Ae(s)}," Delete ",8,xt)])]))),128)),!o.value&&!_.value.length?(d(),c("tr",_t,e[25]||(e[25]=[t("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500"},"No units found.",-1)]))):k("",!0)])]),t("div",wt,[t("div",kt,[e[27]||(e[27]=O(" Showing ")),t("strong",null,u(h.value+1),1),e[28]||(e[28]=O("‚Äì")),t("strong",null,u(U.value),1),e[29]||(e[29]=O(" of ")),t("strong",null,u(_.value.length),1)]),t("div",Ct,[t("button",{class:"px-3 py-1.5 border rounded disabled:opacity-50",disabled:v.value===1,onClick:e[4]||(e[4]=s=>v.value--)}," Prev ",8,Et),t("span",qt,"Page "+u(v.value),1),t("button",{class:"px-3 py-1.5 border rounded disabled:opacity-50",disabled:v.value*g.value>=_.value.length,onClick:e[5]||(e[5]=s=>v.value++)}," Next ",8,St),I(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>g.value=s),class:"form-input w-24"},e[30]||(e[30]=[t("option",{value:10},"10",-1),t("option",{value:20},"20",-1),t("option",{value:50},"50",-1)]),512),[[Y,g.value,void 0,{number:!0}]])])])]),E.value?(d(),c("div",Ut,[t("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:A}),t("div",Pt,[t("div",It,[t("div",{class:"sticky top-0 bg-gradient-to-r from-yellow-50 to-yellow-100 border-b px-6 py-4 rounded-t-2xl flex items-center justify-between"},[e[31]||(e[31]=t("h3",{class:"text-xl font-bold text-gray-800 flex items-center gap-2"}," Unit Details ",-1)),t("button",{onClick:A,class:"text-gray-500 hover:text-gray-800 hover:bg-gray-100 rounded-full p-2"}," ‚úï ")]),P.loading?(d(),c("div",Dt,"Loading‚Ä¶")):(d(),c("div",At,[t("div",jt,[f.value.cover_image_url?(d(),c("img",{key:0,src:f.value.cover_image_url,alt:"Unit Cover",class:"absolute inset-0 w-full h-full object-cover"},null,8,Lt)):(d(),c("div",Nt," No Cover Image ")),t("div",$t,[t("div",Ot,u(f.value.name_en||"Unnamed Unit"),1),f.value.name_ar?(d(),c("div",Rt,u(f.value.name_ar),1)):k("",!0)])]),t("div",Vt,[t("div",Mt,[e[32]||(e[32]=t("span",{class:"block text-gray-400 text-xs uppercase"},"Status",-1)),t("span",Ft,u(f.value.status||"‚Äî"),1)]),t("div",Tt,[e[33]||(e[33]=t("span",{class:"block text-gray-400 text-xs uppercase"},"Location",-1)),t("span",Gt,u(f.value.location||"‚Äî"),1)]),t("div",Kt,[e[34]||(e[34]=t("span",{class:"block text-gray-400 text-xs uppercase"},"Duration",-1)),t("span",zt,u(f.value.start_date||"‚Äî")+" ‚Üí "+u(f.value.end_date||"‚Äî"),1)])]),t("div",Bt,[e[35]||(e[35]=t("div",{class:"mb-2 text-gray-700 font-semibold text-base"},"Description (EN)",-1)),t("p",Zt,u(f.value.description_en||"‚Äî"),1),e[36]||(e[36]=t("div",{class:"mb-2 text-gray-700 font-semibold text-base"},"Description (AR)",-1)),t("p",Jt,u(f.value.description_ar||"‚Äî"),1)]),t("div",null,[e[37]||(e[37]=t("div",{class:"text-gray-800 font-semibold mb-3"},"Gallery",-1)),f.value.gallery&&f.value.gallery.length?(d(),c("div",Ht,[(d(!0),c(H,null,Q(f.value.gallery,s=>(d(),c("div",{key:s.id,class:"aspect-[4/3] rounded-lg overflow-hidden bg-gray-100 border hover:shadow-md transition"},[t("img",{src:s.image_url,class:"w-full h-full object-cover"},null,8,Qt)]))),128))])):(d(),c("div",Wt,"No images available."))]),t("div",Xt,[F(G(K),{href:fe(f.value.id),class:"nav-btn"},{default:M(()=>e[38]||(e[38]=[O(" üìÑ Docs ")])),_:1},8,["href"]),F(G(K),{href:ye(f.value.id),class:"nav-btn"},{default:M(()=>e[39]||(e[39]=[O(" üñºÔ∏è Gallery ")])),_:1},8,["href"]),F(G(K),{href:he(f.value.id),class:"nav-btn"},{default:M(()=>e[40]||(e[40]=[O(" ‚úèÔ∏è Drawings ")])),_:1},8,["href"]),F(G(K),{href:be(f.value.id),class:"nav-btn"},{default:M(()=>e[41]||(e[41]=[O(" üìä Reports ")])),_:1},8,["href"]),F(G(K),{href:xe(f.value.id),class:"nav-btn"},{default:M(()=>e[42]||(e[42]=[O(" üß© Phases ")])),_:1},8,["href"]),F(G(K),{href:_e(f.value.id),class:"nav-btn"},{default:M(()=>e[43]||(e[43]=[O(" üïí Timeline ")])),_:1},8,["href"]),F(G(K),{href:we(f.value.id),class:"nav-btn"},{default:M(()=>e[44]||(e[44]=[O(" üë∑ Assignments ")])),_:1},8,["href"]),F(G(K),{href:ke(f.value.id),class:"nav-btn"},{default:M(()=>e[45]||(e[45]=[O(" üí∞ Payments & Installment ")])),_:1},8,["href"])]),t("div",{class:"sticky bottom-0 bg-white border-t pt-3 text-right"},[t("button",{onClick:A,class:"px-4 py-2 border rounded-lg hover:bg-gray-100 text-gray-700"}," Close ")])]))])])])):k("",!0),V.value?(d(),c("div",{key:1,class:"fixed inset-0 z-50",onKeydown:Oe(X,["esc"])},[t("div",{class:"absolute inset-0 bg-black/40 back-drop",onClick:X,"aria-hidden":"true"}),t("div",Yt,[t("div",es,[t("div",ts,[t("div",ss,[t("h3",ls,u(n.value?"Edit Unit":"Add Unit"),1),t("button",{onClick:X,class:"text-gray-400 hover:text-gray-600","aria-label":"Close"},"‚úï")])]),t("div",as,[t("form",{onSubmit:Re(oe,["prevent"]),class:"space-y-4"},[t("div",ns,[t("div",null,[e[46]||(e[46]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Name (EN)*",-1)),I(t("input",{class:L(j("name.en")),"onUpdate:modelValue":e[7]||(e[7]=s=>a.value.name.en=s),type:"text",required:!n.value},null,10,rs),[[N,a.value.name.en]]),b("name.en")?(d(),c("p",os,u(b("name.en")),1)):k("",!0)]),t("div",null,[e[47]||(e[47]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Name (AR)*",-1)),I(t("input",{class:L(j("name.ar")),"onUpdate:modelValue":e[8]||(e[8]=s=>a.value.name.ar=s),type:"text",required:!n.value},null,10,is),[[N,a.value.name.ar]]),b("name.ar")?(d(),c("p",ds,u(b("name.ar")),1)):k("",!0)]),t("div",us,[e[48]||(e[48]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Description (EN)*",-1)),I(t("textarea",{class:L(j("description.en")),"onUpdate:modelValue":e[9]||(e[9]=s=>a.value.description.en=s),required:!n.value},null,10,cs),[[N,a.value.description.en]]),b("description.en")?(d(),c("p",ps,u(b("description.en")),1)):k("",!0)]),t("div",vs,[e[49]||(e[49]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Description (AR)*",-1)),I(t("textarea",{class:L(j("description.ar")),"onUpdate:modelValue":e[10]||(e[10]=s=>a.value.description.ar=s),required:!n.value},null,10,gs),[[N,a.value.description.ar]]),b("description.ar")?(d(),c("p",ms,u(b("description.ar")),1)):k("",!0)])]),t("div",fs,[t("div",ys,[F(et,{label:"Pick on map",lat:a.value.lat,"onUpdate:lat":e[11]||(e[11]=s=>a.value.lat=s),lng:a.value.long,"onUpdate:lng":e[12]||(e[12]=s=>a.value.long=s),address:a.value.location,"onUpdate:address":e[13]||(e[13]=s=>a.value.location=s)},null,8,["lat","lng","address"])]),t("div",null,[e[50]||(e[50]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Location*",-1)),I(t("input",{class:L(j("location")),"onUpdate:modelValue":e[14]||(e[14]=s=>a.value.location=s),type:"text",required:!n.value,disabled:""},null,10,hs),[[N,a.value.location]]),b("location")?(d(),c("p",bs,u(b("location")),1)):k("",!0)]),t("div",null,[e[51]||(e[51]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Latitude (-90..90)*",-1)),I(t("input",{class:L(j("lat")),"onUpdate:modelValue":e[15]||(e[15]=s=>a.value.lat=s),type:"number",step:"any",min:"-90",max:"90",required:!n.value,disabled:""},null,10,xs),[[N,a.value.lat,void 0,{number:!0}]]),b("lat")?(d(),c("p",_s,u(b("lat")),1)):k("",!0)]),t("div",null,[e[52]||(e[52]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Longitude (-180..180)*",-1)),I(t("input",{class:L(j("long")),"onUpdate:modelValue":e[16]||(e[16]=s=>a.value.long=s),type:"number",step:"any",min:"-180",max:"180",required:!n.value,disabled:""},null,10,ws),[[N,a.value.long,void 0,{number:!0}]]),b("long")?(d(),c("p",ks,u(b("long")),1)):k("",!0)]),t("div",null,[e[53]||(e[53]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Start Date*",-1)),I(t("input",{class:L(j("start_date")),"onUpdate:modelValue":e[17]||(e[17]=s=>a.value.start_date=s),type:"date",required:!n.value},null,10,Cs),[[N,a.value.start_date]]),b("start_date")?(d(),c("p",Es,u(b("start_date")),1)):k("",!0)]),t("div",null,[e[54]||(e[54]=t("label",{class:"block text-xs text-gray-500 mb-1"},"End Date*",-1)),I(t("input",{class:L(j("end_date")),"onUpdate:modelValue":e[18]||(e[18]=s=>a.value.end_date=s),type:"date",required:!n.value},null,10,qs),[[N,a.value.end_date]]),b("end_date")?(d(),c("p",Ss,u(b("end_date")),1)):k("",!0)])]),t("div",Us,[t("div",null,[e[56]||(e[56]=t("label",{class:"block text-xs text-gray-500 mb-1"},"User *",-1)),I(t("select",{class:L(j("user_id")),"onUpdate:modelValue":e[19]||(e[19]=s=>a.value.user_id=s),required:!n.value},[e[55]||(e[55]=t("option",{value:"",disabled:""},"Select a user",-1)),(d(!0),c(H,null,Q(le.value,s=>(d(),c("option",{key:s.id,value:s.id},u(s.name)+" ‚Äî "+u(s.email),9,Is))),128))],10,Ps),[[Y,a.value.user_id,void 0,{number:!0}]]),b("user_id")?(d(),c("p",Ds,u(b("user_id")),1)):k("",!0)]),t("div",null,[e[58]||(e[58]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Project Manager *",-1)),I(t("select",{class:L(j("vendor_id")),"onUpdate:modelValue":e[20]||(e[20]=s=>a.value.vendor_id=s),required:!n.value},[e[57]||(e[57]=t("option",{value:"",disabled:""},"Select a Project Manager",-1)),(d(!0),c(H,null,Q(ae.value,s=>(d(),c("option",{key:s.id,value:s.id},u(s.name)+" ‚Äî "+u(s.email),9,js))),128))],10,As),[[Y,a.value.vendor_id,void 0,{number:!0}]]),b("vendor_id")?(d(),c("p",Ls,u(b("vendor_id")),1)):k("",!0)]),t("div",null,[e[60]||(e[60]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Status",-1)),I(t("select",{class:"form-input","onUpdate:modelValue":e[21]||(e[21]=s=>a.value.status=s)},e[59]||(e[59]=[t("option",{value:"under_construction",selected:""},"under_construction",-1),t("option",{value:"completed"},"completed",-1)]),512),[[Y,a.value.status]])])]),t("div",Ns,[t("div",null,[t("label",$s," Cover Image* "+u(n.value?"(optional to replace)":""),1),t("input",{class:L(j("cover_image")),type:"file",accept:"image/*",onChange:Se,required:!n.value},null,42,Os),b("cover_image")?(d(),c("p",Rs,u(b("cover_image")),1)):k("",!0),$.value?(d(),c("div",Vs,[t("img",{src:$.value,class:"w-40 h-28 object-cover rounded border"},null,8,Ms),t("button",{type:"button",class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center shadow hover:bg-red-600",onClick:Pe}," ‚úï ")])):k("",!0)]),t("div",null,[e[61]||(e[61]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Gallery* (multiple on create)",-1)),t("input",{class:L(j("gallery")),type:"file",accept:"image/*",multiple:"",onChange:Ue,required:!n.value},null,42,Fs),b("gallery")?(d(),c("p",Ts,u(b("gallery")),1)):k("",!0),J.value.length?(d(),c("div",Gs,[(d(!0),c(H,null,Q(J.value,s=>(d(),c("div",{key:s.id,class:"relative inline-block"},[t("img",{src:s.image_url,class:"w-24 h-16 object-cover rounded border"},null,8,Ks),t("button",{type:"button",class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center shadow hover:bg-red-600",onClick:w=>Ie(s.id)}," ‚úï ",8,zs)]))),128))])):k("",!0),T.value.length?(d(),c("div",Bs,[(d(!0),c(H,null,Q(T.value,(s,w)=>(d(),c("div",{key:w,class:"relative inline-block"},[t("img",{src:s,class:"w-24 h-16 object-cover rounded border"},null,8,Zs),t("button",{type:"button",class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center shadow hover:bg-red-600",onClick:ee=>T.value.splice(w,1)}," ‚úï ",8,Js)]))),128))])):k("",!0)])]),y.value?(d(),c("div",Hs,u(y.value),1)):k("",!0)],32)]),t("div",Qs,[t("div",Ws,[t("button",{disabled:p.value,class:"px-4 py-2 bg-green-600 text-white rounded disabled:opacity-60",onClick:oe},u(p.value?"Saving‚Ä¶":n.value?"Update":"Create"),9,Xs),t("button",{type:"button",class:"px-3 py-2 border rounded",onClick:X},"Cancel")])])])])],32)):k("",!0)])]),_:1}))}},rl=ge(Ys,[["__scopeId","data-v-5f303ee9"]]);export{rl as default};
