import{p as d,q as N,c as D,o as i,w as M,b as t,j as o,k as u,y as k,t as r,f as p,F as _,s as j,n as T,N as B,h as F}from"./app-CHzwI3cM.js";import{_ as R}from"./AuthenticatedLayout-BJaAcZYD.js";import{U as x,b as q,a as z}from"./unitInstallments-DgdIAnEX.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const L={class:"p-6 space-y-8"},O={class:"flex items-center justify-between"},G=["href"],H={class:"bg-white p-6 rounded-2xl shadow space-y-4"},J={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},K={class:"md:col-span-3"},Q={class:"md:col-span-3"},W={class:"flex justify-end"},X=["disabled"],Y={class:"bg-white p-6 rounded-2xl shadow"},Z={key:0,class:"text-sm text-gray-500"},h={key:1,class:"text-center text-gray-500 py-8"},tt={key:2,class:"overflow-x-auto"},et={class:"min-w-full border border-gray-200 text-sm"},lt={class:"py-2 px-3"},at={class:"py-2 px-3"},st={class:"py-2 px-3"},nt={class:"py-2 px-3"},ot={class:"py-2 px-3"},ut={class:"py-2 px-3 text-center"},dt=["onClick"],it=["onClick"],rt={key:0,class:"fixed inset-0 z-[2000] flex items-center justify-center"},pt={class:"relative z-10 bg-white rounded-2xl shadow-2xl w-full max-w-3xl p-6 animate-fadeIn overflow-y-auto max-h-[90vh]"},mt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},vt={class:"md:col-span-2"},bt={class:"md:col-span-2"},yt={class:"mt-6 flex justify-end gap-3"},ft=["disabled"],xt={__name:"UnitInstallments",props:{unitId:{type:[Number,String],required:!0},unitPaymentId:{type:[Number,String],required:!0}},setup(c){const V=c,g=d([]),w=d(!1),v=d(!1),b=d(!1),U=d(!1),y=d(null),a=d({title:{en:"",ar:""},description:{en:"",ar:""},percentage:null,amount:null,status:"pending",milestone_date:"",submission_date:"",consultant_approval_date:"",due_date:"",payment_date:""}),s=d({title:{en:"",ar:""},description:{en:"",ar:""},percentage:null,amount:null,status:"pending",due_date:""});async function m(){w.value=!0;try{const n=await x.list(V.unitPaymentId);g.value=n}finally{w.value=!1}}async function I(){v.value=!0;try{const n=q(V.unitPaymentId,s.value);await x.create(n),await m(),s.value={title:{en:"",ar:""},description:{en:"",ar:""},percentage:null,amount:null,status:"pending",due_date:""}}finally{v.value=!1}}function C(n){y.value=n,a.value={title:{en:n.title_en,ar:n.title_ar},description:{en:n.description_en,ar:n.description_ar},percentage:n.percentage,amount:n.amount,status:n.status,milestone_date:n.milestone_date,submission_date:n.submission_date,consultant_approval_date:n.consultant_approval_date,due_date:n.due_date,payment_date:n.payment_date},U.value=!0}function f(){U.value=!1,y.value=null}async function A(){if(y.value){b.value=!0;try{const n=z(a.value);await x.update(y.value.id,n),await m(),f()}finally{b.value=!1}}}async function P(n){confirm("Delete this installment?")&&(await x.remove(n),await m())}function S(n){switch(n){case"paid":return"bg-green-100 text-green-700";case"overdue":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}}return N(m),(n,e)=>(i(),D(R,null,{default:M(()=>[t("div",L,[t("div",O,[e[24]||(e[24]=t("h2",{class:"text-2xl font-bold text-gray-800"},"Unit Installments",-1)),t("a",{href:n.route("units.payments",{unitId:c.unitId}),class:"px-3 py-1 border rounded text-gray-700 hover:bg-gray-100"}," ← Back to Payments ",8,G)]),t("div",H,[e[38]||(e[38]=t("h3",{class:"text-lg font-semibold text-gray-800"}," Add Installment",-1)),t("div",J,[t("div",null,[e[25]||(e[25]=t("label",{class:"label"},"Title (EN) *",-1)),o(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.title.en=l),class:"form-input"},null,512),[[u,s.value.title.en]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"label"},"Title (AR) *",-1)),o(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.title.ar=l),class:"form-input"},null,512),[[u,s.value.title.ar]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"label"},"Amount *",-1)),o(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=l=>s.value.amount=l),class:"form-input"},null,512),[[u,s.value.amount,void 0,{number:!0}]])]),t("div",null,[e[28]||(e[28]=t("label",{class:"label"},"Percentage",-1)),o(t("input",{type:"number","onUpdate:modelValue":e[3]||(e[3]=l=>s.value.percentage=l),class:"form-input"},null,512),[[u,s.value.percentage,void 0,{number:!0}]])]),t("div",null,[e[30]||(e[30]=t("label",{class:"label"},"Status",-1)),o(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.status=l),class:"form-input"},e[29]||(e[29]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"paid"},"Paid",-1),t("option",{value:"overdue"},"Overdue",-1)]),512),[[k,s.value.status]])]),t("div",null,[e[31]||(e[31]=t("label",{class:"label"},"Milestone Date",-1)),o(t("input",{type:"date","onUpdate:modelValue":e[5]||(e[5]=l=>s.value.milestone_date=l),class:"form-input"},null,512),[[u,s.value.milestone_date]])]),t("div",null,[e[32]||(e[32]=t("label",{class:"label"},"Submission Date",-1)),o(t("input",{type:"date","onUpdate:modelValue":e[6]||(e[6]=l=>s.value.submission_date=l),class:"form-input"},null,512),[[u,s.value.submission_date]])]),t("div",null,[e[33]||(e[33]=t("label",{class:"label"},"Consultant Approval Date",-1)),o(t("input",{type:"date","onUpdate:modelValue":e[7]||(e[7]=l=>s.value.consultant_approval_date=l),class:"form-input"},null,512),[[u,s.value.consultant_approval_date]])]),t("div",null,[e[34]||(e[34]=t("label",{class:"label"},"Due Date",-1)),o(t("input",{type:"date","onUpdate:modelValue":e[8]||(e[8]=l=>s.value.due_date=l),class:"form-input"},null,512),[[u,s.value.due_date]])]),t("div",null,[e[35]||(e[35]=t("label",{class:"label"},"Payment Date",-1)),o(t("input",{type:"date","onUpdate:modelValue":e[9]||(e[9]=l=>s.value.payment_date=l),class:"form-input"},null,512),[[u,s.value.payment_date]])]),t("div",K,[e[36]||(e[36]=t("label",{class:"label"},"Description (EN)",-1)),o(t("textarea",{"onUpdate:modelValue":e[10]||(e[10]=l=>s.value.description.en=l),rows:"2",class:"form-input"},null,512),[[u,s.value.description.en]])]),t("div",Q,[e[37]||(e[37]=t("label",{class:"label"},"Description (AR)",-1)),o(t("textarea",{"onUpdate:modelValue":e[11]||(e[11]=l=>s.value.description.ar=l),rows:"2",class:"form-input"},null,512),[[u,s.value.description.ar]])])]),t("div",W,[t("button",{class:"bg-black text-white px-3 py-2 rounded hover:bg-gray-700 disabled:opacity-50",disabled:v.value,onClick:I},r(v.value?"Saving…":"Add Installment"),9,X)])]),t("div",Y,[t("div",{class:"flex items-center justify-between mb-4"},[e[39]||(e[39]=t("h3",{class:"text-lg font-semibold text-gray-800"},"Existing Installments",-1)),t("button",{onClick:m,class:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50"}," Refresh ")]),w.value?(i(),p("div",Z,"Loading…")):g.value.length?(i(),p("div",tt,[t("table",et,[e[41]||(e[41]=t("thead",{class:"bg-gray-100 text-gray-700"},[t("tr",null,[t("th",{class:"py-2 px-3 text-left"}),t("th",{class:"py-2 px-3 text-left"},"Title (EN)"),t("th",{class:"py-2 px-3 text-left"},"Amount"),t("th",{class:"py-2 px-3 text-left"},"%"),t("th",{class:"py-2 px-3 text-left"},"Status"),t("th",{class:"py-2 px-3 text-left"},"Due Date"),t("th",{class:"py-2 px-3 text-center w-[180px]"},"Actions")])],-1)),t("tbody",null,[(i(!0),p(_,null,j(g.value,l=>(i(),p("tr",{key:l.id,class:"border-t hover:bg-gray-50 transition"},[e[40]||(e[40]=t("td",{class:"py-2 px-3 text-gray-600"},null,-1)),t("td",lt,r(l.title_en||"-"),1),t("td",at,r(l.amount??"-"),1),t("td",st,r(l.percentage??"-")+"%",1),t("td",nt,[t("span",{class:T(["px-2 py-0.5 rounded-full text-xs font-medium",S(l.status)])},r(l.status),3)]),t("td",ot,r(l.due_date||"-"),1),t("td",ut,[t("button",{class:"px-3 py-1 text-xs border rounded text-blue-600 border-blue-200 hover:bg-blue-50 mr-2",onClick:E=>C(l)}," Edit ",8,dt),t("button",{class:"px-3 py-1 text-xs border rounded text-red-600 border-red-200 hover:bg-red-50",onClick:E=>P(l.id)}," Delete ",8,it)])]))),128))])])])):(i(),p("div",h," No installments found. "))]),(i(),D(B,{to:"body"},[U.value?(i(),p("div",rt,[t("div",{class:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:f}),t("div",pt,[t("div",{class:"flex items-center justify-between mb-4"},[e[42]||(e[42]=t("h3",{class:"text-xl font-semibold text-gray-800"}," Edit Installment ",-1)),t("button",{class:"text-gray-400 hover:text-gray-600 text-xl",onClick:f}," ✕ ")]),t("div",mt,[t("div",null,[e[43]||(e[43]=t("label",{class:"label"},"Title (EN)",-1)),o(t("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>a.value.title.en=l),class:"form-input"},null,512),[[u,a.value.title.en]])]),t("div",null,[e[44]||(e[44]=t("label",{class:"label"},"Title (AR)",-1)),o(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>a.value.title.ar=l),class:"form-input"},null,512),[[u,a.value.title.ar]])]),t("div",null,[e[45]||(e[45]=t("label",{class:"label"},"Amount",-1)),o(t("input",{type:"number","onUpdate:modelValue":e[14]||(e[14]=l=>a.value.amount=l),class:"form-input"},null,512),[[u,a.value.amount,void 0,{number:!0}]])]),t("div",null,[e[46]||(e[46]=t("label",{class:"label"},"Percentage",-1)),o(t("input",{type:"number","onUpdate:modelValue":e[15]||(e[15]=l=>a.value.percentage=l),class:"form-input"},null,512),[[u,a.value.percentage,void 0,{number:!0}]])]),t("div",null,[e[48]||(e[48]=t("label",{class:"label"},"Status",-1)),o(t("select",{"onUpdate:modelValue":e[16]||(e[16]=l=>a.value.status=l),class:"form-input"},e[47]||(e[47]=[t("option",{value:"pending"},"Pending",-1),t("option",{value:"paid"},"Paid",-1),t("option",{value:"overdue"},"Overdue",-1)]),512),[[k,a.value.status]])]),t("div",null,[e[49]||(e[49]=t("label",{class:"label"},"Milestone Date",-1)),o(t("input",{type:"date","onUpdate:modelValue":e[17]||(e[17]=l=>a.value.milestone_date=l),class:"form-input"},null,512),[[u,a.value.milestone_date]])]),t("div",null,[e[50]||(e[50]=t("label",{class:"label"},"Submission Date",-1)),o(t("input",{type:"date","onUpdate:modelValue":e[18]||(e[18]=l=>a.value.submission_date=l),class:"form-input"},null,512),[[u,a.value.submission_date]])]),t("div",null,[e[51]||(e[51]=t("label",{class:"label"},"Consultant Approval Date",-1)),o(t("input",{type:"date","onUpdate:modelValue":e[19]||(e[19]=l=>a.value.consultant_approval_date=l),class:"form-input"},null,512),[[u,a.value.consultant_approval_date]])]),t("div",null,[e[52]||(e[52]=t("label",{class:"label"},"Due Date",-1)),o(t("input",{type:"date","onUpdate:modelValue":e[20]||(e[20]=l=>a.value.due_date=l),class:"form-input"},null,512),[[u,a.value.due_date]])]),t("div",null,[e[53]||(e[53]=t("label",{class:"label"},"Payment Date",-1)),o(t("input",{type:"date","onUpdate:modelValue":e[21]||(e[21]=l=>a.value.payment_date=l),class:"form-input"},null,512),[[u,a.value.payment_date]])]),t("div",vt,[e[54]||(e[54]=t("label",{class:"label"},"Description (EN)",-1)),o(t("textarea",{"onUpdate:modelValue":e[22]||(e[22]=l=>a.value.description.en=l),rows:"2",class:"form-input"},null,512),[[u,a.value.description.en]])]),t("div",bt,[e[55]||(e[55]=t("label",{class:"label"},"Description (AR)",-1)),o(t("textarea",{"onUpdate:modelValue":e[23]||(e[23]=l=>a.value.description.ar=l),rows:"2",class:"form-input"},null,512),[[u,a.value.description.ar]])])]),t("div",yt,[t("button",{class:"px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-100",onClick:f}," Cancel "),t("button",{class:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",disabled:b.value,onClick:A},r(b.value?"Saving…":"Save Changes"),9,ft)])])])):F("",!0)]))])]),_:1}))}},Vt=$(xt,[["__scopeId","data-v-33d50013"]]);export{Vt as default};
