import{m as y,p as _,q as L,f as d,o as u,a as U,u as S,g as O,w as T,b as a,h as g,t as p,j as b,k as h,v as B,F as N,s as E,e as k}from"./app-ZJOI9a43.js";import{_ as q}from"./AuthenticatedLayout-CASBx0o-.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";function z(e){try{return typeof e=="string"?JSON.parse(e):e}catch{return e}}function M(e){const n=z(e);return n&&typeof n=="object"?{en:n.en??"",ar:n.ar??""}:{en:n??"",ar:n??""}}function V(e){const n=M(e==null?void 0:e.name),i=M(e==null?void 0:e.description);return{...e,name_en:n.en,name_ar:n.ar,description_en:i.en,description_ar:i.ar,image_url:e!=null&&e.image?`/storage/${e.image}`:"",is_enabled:Number(e==null?void 0:e.is_enabled)===1||(e==null?void 0:e.is_enabled)===!0}}const I={index:async(e={})=>{const{data:n}=await y.get("/api/intro",{params:e});return(Array.isArray(n)?n:(n==null?void 0:n.data)??n??[]).map(V)},edit:async e=>{const{data:n}=await y.get(`/api/intro/edit/${e}`),i=(n==null?void 0:n.data)??n;return V(i)},create:async e=>{const{data:n}=await y.post("/api/intro/create",e,{headers:{"Content-Type":"multipart/form-data"}});return n},update:async(e,n)=>{const{data:i}=await y.post(`/api/intro/update/${e}`,n,{headers:{"Content-Type":"multipart/form-data"}});return i},destroy:async e=>{const{data:n}=await y.delete(`/api/intro/delete/${e}`);return n},publicGetIntro:async()=>{const{data:e}=await y.get("/api/user/get-intro");return(Array.isArray(e)?e:(e==null?void 0:e.data)??e??[]).map(V)}};function G({name:e={en:"",ar:""},description:n={en:"",ar:""},image:i=null,order:c="",is_enabled:m=!0}){const l=new FormData;return l.append("name[en]",e.en??""),l.append("name[ar]",e.ar??""),l.append("description[en]",n.en??""),l.append("description[ar]",n.ar??""),i&&l.append("image",i),c!==""&&c!==null&&c!==void 0&&l.append("order",String(c)),l.append("is_enabled",(m?1:0).toString()),l}const P={class:"p-6 space-y-6"},Y={class:"bg-white p-4 rounded shadow"},H={class:"flex items-center justify-between mb-4"},K={class:"text-lg font-bold"},Q={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},W={class:"flex items-center gap-2"},X={class:"space-y-2"},Z={key:0,class:"text-sm text-gray-600"},ee=["src"],te={class:"mt-4 flex items-center gap-3"},ne=["disabled"],ae={key:0,class:"text-gray-500 text-sm"},se={key:0,class:"mt-3 text-red-600 text-sm"},re={key:1,class:"mt-2 text-sm text-red-600 list-disc pl-6"},oe={class:"bg-white p-4 rounded shadow"},le={key:0,class:"text-sm text-gray-500"},ie={key:1},de={class:"min-w-0"},ue={class:"font-semibold truncate"},ce={class:"text-sm text-gray-600 truncate"},pe={class:"text-xs text-gray-500"},ve={class:"flex gap-3 items-center"},_e=["src"],fe=["onClick"],ge=["onClick"],me={key:0,class:"text-center text-gray-500 py-8"},ye={__name:"IntroManagement",setup(e){const n=_([]),i=_(!1),c=_(null),m=_(!1),l=_(""),x=_({}),w=_(null),o=_({name:{en:"",ar:""},description:{en:"",ar:""},image:null,order:"",is_enabled:!0});function j(){c.value=null,o.value={name:{en:"",ar:""},description:{en:"",ar:""},image:null,order:"",is_enabled:!0},w.value=null,l.value="",x.value={}}async function C(){try{i.value=!0,n.value=await I.index()}finally{i.value=!1}}async function R(){var v,t,s,f,A;m.value=!0,l.value="",x.value={};try{const r=G(o.value);c.value?await I.update(c.value,r):await I.create(r),await C(),j()}catch(r){((v=r==null?void 0:r.response)==null?void 0:v.status)===422&&((s=(t=r==null?void 0:r.response)==null?void 0:t.data)!=null&&s.errors)?(x.value=r.response.data.errors,l.value=r.response.data.message||"Validation error"):l.value=((A=(f=r==null?void 0:r.response)==null?void 0:f.data)==null?void 0:A.message)||(r==null?void 0:r.message)||"Request failed"}finally{m.value=!1}}async function $(v){const t=await I.edit(v);c.value=v,o.value={name:{en:t.name_en||"",ar:t.name_ar||""},description:{en:t.description_en||"",ar:t.description_ar||""},order:t.order??"",is_enabled:!!t.is_enabled,image:null},w.value=t.image_url||null}function D(v){var s;const t=(s=v.target.files)==null?void 0:s[0];o.value.image=t||null,w.value=t?URL.createObjectURL(t):null}async function F(v){confirm("Are you sure you want to delete this intro?")&&(await I.destroy(v),await C())}return L(C),(v,t)=>(u(),d(N,null,[U(S(O),{title:"Intro Management"}),U(q,null,{default:T(()=>[a("div",P,[t[11]||(t[11]=a("h2",{class:"text-2xl font-semibold text-gray-800"},"Intro Management",-1)),a("div",Y,[a("div",H,[a("h3",K,p(c.value?"Edit Intro":"Add New Intro"),1),c.value?(u(),d("button",{key:0,onClick:j,class:"px-3 py-1 border rounded"},"Cancel")):g("",!0)]),a("div",Q,[b(a("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.name.en=s),class:"form-input",type:"text",placeholder:"Name (EN)"},null,512),[[h,o.value.name.en]]),b(a("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.name.ar=s),class:"form-input",type:"text",placeholder:"الاسم (AR)"},null,512),[[h,o.value.name.ar]]),b(a("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.description.en=s),class:"form-input",type:"text",placeholder:"Description (EN)"},null,512),[[h,o.value.description.en]]),b(a("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.description.ar=s),class:"form-input",type:"text",placeholder:"الوصف (AR)"},null,512),[[h,o.value.description.ar]]),b(a("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>o.value.order=s),class:"form-input",type:"number",placeholder:"Order"},null,512),[[h,o.value.order,void 0,{number:!0}]]),a("label",W,[b(a("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=s=>o.value.is_enabled=s)},null,512),[[B,o.value.is_enabled]]),t[6]||(t[6]=a("span",null,"Enabled",-1))]),a("div",X,[a("input",{type:"file",onChange:D,class:"form-input"},null,32),w.value?(u(),d("div",Z,[t[7]||(t[7]=a("span",{class:"block mb-2"},"Image preview:",-1)),a("img",{src:w.value,class:"w-40 h-24 object-cover rounded border"},null,8,ee)])):g("",!0)])]),a("div",te,[a("button",{disabled:m.value,onClick:R,class:"px-4 py-2 bg-green-600 text-white rounded disabled:opacity-60"},p(c.value?"Update Intro":"Add Intro"),9,ne),m.value?(u(),d("span",ae,"Saving…")):g("",!0)]),l.value?(u(),d("div",se,p(l.value),1)):g("",!0),Object.keys(x.value).length?(u(),d("ul",re,[(u(!0),d(N,null,E(x.value,(s,f)=>(u(),d("li",{key:f},[a("strong",null,p(f)+":",1),k(" "+p(s.join(", ")),1)]))),128))])):g("",!0)]),a("div",oe,[a("div",{class:"flex items-center justify-between mb-4"},[t[8]||(t[8]=a("h3",{class:"text-lg font-bold"},"Intro Screens",-1)),a("button",{onClick:C,class:"px-3 py-1 border rounded"},"Refresh")]),i.value?(u(),d("div",le,"Loading…")):(u(),d("div",ie,[(u(!0),d(N,null,E(n.value,s=>(u(),d("div",{key:s.id,class:"flex justify-between items-center border-b py-3"},[a("div",de,[a("div",ue,[k(p(s.name_en)+" ",1),t[9]||(t[9]=a("span",{class:"text-gray-400"},"/",-1)),k(" "+p(s.name_ar),1)]),a("div",ce,[k(p(s.description_en)+" ",1),t[10]||(t[10]=a("span",{class:"text-gray-400"},"/",-1)),k(" "+p(s.description_ar),1)]),a("div",pe," Order: "+p(s.order??"-")+" | Enabled: "+p(s.is_enabled?"Yes":"No"),1)]),a("div",ve,[s.image_url?(u(),d("img",{key:0,src:s.image_url,class:"w-16 h-10 object-cover rounded border"},null,8,_e)):g("",!0),a("button",{onClick:f=>$(s.id),class:"text-blue-600 hover:underline"},"Edit",8,fe),a("button",{onClick:f=>F(s.id),class:"text-red-600 hover:underline"},"Delete",8,ge)])]))),128)),n.value.length?g("",!0):(u(),d("div",me,"No intros found."))]))])])]),_:1})],64))}},ke=J(ye,[["__scopeId","data-v-bf11009c"]]);export{ke as default};
